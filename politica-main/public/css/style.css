:root {
    --primary-color: #802433;
    --primary-dark: #5c1a26;
    --primary-light: #a8324a;
    --secondary-color: #2c3e50;
    --accent-color: #e74c3c;
    --light-gray: #f5f5f5;
    --medium-gray: #e0e0e0;
    --dark-gray: #333;
    --success-color: #27ae60;
    --warning-acolor: #f39c12;
    --warning-color: #f39c12;
    --danger-color: rgba(210, 4, 4, 0.91);
    --text-color: #333;
    --text-light: #777;
    --white: #fff;
    --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    --border-radius: 8px;
    --transition: all 0.3s ease;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Poppins', sans-serif;
    background-color: var(--light-gray);
    color: var(--text-color);
    line-height: 1.6;
    min-height: 100vh;
}

[data-tooltip] {
    position: relative;
}

[data-tooltip]::after,
[data-tooltip]::before {
    position: absolute;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease, transform 0.2s ease;
    z-index: 1000;
}

[data-tooltip]::after {
    content: attr(data-tooltip);
    top: calc(100% + 12px);
    left: 50%;
    transform: translate(-50%, 0);
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    color: var(--white);
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 0.75rem;
    line-height: 1.2;
    white-space: nowrap;
}

[data-tooltip]::before {
    content: '';
    top: calc(100% + 4px);
    left: 50%;
    transform: translate(-50%, 0);
    border-width: 6px 6px 0 6px;
    border-style: solid;
    border-color: var(--primary-color) transparent transparent transparent;
    z-index: 999;
    transform-origin: center;
}

@media (hover: hover) {
    [data-tooltip]:hover::after,
    [data-tooltip]:hover::before {
        opacity: 1;
        transform: translate(-50%, 0);
    }
}

@media (hover: none) {
    [data-tooltip]::after,
    [data-tooltip]::before {
        display: none;
    }
}

body.dark-mode [data-tooltip]::after {
    background: linear-gradient(135deg, var(--primary-dark), var(--primary-color));
}

body.dark-mode [data-tooltip]::before {
    border-color: var(--primary-dark) transparent transparent transparent;
}

.app-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

#user-dashboard,
#quiz-screen,
#results-screen {
    display: none;
}

#auth-screen {
    display: flex;
}

#auth-screen h1 {
    /* Manteniamo queste proprietà per il tratto */
    stroke-dasharray: 1000;
    stroke-dashoffset: 1000;
    stroke: var(--primary-color);
    /* Il colore del tratto */
    stroke-width: 1px;
    /* Spessore del tratto */

    /* Il riempimento deve essere presente fin dall'inizio */
    fill: var(--primary-color);
    /* Imposta il colore di riempimento fin dall'inizio */

    /* L'animazione controllerà la visibilità del fill */
    animation: draw 100s linear forwards;
}

@keyframes draw {
    0% {
        stroke-dashoffset: 1000;
        /* Il tratto è nascosto */
        opacity: 0;
        /* Rendi l'intero SVG invisibile all'inizio */
    }

    1% {
        opacity: 1;
        /* Appena inizia l'animazione, diventa visibile */
    }

    100% {
        stroke-dashoffset: 0;
        /* Il tratto è completamente disegnato */
        opacity: 1;
        /* Rimane visibile */
    }
}

/* Token Modal */
.token-modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
}

.token-modal-content {
    background-color: #f8f9fa;
    margin: 15% auto;
    padding: 25px;
    border-radius: var(--border-radius);
    width: 80%;
    max-width: 500px;
    box-shadow: var(--box-shadow);
}

.token-modal h2 {
    color: var(--primary-color);
    margin-bottom: 20px;
    text-align: center;
}

.token-modal .form-group {
    margin-bottom: 20px;
}

.token-modal label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
}

.token-modal input {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid var(--medium-gray);
    border-radius: var(--border-radius);
    font-size: 1rem;
    transition: var(--transition);
}

.token-modal input:focus {
    border-color: var(--primary-color);
    outline: none;
    box-shadow: 0 0 0 2px rgba(128, 36, 51, 0.2);
}

.token-btn {
    background: var(--primary-color);
    color: var(--white);
    border: none;
    padding: 12px;
    width: 100%;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.token-btn:hover {
    background: var(--primary-dark);
}

/* Auth Screen */
#auth-screen {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding: 20px;
    text-align: center;
}

.app-logo {
    text-align: center;
    margin-bottom: 30px;

}

.app-logo i {
    font-size: 3.5rem;
    color: var(--primary-color);
    margin-bottom: 15px;
}

.app-logo h1 {
    font-size: 3.2rem !important;
    color: var(--primary-color);
    font-weight: 600;
    margin-bottom: 10px;
    font-family: 'Lobster', sans-serif;
    margin-top: -20px;
    animation: draw 100s linear forwards;


}

.app-description {
    font-size: 1.1rem;
    color: var(--text-light);
    max-width: 600px;
    margin: 0 auto 20px;
    animation: draw 200s linear forwards;
    margin-bottom: auto;

}

.logo-image {
    font-size: 3.5rem;
    height: auto;
    margin-bottom: 5px;
    animation: draw 100s linear forwards;

}

.auth-form {
    background: var(--white);
    width: 100%;
    max-width: 400px;
    padding: 30px;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    margin-bottom: 0px;
}

.auth-form h2 {
    color: var(--primary-color);
    margin-bottom: 25px;
    text-align: center;
    font-size: 1.8rem;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: var(--secondary-color);
}

.form-group input {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid var(--medium-gray);
    border-radius: var(--border-radius);
    font-size: 1rem;
    transition: var(--transition);
}

.form-group input:focus {
    border-color: var(--primary-color);
    outline: none;
    box-shadow: 0 0 0 2px rgba(128, 36, 51, 0.2);
}

.checkbox-group {
    display: flex;
    align-items: center;
    gap: 10px;
}

.checkbox-group input[type="checkbox"] {
    width: auto;
    margin: 0;
}

.auth-btn {
    background: var(--primary-color);
    color: var(--white);
    border: none;
    padding: 12px;
    width: 100%;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    margin-top: 10px;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.auth-btn:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
}

.auth-switch {
    text-align: center;
    margin-top: 20px;
    color: var(--text-light);
}

.auth-switch a {
    color: var(--primary-color);
    text-decoration: none;
    font-weight: 500;
    transition: var(--transition);
}

.auth-switch a:hover {
    text-decoration: underline;
}

/* Schermata principale dopo il login */
#main-screen {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
}

.main-header {
    background: var(--white);
    padding: 20px;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    margin-bottom: 30px;
}

.header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.user-info h2 {
    font-size: 1.5rem;
    color: var(--primary-color);
    margin-bottom: 5px;
}

.user-info p {
    color: var(--text-light);
    font-size: 0.9rem;
}

.logout-btn {
    background: var(--light-gray);
    color: var(--primary-color);
    border: none;
    padding: 10px 20px;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 8px;
}

.logout-btn:hover {
    background: var(--medium-gray);
}

/* Stili per l'header del canale */
.channel-header {
    text-align: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 2px solid var(--light-gray);
}

.channel-description {
    color: var(--text-light);
    font-size: 1rem;
    margin-top: 10px;
}

/* Badge per il canale sulle materie */
.channel-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    background: var(--primary-color);
    color: white;
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 0.7rem;
    font-weight: 600;
}

/* Azioni di sezione */
.section-actions {
    display: flex;
    justify-content: center;
    margin-top: 30px;
    padding-top: 20px;
    border-top: 1px solid var(--medium-gray);
}

/* Migliora la visualizzazione delle card */
.subject-card {
    position: relative;
    transition: all 0.3s ease;
}

.subject-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
}

/* Animazione per l'apparizione delle materie */
.subject-card {
    animation: fadeInUp 0.5s ease-out;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Grid responsive migliorata */
.subject-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 25px;
}

/* Header sezione materie – unico e brandizzato */
.subject-section-header {
    display: flex;
    align-items: center;
    gap: 18px;
    padding: 20px 26px;
    margin-bottom: 26px;
    border-radius: 18px;
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    color: var(--white);
    position: relative;
    box-shadow: 0 18px 38px rgba(128, 36, 51, 0.25);
    overflow: hidden;
}

.subject-section-header::after {
    content: "";
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at top left, rgba(255, 255, 255, 0.2), transparent 65%);
    pointer-events: none;
}

.subject-section-header .header-content {
    flex: 1;
    min-width: 0;
    position: relative;
    z-index: 1;
}

.subject-section-header h3 {
    margin: 0 0 6px;
    font-size: 1.35rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 10px;
    color: var(--white);
}

.subject-section-header h3 i {
    font-size: 1.25rem;
}

.subject-section-header .channel-description {
    margin: 0;
    font-size: 0.97rem;
    color: rgba(255, 255, 255, 0.82);
}

#back-to-channels-from-subjects {
    flex-shrink: 0;
    position: relative;
    z-index: 1;
    border: 2px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.18);
    background: rgba(255, 255, 255, 0.16);
    color: var(--white);
}

#back-to-channels-from-subjects:hover {
    background: rgba(255, 255, 255, 0.24);
}

#back-to-channels-from-subjects i {
    color: var(--white);
}

@media (max-width: 768px) {
    .subject-section-header {
        flex-wrap: wrap;
        padding: 18px 20px;
        gap: 14px;
    }

    #back-to-channels-from-subjects {
        order: -1;
    }

    .subject-section-header h3 {
        font-size: 1.2rem;
    }
}

@media (max-width: 480px) {
    .subject-section-header {
        border-radius: 16px;
        gap: 12px;
    }

    .subject-section-header h3 {
        font-size: 1.1rem;
        gap: 8px;
    }
}

.channel-section h3 {
    color: var(--primary-color);
    margin-bottom: 20px;
    font-size: 1.2rem;
    display: flex;
    align-items: center;
    gap: 10px;
}

.channel-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
}

.channel-card {
    background: var(--white);
    border-radius: var(--border-radius);
    padding: 20px;
    cursor: pointer;
    transition: var(--transition);
    border: 1px solid var(--medium-gray);
    text-align: center;
    position: relative;
    overflow: hidden;
}

.channel-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: var(--primary-color);
}

.channel-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
}

.channel-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    margin: 0 auto 15px;
    color: var(--white);
    background: var(--primary-color);
    font-weight: bold;
}

.channel-card h4 {
    margin-bottom: 5px;
    color: var(--secondary-color);
}

/* Sezione selezione materia */
.channel-section {
    background: var(--white);
    padding: 25px;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    margin-bottom: 30px;
}

.subject-section {
    display: none;
}

.subject-section h3 {
    color: var(--primary-color);
    margin-bottom: 20px;
    font-size: 1.2rem;
    display: flex;
    align-items: center;
    gap: 10px;
}

.subject-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
}

.subject-card {
    background: var(--white);
    border-radius: var(--border-radius);
    padding: 20px;
    cursor: pointer;
    transition: var(--transition);
    border: 1px solid var(--medium-gray);
    text-align: center;
    position: relative;
    overflow: hidden;
}

.subject-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: var(--primary-color);
}

.subject-card[data-subject="politica"]::before {
    background: var(--primary-color);
}

.subject-card[data-subject="eoi"]::before {
    background: var(--primary-color);
}

.subject-card[data-subject="energia"]::before {
    background: var(--primary-color);
}

.subject-card[data-subject="organizzazione"]::before {
    background: var(--primary-color);
}

.subject-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
}

.subject-icon {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    margin: 0 auto 15px;
    color: var(--white);
}

.subject-card[data-subject="politica"] .subject-icon {
    background: var(--primary-color);
}

.subject-card[data-subject="eoi"] .subject-icon {
    background: var(--eoi-color);
}

.subject-card[data-subject="energia"] .subject-icon {
    background: var(--energia-color);
}

.subject-card[data-subject="organizzazione"] .subject-icon {
    background: var(--organizzazione-color);
}

.subject-card h4 {
    margin-bottom: 10px;
    color: var(--secondary-color);
}

.subject-card p {
    color: var(--text-light);
    font-size: 0.9rem;
}

/* User Dashboard */
#user-dashboard {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    display: none;
}

.dashboard-header {
    background: var(--white);
    padding: 30px;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    margin-bottom: 30px;
}

.user-greeting {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    flex-wrap: wrap;
    gap: 15px;
}

.user-greeting h2 {
    font-size: 1.8rem;
    color: var(--primary-color);
    margin-right: auto;
}

.user-greeting .stat-image {
    width: 40px;
    height: 40px;
    border-radius: 40%;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
    border: 2px solid white;
    vertical-align: middle;
}

/* Per una visualizzazione più elegante su dispositivi mobili */
@media (max-width: 768px) {
    .user-greeting h2 {
        flex-direction: column;
        align-items: flex-start;
        gap: 5px;
    }

    .user-greeting .stat-image {
        margin-top: -5px;
    }
}

.logout-btn {
    background: var(--light-gray);
    color: var(--primary-color);
    border: none;
    padding: 10px 20px;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 8px;
}

.logout-btn:hover {
    background: var(--medium-gray);
}

.user-stats-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.stat-card {
    background: var(--white);
    border-radius: var(--border-radius);
    padding: 20px;
    display: flex;
    align-items: center;
    gap: 15px;
    box-shadow: var(--box-shadow);
    border-left: 4px solid var(--primary-color);
}

.stat-icon {
    background: var(--primary-color);
    color: var(--white);
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    flex-shrink: 0;
}

.stat-info {
    display: flex;
    flex-direction: column;
}

.stat-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--primary-color);
}

.stat-label {
    font-size: 0.9rem;
    color: var(--text-light);
}

.dashboard-content {
    display: grid;
    grid-template-columns: 1fr;
    gap: 30px;
}

.quiz-settings {
    background: var(--white);
    padding: 25px;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
}

.quiz-settings h3 {
    color: var(--primary-color);
    margin-bottom: 20px;
    font-size: 1.2rem;
    display: flex;
    align-items: center;
    gap: 10px;
}

.frequent-errors-btn {
    background-color: #FFD700;
    color: #000;
    border: none;
    padding: 12px 20px;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin-top: 10px;
}

.frequent-errors-btn:hover {
    background-color: #e6c200;
}

.settings-form {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.form-select {
    width: 100%;
    padding: 12px 15px;
    border: 1px solid var(--medium-gray);
    border-radius: var(--border-radius);
    font-size: 1rem;
    transition: var(--transition);
    background-color: var(--white);
    appearance: none;
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right 10px center;
    background-size: 1em;
}

.form-select:focus {
    border-color: var(--primary-color);
    outline: none;
    box-shadow: 0 0 0 2px rgba(128, 36, 51, 0.2);
}

.primary-btn {
    background: var(--primary-color);
    color: var(--white);
    border: none;
    padding: 12px 20px;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    animation: pulseprimarybtn 2s infinite;
}

.primary-btn:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
}

.primary-btn:disabled {
    background: var(--medium-gray);
    cursor: not-allowed;
    transform: none;
}

.backarrowquiz-btn {
    background: var(--light-gray);
    color: var(--primary-color);
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: var(--transition);
    font-size: 1.9rem;
    border-style: ridge;
    border-color: #802433;
    aspect-ratio: 1 / 1;
    box-sizing: border-box;

    position: inline;
    /* lo posizioni manualmente */
    margin-right: auto;
    /* distanza dal bordo sinistro */
    bottom: 30%;
    /* verticale al centro */

}

.backarrowquiz-btn:hover {
    background: var(--light-gray);
    transform: scale(1.1);
}

/* Quiz Screen */
#quiz-screen {
    background: var(--white);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    overflow: hidden;
    margin-bottom: 30px;
}

.quiz-header {
    background: var(--primary-color);
    color: var(--white);
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.quiz-progress {
    flex: 1;
    max-width: 60%;
}

.progress-bar {
    width: 100%;
    height: 8px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 4px;
    margin-bottom: 8px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: var(--white);
    border-radius: 4px;
    width: 0%;
    transition: width 0.3s ease;
}

#progress-text {
    font-size: 0.9rem;
    font-weight: 500;
}

.quiz-timer {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 1.1rem;
    font-weight: 500;
}

.quiz-content {
    padding: 30px;
}

#question-text {
    font-size: 1.3rem;
    margin-bottom: 20px;
    color: var(--secondary-color);
    line-height: 1.4;
}

#image-container {
    margin: 20px 0;
    text-align: center;
}

.question-image {
    max-width: 100%;
    max-height: 300px;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
}

.answer-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 15px;
}

.answer-btn {
    background: var(--white);
    color: var(--text-color);
    border: 2px solid var(--medium-gray);
    padding: 15px 20px;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 1rem;
    text-align: left;
    transition: var(--transition);
    display: flex;
    align-items: center;
}

.answer-btn:hover:not(.selected) {
    border-color: var(--primary-color);
    background: rgba(128, 36, 51, 0.05);
}

.answer-btn.selected {
    border-color: var(--primary-color);
    background: rgba(128, 36, 51, 0.1);
}

.answer-btn.correct {
    border-color: var(--success-color);
    background: rgba(39, 174, 96, 0.1);
}

.answer-btn.incorrect {
    border-color: var(--danger-color);
    background: rgba(231, 76, 60, 0.1);
}

/* Evita che hover o focus sovrascrivano */
.answer-btn.correct:hover,
.answer-btn.correct:focus {
    border-color: var(--success-color);
    background: rgba(39, 174, 96, 0.1);
}

.answer-btn.incorrect:hover,
.answer-btn.incorrect:focus {
    border-color: var(--danger-color);
    background: rgba(231, 76, 60, 0.1);
}

.answer-btn .answer-text {
    flex: 1;
}

.answer-btn .answer-image {
    max-width: 100%;
    max-height: 150px;
    border-radius: 4px;
    margin: 5px 0;
}

.quiz-navigation {
    padding: 20px;
    border-top: 1px solid var(--medium-gray);
    display: flex;
    justify-content: flex-end;
    margin-right: auto;
}

.primary-btn2 {
    background: var(--primary-color);
    color: var(--white);
    border: none;
    padding: 12px 20px;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin-right: auto;
}

.primary-btn2:hover {
    background: var(--primary-color);
    transform: translateY(-2px);
}

.primary-btn2:disabled {
    background: var(--medium-gray);
    cursor: not-allowed;
    transform: none;
}

/* Results Screen */
#results-screen {
    background: var(--white);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    padding: 30px;
    margin-bottom: 30px;
}

/* ===== Integrazioni quiz: ripeti stesso quiz, Perché?, explain dock ===== */

/* Bottone ripeti stesso quiz */
#repeat-same-quiz-btn {
  background-color: var(--primary-color);
  color: var(--white);
  border: 2px solid var(--primary-color);
  animation: pulse 2s infinite;
}
#repeat-same-quiz-btn:hover {
  background-color: var(--primary-dark);
}

/* Bottone Perché? (inline in quiz) */
#whyBtn {
  margin-top: 10px;
  background: linear-gradient(135deg, #802433 0%, #a8324a 100%);
  color: var(--white);
  border: none;
  padding: 16px 35px;
  border-radius: 12px;
  cursor: pointer;
  font-size: 1.1rem;
  font-weight: 700;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  text-transform: uppercase;
  letter-spacing: .8px;
  position: relative;
  overflow: hidden;
  box-shadow: 0 8px 20px rgba(128, 36, 51, 0.3);
  transition: all 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
  transform: translateZ(18px);
}

.quiz-navigation #whyBtn,
.quiz-controls #whyBtn {
  margin-top: 0;
  align-self: center;
}

#whyBtn::before {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.28), transparent);
  transition: left 0.6s ease;
}

#whyBtn:hover {
  background: linear-gradient(135deg, #a8324a 0%, #802433 100%);
  box-shadow: 0 14px 30px rgba(128, 36, 51, 0.35);
  transform: translateZ(24px) translateY(-2px) scale(1.03);
}

#whyBtn:hover::before {
  left: 100%;
}

#whyBtn:active {
  transform: translateZ(20px) translateY(-1px) scale(1.01);
}

#whyBtn:focus-visible {
  outline: 3px solid rgba(255, 255, 255, 0.5);
  outline-offset: 3px;
}

/* Contenitore spiegazione inline */
#explainDock {
  max-width: 800px;
  margin: 16px auto 0;
  padding: 0 12px;
  margin-bottom: 8px;
  scrollbar-width: auto;
  scrollbar-color: var(--primary-color) #f1f1f1;
}

/* Box spiegazione AI sintetica in quiz */
.ai-explanation {
  background: #f8fafc;
  border: 1px solid #e2e8f0;
  border-radius: 10px;
  padding: 14px 16px;
  box-shadow: 0 2px 10px rgba(128, 36, 51, 0.15);
  max-height: 260px;
  overflow: auto;
  margin-bottom: 15px;
}
.ai-explanation h5 { margin: 0 0 6px; font-size: 1rem; }
.ai-explanation .ai-sources { margin-top: 10px; margin-bottom: 5px; }
.ai-explanation .ai-sources ul { margin: 6px 0 0 18px; }
.ai-explanation p { line-height: 1.6; margin: 0; }

/* Stato caricamento spiegazione */
.loading-spinner { display: flex; align-items: center; gap: 10px; color: var(--primary-color); }
.spinner {
  border: 3px solid #f3f3f3;
  border-top: 3px solid var(--primary-color);
  border-radius: 50%;
  width: 20px; height: 20px;
  animation: spin 1s linear infinite;
}
@keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }

/* Migliora layout pulsanti di navigazione quiz (senza rompere il posizionamento) */
.quiz-navigation { gap: 10px; align-items: center; }
.quiz-navigation > button { flex: 0 0 auto; width: auto; }

.hidden { display: none !important; }

/* Dark Mode per aggiunte recenti */
body.dark-mode #repeat-same-quiz-btn {
  background: linear-gradient(135deg, var(--dark-primary), var(--dark-primary-hover));
  border-color: var(--dark-primary);
  color: #fff;
}

body.dark-mode #whyBtn,
body.dark-mode .why-btn {
  background: linear-gradient(135deg, var(--dark-primary), var(--dark-primary-hover));
  color: #fff;
}

/* === Progressive Challenge (PC) === */
.pc-section {
  background: var(--white);
  border: none;
  border-radius: 12px;
  padding: 12px;
}
.pc-section .pc-box-btn {
  min-width: 56px;
  padding: 10px 14px;
}
.pc-remaining-indicator {
  color: var(--text-light);
}

/* PC overlay summary */
.pc-overlay { position: fixed; inset: 0; background: rgba(0,0,0,.4); display: flex; align-items: center; justify-content: center; z-index: 9999; backdrop-filter: blur(2px); }
.pc-modal { background: var(--white); color: var(--text-color); width: min(560px, 92vw); border-radius: 18px; padding: 18px; border: 1px solid rgba(0,0,0,.06); box-shadow: 0 12px 30px rgba(0,0,0,.18), 0 2px 10px rgba(0,0,0,.08); transform: translateY(0); }
.pc-modal h3 { margin: 0 0 12px; color: var(--primary-color); display:flex; align-items:center; gap:10px; font-weight: 800; }
.pc-modal .pc-stats { display:flex; gap:12px; margin: 10px 0 14px; }
.pc-modal .pc-stat { flex:1; background: var(--white); border: 1px solid var(--medium-gray); border-radius: 12px; padding: 12px; text-align:center; box-shadow: 0 6px 16px rgba(0,0,0,.08); }
.pc-modal .pc-actions { display:flex; gap:10px; margin-top: 12px; justify-content: center; flex-wrap: wrap; }
.pc-modal .pc-actions .primary { background: var(--primary-color); color:#fff; border: none; padding: 12px 16px; border-radius: 12px; cursor: pointer; box-shadow: 0 8px 18px rgba(128,36,51,.25); }
.pc-modal .pc-actions .primary:hover { background: var(--primary-dark); transform: translateY(-1px); }
.pc-modal .pc-actions .secondary { background: var(--white); color: var(--primary-color); border: 2px solid var(--primary-color); padding: 12px 16px; border-radius: 12px; cursor: pointer; }
.pc-modal .pc-actions .secondary:hover { background: rgba(128,36,51,.05); }

/* PC results card in results screen */
.pc-results-card { background: var(--white); border: 1px solid rgba(0,0,0,.06); border-radius: 16px; box-shadow: 0 10px 24px rgba(0,0,0,.12), 0 2px 8px rgba(0,0,0,.06); padding: 16px; margin: 12px 0 8px; }
.pc-results-card .pc-results-header { display:flex; align-items:center; justify-content: space-between; margin-bottom: 10px; }
.pc-results-card .title-wrap { display:flex; align-items:center; gap:8px; color: var(--primary-color); font-weight: 800; }
.pc-results-card .pc-stats-row { display:flex; gap:12px; margin-bottom: 12px; flex-wrap: wrap; }
.pc-results-card .pc-stat { flex:1; min-width: 150px; background: linear-gradient(180deg, #fff, #fafafa); border: 1px solid var(--medium-gray); border-radius: 14px; padding: 12px; text-align:center; box-shadow: 0 8px 18px rgba(0,0,0,.10); transition: transform .15s ease, box-shadow .2s ease; }
.pc-results-card .pc-stat:hover { transform: translateY(-2px); box-shadow: 0 12px 24px rgba(0,0,0,.14); }
.pc-results-card .pc-stat-label { font-size: .9rem; color: var(--text-light); margin-bottom: 4px; }
.pc-results-card .pc-stat-value { font-weight: 800; font-size: 1.2rem; }
.pc-results-card .pc-stat-value.pc-correct { color: #27ae60; }
.pc-results-card .pc-stat-value.pc-wrong { color: #e74c3c; }
.pc-results-card .pc-results-actions { display:flex; justify-content:center; }

/* Results top actions */
.results-header { position: relative; }
.results-top-actions { position:absolute; top:8px; left:8px; right:8px; display:flex; align-items:center; justify-content:space-between; gap:8px; }
.pill-btn { border:none; border-radius:999px; padding:8px 14px; display:inline-flex; align-items:center; gap:8px; cursor:pointer; box-shadow:0 6px 16px rgba(0,0,0,.12); transition:transform .15s ease, box-shadow .2s ease; }
.pill-btn.primary { background: var(--primary-color); color:#fff; }
.pill-btn.primary:hover { background: var(--primary-dark); transform: translateY(-1px); }
.pill-btn.ghost { background:#fff; color: var(--primary-color); border:2px solid var(--primary-color); }
.pill-btn.ghost:hover { background: rgba(128,36,51,.06); transform: translateY(-1px); }
.pill-btn i { font-size:1rem; }
.pill-btn[data-tip] { position: relative; }
.pill-btn[data-tip]::after {
  content: attr(data-tip);
  position: absolute; left: 50%; bottom: 120%; transform: translateX(-50%);
  background: rgba(0,0,0,.85); color:#fff; padding:6px 8px; border-radius:6px; font-size:.75rem; white-space:nowrap;
  opacity:0; pointer-events:none; transition: opacity .2s ease, transform .2s ease; box-shadow:0 6px 16px rgba(0,0,0,.25);
}
.pill-btn[data-tip]::before {
  content:""; position:absolute; left:50%; bottom:112%; transform: translateX(-50%);
  border:6px solid transparent; border-top-color: rgba(0,0,0,.85); opacity:0; transition: opacity .2s ease;
}
.pill-btn[data-tip]:hover::after { opacity:1; transform: translateX(-50%) translateY(-2px); }
.pill-btn[data-tip]:hover::before { opacity:1; }

/* Inline actions inside PC card */
.pc-results-actions { display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin-top: 6px; }
.pc-results-actions .pill-btn .txt { display:inline; }

/* Dark mode overlay */
body.dark-mode .pc-modal { background: #1f1f1f; color: #fff; }
body.dark-mode .pc-modal .pc-stat { background: rgba(255,255,255,.06); }
body.dark-mode .pc-modal .pc-actions .secondary { background: transparent; color: #fff; border-color: rgba(255,255,255,.25); }

/* Modalità: selettore */
.mode-switch { display:flex; gap:6px; background: var(--white); padding:6px; border-radius: 14px; align-items:center; width:fit-content; border:1px solid var(--medium-gray); box-shadow: 0 6px 16px rgba(0,0,0,.06); }
.mode-switch .mode-btn { background: transparent; color: var(--text-color); border: 1px solid transparent; padding:8px 14px; border-radius: 10px; cursor: pointer; font-weight: 700; transition: all .2s ease; }
.mode-switch .mode-btn:hover { background: rgba(128,36,51,.06); }
.mode-switch .mode-btn.active { background: var(--primary-color); color: #fff; border-color: var(--primary-color); box-shadow: 0 10px 20px rgba(128,36,51,.25); transform: translateY(-1px); }
.mode-switch .mode-btn:focus-visible { outline: 2px solid var(--primary-color); outline-offset: 2px; }
.mode-section { margin-top: 10px; }

/* Rendi il bottone Avvia Quiz largo come il box impostazioni */
.quiz-settings #start-quiz-btn { width: 100%; }

/* PC chips stile primario */
.pc-chips .pc-box-btn {
  background: var(--primary-color);
  color: var(--white);
  border: none;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 600;
  transition: var(--transition);
}
.pc-chips .pc-box-btn:hover { background: var(--primary-dark); transform: translateY(-1px); }
.pc-chips .pc-box-btn.selected {
  box-shadow: 0 0 0 2px rgba(128,36,51,0.15), 0 6px 16px rgba(0,0,0,0.12);
}

/* CTA 3D per progressiva */
.pc-cta { box-shadow: 0 10px 20px rgba(128,36,51,.25); border-radius: 12px; }
.pc-cta:hover { transform: translateY(-1px); }

/* Action: Continua blocco di sessione (solo progressiva) */
#pc-continue-inline-btn {
  background: var(--primary-color);
  color: var(--white);
  border: 2px solid var(--primary-color);
}
#pc-continue-inline-btn:hover { background: var(--primary-dark); }

body.dark-mode .ai-explanation {
  background: var(--dark-bg-tertiary);
  border: 1px solid var(--dark-border);
  color: var(--dark-text-primary);
  box-shadow: 0 2px 10px rgba(0,0,0,0.35);
}
body.dark-mode .ai-explanation p { color: var(--dark-text-primary); }
body.dark-mode .loading-spinner { color: var(--dark-primary); }
body.dark-mode .spinner { border-top-color: var(--dark-primary); }

/* Correzione contrasto testo explainDock in tema chiaro */
body:not(.dark-mode) .ai-explanation p { color: var(--text-color); }

.results-header {
    text-align: center;
    margin-bottom: 30px;
}

.results-header h2 {
    color: var(--primary-color);
    font-size: 1.8rem;
    margin-bottom: 20px;
}

.score-display {
    margin-bottom: 20px;
}

#score-percentage {
    font-size: 3rem;
    font-weight: 700;
    color: var(--primary-color);
    display: block;
    line-height: 1;
}

#score-text {
    font-size: 1.5rem;
    color: var(--text-color);
    font-weight: 500;
}

.results-details {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 20px;
    border-color: var(--primary-color);
}

.result-stat {
    background: var(--light-gray);
    padding: 10px;
    border-radius: var(--border-radius);
    text-align: center;
    border-color: var(--primary-color);
}

.stat-number {
    font-size: 2rem;
    font-weight: 700;
    color: var(--primary-color);
    display: block;
    margin-bottom: 5px;
}

.stat-label {
    font-size: 0.9rem;
    color: var(--text-light);
}

.results-actions {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.action-btn {
    padding: 15px;
    border-radius: var(--border-radius);
    font-size: 1rem;
    font-weight: 500;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
}

.action-btn i {
    font-size: 1.2rem;
}

.secondary-btn {
    background: var(--white);
    color: var(--primary-color);
    border: 2px solid var(--primary-color);
}

.secondary-btn:hover {
    background: rgba(128, 36, 51, 0.05);
}

/* Stile per il counter risposte corrette/errate nella quiz-score */
.quiz-score {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 1.1rem;
    font-weight: 500;
    color: var(rgb(51, 204, 128));
    margin-left: 15px;
}

.quiz-score i {
    color: var(--warning-color);
}



#correct-answers-count,
#answered-questions-count,
#correct-percentage {
    font-weight: 700;
    color: rgb(51, 204, 128);
}

#correct-percentage {
    margin-left: 2px;
}

.quiz-counter {
    display: none;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    font-weight: 700;
    color: rgb(51, 204, 128);
    margin-left: 15px;
}


/* Animazione pulsante riprova */
@keyframes pulse {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.03);
    }

    100% {
        transform: scale(1);
    }
}

#retry-wrong-btn {
    animation: pulse 2s infinite;
    background-color: #FFD700;
}

#retry-wrong-btn:hover {
    background-color: #FFD700;
}

/* Stili per la revisione risposte */
.review-container {
    padding: 20px;
}

.wrong-question {
    background: #ffebee;
    padding: 15px;
    border-radius: var(--border-radius);
    margin-bottom: 20px;
    border-left: 4px solid var(--danger-color);
}

.correct-answer {
    background: #e8f5e9;
    padding: 10px;
    border-radius: var(--border-radius);
    margin-top: 10px;
    color: var(--success-color);
    display: flex;
    align-items: center;
    gap: 10px;
}

.review-question-image {
    max-width: 100%;
    max-height: 200px;
    border-radius: var(--border-radius);
    margin: 10px 0;
    display: block;
}

.review-answer-image {
    max-width: 100%;
    max-height: 150px;
    border-radius: 4px;
    margin-top: 5px;
}

.quiz-summary {
    display: flex;
    justify-content: space-between;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--medium-gray);
}

.summary-score {
    font-weight: 500;
}

.summary-percentage {
    color: var(--primary-color);
    font-weight: 700;
}

.segnala-problema {
    position: absolute;
    right: 0px;
    top: 50%;
    ;
    transition: transform 0.2s ease;
    display: inline-block;
}

.segnala-problema img {
    width: 30px;
    /* Regola la dimensione */
    height: auto;
    cursor: pointer;
}

.segnala-problema:hover {
    transform: scale(1.1);
}

/* Tooltip migliorato */
.segnala-problema[title] {
    position: relative;
}

.segnala-problema[title]:hover::after {
    content: attr(title);
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    background-color: #333;
    color: #fff;
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 0.8rem;
    white-space: nowrap;
    z-index: 100;
}

/* Responsive design */
@media (max-width: 768px) {
    .quiz-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
    }

    .quiz-progress {
        max-width: 100%;
        width: 100%;
    }

    .results-details {
        grid-template-columns: 1fr;
    }

    .user-greeting {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
    }

    .logout-btn {
        width: 100%;
    }

    .results-actions {
        flex-direction: column;
    }

    .action-btn {
        width: 100%;
    }
}

@media (max-width: 480px) {
    .auth-form {
        padding: 20px;
    }

    .app-logo h1 {
        font-size: 1.8rem;
    }

    #score-percentage {
        font-size: 2.5rem;
    }

    #score-text {
        font-size: 1.2rem;
    }

    .quiz-settings {
        padding: 15px;
    }
}

/* Stile per il messaggio di quiz non disponibile */
#no-quiz-message {
    background: var(--white);
    border: 1px solid var(--medium-gray);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    padding: 40px 40px 40px 60px;
    margin: 20px 0;
    width: 100%;
    text-align: center;
    position: relative;
}

#no-quiz-message h3 {
    color: var(--primary-color);
    margin-bottom: 15px;
    font-weight: 600;
    font-size: 1.5rem;
}

#no-quiz-message i {
    color: var(--primary-color);
    font-size: 3rem;
    margin-bottom: 20px;
    display: block;
}

#no-quiz-message p {
    color: var(--text-color);
    margin-bottom: 10px;
    line-height: 1.5;
}

#current-subject-name {
    color: var(--text-color);
    line-height: 1.5;
    font-size: 1.6rem;
}

#no-quiz-message .back-arrow-btn {
    position: absolute;
    left: 15px;
    top: 15px;
    background: var(--white);
    color: var(--white);
    border: none;
    width: 70px;
    height: 70px;
    border-radius: 0%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: var(--transition);
    font-size: 0.5rem;
    z-index: 10;
}

#no-quiz-message .back-arrow-btn:hover {
    background: var(--white);
    transform: scale(1.1);
}

/* Migliora la visibilità delle card delle materie */
.subject-card {
    position: relative;
    cursor: pointer;
    transition: all 0.3s ease;
}

.subject-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
}

/* Stile per la badge del canale nella dashboard materia */
.subject-badge {
    background: var(--primary-color);
    color: white;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.8rem;
    margin-left: 10px;
}

/* Stile consistente per i pulsanti back */
.back-arrow-btn-small {
    background: var(--light-gray);
    color: var(--primary-color);
    width: 50px;
    height: 50px;
    border-radius: 50%;
    border-style: ridge;
    border-color: #802433;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: var(--transition);
    font-size: 1.9rem;
    margin-right: 15px;
    aspect-ratio: 1 / 1;
    box-sizing: border-box;
    position: relative;
}

.back-arrow-btn-small:hover {
    background: var(--light-gray);
    transform: scale(1.1);
}

/* Posizionamento per il messaggio di errore */
#no-quiz-message .back-arrow-btn-small {
    background: var(--light-gray);
    color: var(--primary-color);
    border: none;
    width: 35px;
    height: 35px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: var(--transition);
    font-size: 0.5rem;
    margin-right: 15px;
}

/* Allineamento per subject-info */
.subject-info {
    display: flex;
    align-items: center;
    gap: 15px;
}

/* Stile modificato per il tasto Chi Siamo */
.chi-siamo-container {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    text-align: right;
    margin-top: 5px;
    margin-bottom: -20px;
    margin-left: 30px;
    padding: 10px 0px -5px 5px;


}

.chi-siamo-btn {
    display: flexbox;
    background-color: #5e5254;
    ;
    color: white;
    padding: 3px 10px;
    text-decoration: rgba(128, 36, 51, 0.3);
    border-radius: 4px;
    font-weight: normal;
    font-size: 0.6rem;
    transition: all 0.3s ease;
    border: 1px solid rgba(128, 36, 51, 0.3);
    margin-top: 0px;
}

.chi-siamo-btn:hover {
    background-color: #802433;
    color: white;
    transform: translateY(-2px);
}

/* Assicurati che il footer sia nascosto durante il quiz */
#quiz-screen~.site-footer,
#results-screen~.site-footer {
    display: none !important;
}

.lobster-regular {
    font-family: "Lobster", sans-serif;
    font-weight: 400;
    font-style: normal;
}

.chi-siamo-content h1,
.chi-siamo-content h2,
.chi-siamo-content h3 {
    color: var(--primary-dark);
    /* usa lo stesso colore dei titoli principali */
    font-weight: bolder;
    font-family: 'Lobster', sans-serif;
    font-size: 2.0rem;
    text-align: left;
    aspect-ratio: 0, 3 / 0, 3;
}

h30 {
    color: var(--primary-color);
    font-family: 'Lobster', cursive;
    font-size: 3.5rem;
    font-weight: bold;

}

.logout-btn2 {
    position: absolute;
    top: 100px;
    left: 10px;
    background: var(--light-gray);
    color: var(--primary-color);
    border: none;
    padding: 0px 10px;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 0.9rem;
    transition: var(--transition);
    display: flex;
    align-items: center;
    margin-right: -150px;
    gap: 8px;
    margin: 0px;
    font-weight: bold;
}

.logout-btn2:hover {
    background: var(--medium-gray);
}

.logo-image2 {
    position: absolute;
    font-size: 3.5rem;
    height: auto;
    margin-top: 50px;
    align-items: center;
    justify-content: center;
    margin-left: 10px;
    margin-top: 0px;
    aspect-ratio: 1 / 1;

}

.dashboard-header2 {
    display: flex;
    justify-content: center;
    background: var(--white);
    padding-top: 30px;
    padding-bottom: 30px;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    margin-bottom: 30px;
}

.user-greeting2 {
    margin: 0;
    padding: 0;
}

.instagram-icon {
    display: flex;
    font-size: 40px;
    color: #bbb7b9;
    margin-inline-end: 10px;
    transition: color 0.3s ease;
    margin-top: 0%;
    margin-bottom: -20px;
    padding: 10px 0px -5px 5px;
}

.instagram-icon:hover {
    color: var(--primary-color);
    /* colore ufficiale Instagram al passaggio */
}

/* Stile per il badge contatore errori frequenti */
/* Hover quando è disabilitato - versione semplificata */
/* Stile per il badge contatore errori frequenti */
.frequent-errors-btn {
    border: none;
    padding: 12px 20px;
    border-radius: var(--border-radius);
    font-size: 1rem;
    font-weight: 500;
    transition: all 0.5s ease-in-out;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin-top: 10px;
    position: relative;
}

/* Bottone abilitato (con errori) */
.frequent-errors-btn.enabled {
    background-color: #FFD700;
    color: #000;
    box-shadow: 0 4px 8px rgba(255, 215, 0, 0.3);
    transform: scale(1);
    animation: pulseYellow 2s infinite;
    cursor: pointer;
}

.frequent-errors-btn.enabled:hover {
    background-color: #e6c200;
    transform: translateY(-2px) scale(1.05);
    animation: none;
}

.frequent-errors-btn.enabled:active {
    transform: scale(0.95) translateY(0);
    transition: all 0.1s ease;
    box-shadow: 0 2px 4px rgba(255, 215, 0, 0.2);
}

/* Bottone disabilitato (senza errori) */
.frequent-errors-btn.disabled {
    background-color: var(--medium-gray);
    color: var(--text-light);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    transform: scale(0.98);
    cursor: not-allowed;
    /* Rimuovi qualsiasi proprietà che potrebbe interferire */
    pointer-events: auto;
    /* IMPORTANTE: permette hover e click */
}

/* Hover quando è disabilitato - SHAKE FUNZIONANTE */
.frequent-errors-btn.disabled:hover {
    background-color: var(--medium-gray);
    color: var(--text-light);
    cursor: not-allowed;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    animation: shakeDisabled 0.5s ease-in-out;
}

/* Click quando è disabilitato - SHAKE più intenso */
.frequent-errors-btn.disabled:active {
    animation: shakeDisabledIntense 0.3s ease-in-out;
}

@keyframes pulseYellow {
    0% {
        box-shadow: 0 4px 8px rgba(255, 215, 0, 0.3);
        transform: scale(1);
    }

    50% {
        box-shadow: 0 6px 12px rgba(255, 215, 0, 0.5);
        transform: scale(1.02);
    }

    100% {
        box-shadow: 0 4px 8px rgba(255, 215, 0, 0.3);
        transform: scale(1);
    }
}

@keyframes shakeDisabled {

    0%,
    100% {
        transform: translateX(0) scale(0.98);
    }

    25% {
        transform: translateX(-4px) scale(0.98);
    }

    50% {
        transform: translateX(4px) scale(0.98);
    }

    75% {
        transform: translateX(-4px) scale(0.98);
    }
}

@keyframes shakeDisabledIntense {

    0%,
    100% {
        transform: translateX(0) scale(0.98);
    }

    25% {
        transform: translateX(-6px) scale(0.98);
    }

    50% {
        transform: translateX(6px) scale(0.98);
    }

    75% {
        transform: translateX(-6px) scale(0.98);
    }
}

@keyframes fadeToGray {
    0% {
        background-color: #FFD700;
        box-shadow: 0 4px 8px rgba(255, 215, 0, 0.3);
        transform: scale(1);
    }

    50% {
        background-color: #b8b8b8;
        transform: scale(0.99);
    }

    100% {
        background-color: var(--medium-gray);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        transform: scale(0.98);
    }
}

.error-counter-badge {
    background-color: var(--primary-color);
    color: white;
    border-radius: 24px;
    padding: 3px 8px;
    font-size: 1.0rem;
    font-weight: bold;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border: 2px solid white;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease-in-out;
    animation: badgeAppear 0.5s ease-out;
    margin-left: 5px;
    /* Rimuovi il posizionamento assoluto */
    position: static;
    top: auto;
    right: auto;
    width: auto;
    height: auto;
    min-width: 20px;
}

@keyframes badgeAppear {
    0% {
        transform: scale(0) rotate(-180deg);
        opacity: 0;
    }

    60% {
        transform: scale(1.1) rotate(10deg);
        opacity: 1;
    }

    100% {
        transform: scale(1) rotate(0deg);
        opacity: 1;
    }
}

.error-counter-badge.fade-out {
    animation: badgeDisappear 0.4s ease-in forwards;
}

@keyframes badgeDisappear {
    0% {
        transform: scale(1) rotate(0deg);
        opacity: 1;
    }

    50% {
        transform: scale(1.1) rotate(-10deg);
        opacity: 0.5;
    }

    100% {
        transform: scale(0) rotate(180deg);
        opacity: 0;
    }
}

@keyframes pulseprimarybtn {
    0% {
        box-shadow: 0 4px 8px var(--primary-color);
        transform: scale(1);
    }

    50% {
        box-shadow: 0 6px 12px var(--primary-color);
        transform: scale(1.02);
    }

    100% {
        box-shadow: 0 4px 8px var(--primary-color);
        transform: scale(1);
    }
}

/* Stili per la visualizzazione dettagliata dei risultati */
.detailed-results {
    background: var(--white);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    padding: 45px;
    margin: 45px 0;
    border: 1px solid var(--medium-gray);
}

.detailed-results h3 {
    color: var(--primary-color);
    margin-bottom: 20px;
    font-size: 1.3rem;
    display: flex;
    align-items: center;
    gap: 5px;
    border-bottom: 2px solid var(--light-gray);
    padding-bottom: 10px;
}

.results-list {
    max-height: 400px;
    overflow-y: auto;
    padding-right: 10px;
    min-height: 100px;
    /* Altezza minima */
}

/* Stile della scrollbar */
.results-list::-webkit-scrollbar {
    width: 8px;
}

.results-list::-webkit-scrollbar-track {
    background: var(--light-gray);
    border-radius: 4px;
}

.results-list::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
}

.results-list::-webkit-scrollbar-thumb:hover {
    background: var(--primary-dark);
}

.result-item {
    background: var(--white);
    border-radius: var(--border-radius);
    padding: 20px;
    margin-bottom: 20px;
    border: 1px solid var(--medium-gray);
    border-left: 4px solid var(--success-color);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

.result-item.wrong {
    border-left-color: rgba(210, 4, 4, 0.91);
    background: #ffebee;
}

.result-item-header {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--light-gray);
}

.result-status {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.9rem;
    font-weight: bold;
    flex-shrink: 0;
}

.result-status.correct {
    background: var(--success-color);
    color: white;
}

.result-status.wrong {
    background: rgba(210, 4, 4, 0.91);
    color: white;
}

.result-question {
    font-weight: 600;
    color: var(--secondary-color);
    flex: 1;
    line-height: 1.4;
    font-size: 1.05rem;
}

.result-correct-answer {
    background: #e8f5e9;
    border-radius: var(--border-radius);
    padding: 12px;
    margin-top: 10px;
    border-left: 3px solid var(--success-color);
    display: flex;
    align-items: flex-start;
    gap: 10px;
}

.result-correct-answer i {
    color: var(--success-color);
    margin-top: 2px;
    font-size: 1.1rem;
}

.result-image {
    max-width: 100%;
    max-height: 200px;
    border-radius: 6px;
    margin: 10px 0;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.answer-image {
    max-width: 100%;
    max-height: 120px;
    border-radius: 4px;
    margin-top: 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

/* Animazione per l'apparizione degli elementi */
.result-item {
    animation: fadeInUp 0.5s ease-out;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Stile per il pulsante "Vedi Risultati" */
#view-results-btn {
    background: var(--secondary-color);
    color: var(--white);
    border: 2px solid var(--secondary-color);
    animation: pulse 2s infinite;
}

#view-results-btn:hover {
    background: #1a252f;
    border-color: #1a252f;
}

.no-results-message {
    text-align: center;
    padding: 40px;
    color: var(--text-light);
}

.no-results-message i {
    font-size: 3rem;
    margin-bottom: 15px;
    color: var(--medium-gray);
}

.no-results-message p {
    font-size: 1.1rem;
}

.user-answer {
    background: rgba(255, 255, 255, 0.7);
    border-radius: var(--border-radius);
    padding: 10px;
    margin: 10px 0;
    display: flex;
    align-items: flex-start;
    gap: 10px;
    border-left: 3px solid;
}

.user-correct {
    border-left-color: var(--success-color);
    background: rgba(39, 174, 96, 0.1);
}

.user-wrong {
    border-left-color: var(--warning-color);
    background: rgba(243, 156, 18, 0.1);
}

.user-answer i {
    margin-top: 2px;
    font-size: 1.1rem;
}

.user-correct i {
    color: var(--success-color);
}

.user-wrong i {
    color: var(--warning-color);
}

/* Messaggi di notifica */
.message {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 15px 20px;
    border-radius: var(--border-radius);
    color: white;
    z-index: 1000;
    animation: slideIn 0.3s ease;
}

.message.success {
    background: var(--success-color);
}

.message.error {
    background: var(--danger-color);
}

.message.info {
    background: var(--primary-color);
}

@keyframes slideIn {
    from {
        transform: translateX(100%);
    }

    to {
        transform: translateX(0);
    }
}

/* Risultati analisi */
.analysis-results {
    background: var(--light-gray);
    padding: 20px;
    border-radius: var(--border-radius);
    margin: 10px 0;
}

.analysis-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
    margin: 15px 0;
}

.analysis-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    background: white;
    border-radius: var(--border-radius);
}

.key-terms {
    margin-top: 15px;
}

.terms-list {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 10px;
}

.term-tag {
    background: var(--primary-color);
    color: white;
    padding: 4px 12px;
    border-radius: 15px;
    font-size: 0.9rem;
}

/* Note items */
.note-item {
    background: white;
    border: 1px solid var(--medium-gray);
    border-radius: var(--border-radius);
    padding: 15px;
    margin-bottom: 15px;
}

.note-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.note-date {
    font-size: 0.9rem;
    color: var(--text-light);
}

.note-delete {
    background: none;
    border: none;
    color: var(--text-light);
    cursor: pointer;
    padding: 5px;
}

.note-content {
    min-height: 60px;
    padding: 10px;
    border: 1px dashed var(--medium-gray);
    border-radius: 4px;
}

.note-content:focus {
    outline: none;
    border-color: var(--primary-color);
}

/* ===================== */
/* STILI MATERIE ORALI MIGLIORATI */
/* ===================== */

/* Categorie materie */
.subject-category { margin: 30px 0; background: var(--white); padding: 20px; border-radius: var(--border-radius); box-shadow: var(--box-shadow); }
.subject-category .subject-cards { margin-top: 10px; }

.category-title,
.category-title-secondary {
  display:flex;
  align-items:center;
  gap:10px;
  color: var(--primary-color);
  font-size: 1.2rem;
  font-weight: 700;
  letter-spacing:.6px;
  text-transform: none;
  margin: 0 0 14px;
  padding: 0;
  background: transparent;
  box-shadow: none;
  border-radius: 0;
}
.category-title i,
.category-title-secondary i {
    color: var(--primary-color);
}

/* Materie orali - stile speciale */
.oral-subject {
    border: 2px solid var(--primary-color);
    position: relative;
}

.oral-subject::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: linear-gradient(90deg, var(--primary-color), var(--primary-light));
}

.oral-subject .subject-icon {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
}

/* Metodo di studio mini */
.study-method-mini {
    opacity: 0.9;
    transform: scale(0.95);
    transition: all 0.3s ease;
}

.study-method-mini:hover {
    opacity: 1;
    transform: scale(0.97);
}

.advanced-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    background: linear-gradient(135deg, #27ae60, #2ecc71);
    color: white;
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 0.7rem;
    font-weight: 600;
}

/* ards migliorate */
.flashcards-container {
    background: var(--white);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    overflow: hidden;
    margin: -10px 0;
}

.flashcards-header {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: white;
    padding: 30px 40px;
    display: flex;
    align-items: center;
    gap: 15px;
}

.flashcards-header h3 {
    margin: 0;
    flex: 1;
    font-size: 1.4rem;
}

.flashcard-content {
    padding: 40px;
    text-align: center;
}

.flashcard {
    width: 100%;
    max-width: 600px;
    height: 280px;
    margin: 0 auto 30px;
    perspective: 1000px;
    cursor: pointer;
}

.flashcard-inner {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.flashcard.flipped .flashcard-inner {
    transform: rotateY(180deg);
}

.flashcard-front,
.flashcard-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 12px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 30px;
    text-align: center;
}

.flashcard-front {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
    color: white;
}

.flashcard-back {
    background: linear-gradient(135deg, #a8324a 0%, #802433 100%);
    color: white;
    transform: rotateY(180deg);
}

.flashcard-front h4 {
    font-size: 1.4rem;
    font-weight: 600;
    margin: 0;
    line-height: 1.4;
}

.flashcard-back p {
    font-size: 1.2rem;
    line-height: 1.6;
    margin: 0;
}

.flashcard-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    margin-bottom: 20px;
    flex-wrap: wrap;
}

.flashcard-btn {
    background: var(--light-gray);
    color: var(--text-color);
    border: 1px solid var(--medium-gray);
    padding: 10px 20px;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: var(--transition);
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 8px;
}

.flashcard-btn:hover {
    background: var(--medium-gray);
    transform: translateY(-2px);
}

.flashcard-progress {
    color: var(--text-color);
    font-weight: 600;
    background: var(--light-gray);
    padding: 8px 16px;
    border-radius: var(--border-radius);
    min-width: 120px;
}

/* Indicatore flip */
.flashcard-hint {
    color: var(--text-light);
    font-size: 0.9rem;
    margin-top: 10px;
    font-style: italic;
}

/* Responsive */
@media (max-width: 768px) {
    .rating-buttons {
        flex-direction: column;
        align-items: center;
    }

    .rate-btn {
        max-width: 100%;
        min-width: 200px;
    }

    .flashcard-controls {
        flex-direction: column;
        gap: 10px;
    }

    .session-stats {
        flex-direction: column;
        gap: 10px;
    }
}

/* ===================== */
/* MENU A TENDINA (SOLO IN DASHBOARD) */
/* ===================== */

/* Bottone Menu Hamburger */
.menu-toggle {
    position: absolute;
    top: 30px;
    left: 30px;
    background: var(--primary-color);
    color: white;
    border: none;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 100;
    transition: var(--transition);
    box-shadow: var(--box-shadow);
}

.menu-toggle:hover {
    background: var(--primary-dark);
    transform: scale(1.1);
}

/* Nascondi il menu quando non siamo nella dashboard */
#auth-screen .menu-toggle,
#quiz-screen .menu-toggle,
#results-screen .menu-toggle {
    display: none;
}

/* Menu Overlay */
.sidebar-menu {
    position: fixed;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    z-index: 1000;
    transition: left 0.3s ease;
    display: none;
    /* Nascosto di default */
}

/* Mostra il menu solo nella dashboard */
#user-dashboard .sidebar-menu {
    display: block;
}

.sidebar-menu.active {
    left: 0;
}

.menu-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(5px);
}

.menu-content {
    position: absolute;
    top: 0;
    left: 0;
    width: 300px;
    height: 100%;
    background: var(--white);
    box-shadow: 2px 0 15px rgba(0, 0, 0, 0.1);
    overflow-y: auto;
    transform: translateX(-100%);
    transition: transform 0.3s ease;
}

.sidebar-menu.active .menu-content {
    transform: translateX(0);
}

/* Header Menu */
.menu-header {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: white;
    padding: 30px 20px;
    display: flex;
    align-items: center;
    gap: 15px;
    position: relative;
}

.menu-logo {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    border: 2px solid white;
}

.menu-header h3 {
    margin: 0;
    font-family: 'Lobster', cursive;
    font-size: 1.5rem;
    flex: 1;
}

.menu-close {
    background: none;
    border: none;
    color: white;
    font-size: 1.2rem;
    cursor: pointer;
    padding: 5px;
    border-radius: 3px;
    transition: var(--transition);
}

.menu-close:hover {
    background: rgba(255, 255, 255, 0.2);
}

/* Navigazione Menu */
.menu-nav {
    padding: 20px 0;
}

.menu-item {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 15px 20px;
    color: var(--text-color);
    text-decoration: none;
    transition: var(--transition);
    border-left: 4px solid transparent;
}

.menu-item:hover {
    background: var(--light-gray);
    border-left-color: var(--primary-color);
    color: var(--primary-color);
}

.menu-item i {
    width: 20px;
    text-align: center;
    font-size: 1.1rem;
}

.menu-divider {
    height: 1px;
    background: var(--medium-gray);
    margin: 20px;
}

.menu-subtitle {
    color: var(--text-light);
    font-size: 0.9rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    padding: 0 20px 10px;
    margin: 0;
}

/* Footer Menu */
.menu-footer {
    padding: 20px;
    border-top: 1px solid var(--medium-gray);
    margin-top: auto;
}

.menu-footer p {
    color: var(--text-light);
    font-size: 0.8rem;
    text-align: center;
    margin: 0;
}

/* Responsive Menu */
@media (max-width: 480px) {
    .menu-content {
        width: 280px;
    }

    .menu-toggle {
        top: 25px;
        left: 25px;
        width: 45px;
        height: 45px;
    }
}

/* ===================== */
/* SCHERMATA FLASHCARDS DEDICATA */
/* ===================== */

/* Container principale - FIX CRITICO */
.flashcards-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    z-index: 9999;
    display: none;
    overflow-y: auto;
}

.flashcards-container {
    min-height: 100vh;
    background: var(--white);
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.1);
    display: flex;
    flex-direction: column;
}

/* Header fisso */
.flashcards-screen .flashcards-header {
    background: #ffffff;
    /* BIANCO */
    color: white;
    padding: 20px 30px;
    display: flex;
    align-items: center;
    gap: 20px;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
    flex-shrink: 0;
}

.header-title {
    display: flex;
    align-items: center;
    gap: 12px;
    flex: 1;
}

.header-title h3 {
    margin: 0;
    font-size: 1.4rem;
    font-weight: 600;
}

.header-stats {
    display: flex;
    gap: 10px;
}

.stat-badge {
    background: rgba(255, 255, 255, 0.2);
    padding: 8px 12px;
    border-radius: 20px;
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.9rem;
    backdrop-filter: blur(10px);
    cursor: default;
}

.management-buttons {
    display: flex;
    gap: 10px;
    margin-left: 15px;
}

.management-btn {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.3);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
}

.stat-badge,
.management-btn,
.reset-deck-btn {
    position: relative;
}

.management-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.1);
}

/* Contenuto principale - FIX IMPORTANTE */
.flashcard-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding: 0;
    min-height: 0;
    background: #ffffff;
    /* BIANCO */
}

/* Container opzioni di studio */
.study-options-container {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 5px 5px;
    overflow-y: auto;
}

.study-options {
    max-width: 1000px;
    width: 100%;
    max-height: 100%;
    overflow-y: auto;
    padding: 30px;
    margin: 0 auto;
}

.study-header {
    text-align: center;
    margin-bottom: 40px;
}

.study-actions {
    display: flex;
    justify-content: center;
    margin-bottom: 25px;
    flex-wrap: wrap;
}

.study-settings-panel {
    display: flex;
    align-items: stretch;
    gap: 18px;
    padding: 22px 28px;
    border-radius: 26px;
    background: radial-gradient(circle at top left, rgba(255, 255, 255, 0.95), rgba(248, 248, 248, 0.8));
    box-shadow: 0 22px 55px rgba(0, 0, 0, 0.12);
    border: 1px solid rgba(128, 36, 51, 0.1);
    margin-bottom: 32px;
    position: relative;
    overflow: hidden;
}

.study-settings-icon {
    width: 54px;
    height: 54px;
    border-radius: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, rgba(128, 36, 51, 0.2), rgba(128, 36, 51, 0.05));
    color: var(--primary-color);
    font-size: 1.35rem;
    flex-shrink: 0;
}

.study-settings-content {
    display: flex;
    flex-direction: column;
    gap: 8px;
    flex: 1;
}

.study-quantity-row {
    display: flex;
    align-items: center;
    gap: 24px;
}

.study-quantity-row .study-settings-control {
    flex: 0 0 220px;
}

.study-settings-summary {
    flex: 1;
    display: flex;
    align-items: center;
    gap: 10px;
    background: rgba(128, 36, 51, 0.08);
    border-radius: 14px;
    padding: 10px 16px;
    color: var(--secondary-color);
    font-weight: 500;
    font-size: 0.95rem;
}

.study-settings-summary i {
    color: var(--primary-color);
}

.study-settings-content label {
    font-weight: 700;
    color: var(--secondary-color);
    display: block;
    font-size: 1.05rem;
}

.study-settings-control {
    max-width: 320px;
}

.flashcard-limit-select {
    width: 100%;
    border-radius: 14px;
    border: 1px solid rgba(128, 36, 51, 0.25);
    padding: 12px 18px;
    font-weight: 500;
    font-size: 1rem;
    background: rgba(255, 255, 255, 0.9);
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.flashcard-limit-select:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(128, 36, 51, 0.12);
}

.study-settings-hint {
    margin: 0;
    color: var(--text-light);
    font-size: 0.85rem;
    font-weight: 500;
}

.study-settings-hint strong {
    color: var(--primary-color);
}

.reset-deck-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0;
    padding: 12px 22px;
    border-radius: 999px;
    border: none;
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    color: var(--white);
    font-weight: 600;
    font-size: 0.95rem;
    cursor: pointer;
    box-shadow: 0 10px 25px rgba(128, 36, 51, 0.25);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.reset-deck-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 15px 32px rgba(128, 36, 51, 0.35);
}

.reset-deck-btn:focus {
    outline: 3px solid rgba(128, 36, 51, 0.35);
    outline-offset: 3px;
}

.study-header h2 {
    color: var(--primary-color);
    font-size: 2rem;
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
}

.study-header p {
    color: var(--text-light);
    font-size: 1.1rem;
}

.study-option-cards {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin-bottom: 40px;
}

.study-option-card {
    background: var(--white);
    border-radius: 16px;
    padding: 25px;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    border: 1px solid rgba(128, 36, 51, 0.15);
    box-shadow: var(--box-shadow);
    display: flex;
    align-items: center;
    gap: 20px;
    position: relative;
    overflow: hidden;
}

.study-option-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 5px;
    height: 100%;
    background: linear-gradient(180deg, var(--primary-light), var(--primary-dark));
    transition: width 0.3s ease;
}

.study-option-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 18px 38px rgba(128, 36, 51, 0.18);
    border-color: rgba(128, 36, 51, 0.25);
}

.study-option-card:hover::before {
    width: 9px;
}

.card-icon {
    position: relative;
    width: 70px;
    height: 70px;
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8rem;
    color: white;
    flex-shrink: 0;
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    box-shadow: 0 12px 24px rgba(128, 36, 51, 0.25);
}

.card-badge {
    position: absolute;
    top: -8px;
    right: -8px;
    background: var(--primary-dark);
    color: white;
    border-radius: 12px;
    padding: 4px 8px;
    font-size: 0.8rem;
    font-weight: 600;
    min-width: 24px;
    text-align: center;
    border: 2px solid white;
}

.card-content {
    flex: 1;
}

.card-content h4 {
    color: var(--secondary-color);
    font-size: 1.3rem;
    margin-bottom: 8px;
    font-weight: 600;
}

.card-content p {
    color: var(--text-white);
    margin-bottom: 15px;
    line-height: 1.5;
}

.card-progress {
    display: flex;
    align-items: center;
    gap: 12px;
}

.card-progress .progress-bar {
    flex: 1;
    height: 6px;
    background: rgba(128, 36, 51, 0.12);
    border-radius: 3px;
    overflow: hidden;
}

.card-progress .progress-fill {
    height: 100%;
    border-radius: 3px;
    transition: width 0.5s ease;
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
}

.card-progress span {
    font-size: 0.9rem;
    color: rgba(128, 36, 51, 0.75);
    font-weight: 500;
    min-width: 60px;
}

.card-stats {
    display: flex;
    gap: 15px;
}

.stat {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.9rem;
    color: var(--secondary-color);
}

.card-arrow {
    color: rgba(128, 36, 51, 0.55);
    font-size: 1.2rem;
    transition: transform 0.3s ease;
}

.study-option-card:hover .card-arrow {
    transform: translateX(5px);
    color: var(--primary-dark);
}

.study-footer {
    border-top: 1px solid var(--medium-gray);
    padding-top: 25px;
}

.deck-stats {
    display: flex;
    justify-content: center;
    gap: 30px;
    flex-wrap: wrap;
}

.stat-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 15px;
    background: var(--light-gray);
    border-radius: 10px;
    font-size: 0.9rem;
    font-weight: 500;
}

.stat-item i {
    color: var(--primary-color);
}

/* Sessione di studio */
.study-session {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
    overflow: hidden;
}

.session-header {
    background: var(--white);
    padding: 15px 30px;
    border-bottom: 1px solid var(--medium-gray);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    position: sticky;
    top: 0;
    z-index: 90;
    flex-shrink: 0;
}

.session-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.session-stats {
    display: flex;
    gap: 25px;
}

.session-stats .stat {
    display: flex;
    align-items: center;
    gap: 8px;
    background: none;
    padding: 0;
    color: var(--text-color);
    font-weight: 600;
}

.session-progress {
    background: var(--light-gray);
    border-radius: 10px;
    padding: 15px;
}

.progress-info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text-color);
}

.progress-bar {
    width: 100%;
    height: 8px;
    background: var(--medium-gray);
    border-radius: 4px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--primary-color), var(--primary-light));
    border-radius: 4px;
    transition: width 0.5s ease;
}

/* Flashcard Grande */
.flashcard-main {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    /* Cambiato da center a flex-start */
    padding: 20px;
    /* Ridotto il padding */
    min-height: 0;
    overflow-y: auto;
}

.flashcard-container-large {
    width: 100%;
    max-width: 800px;
    margin: 0 auto 30px;
    flex-shrink: 0;
}

.flashcard {
    width: 100%;
    height: 450px;
    perspective: 1200px;
    cursor: pointer;
    flex-shrink: 0;
}

.flashcard-inner {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    display: block !important;
}

.flashcard.flipped .flashcard-inner {
    transform: rotateY(180deg);
}

.flashcard-front,
.flashcard-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 20px;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 40px;
    text-align: center;
}

.flashcard-front {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: white;
    z-index: 2;
}

.flashcard-back {
    background: linear-gradient(135deg, #a8324a 0%, #802433 100%);
    color: white;
    transform: rotateY(180deg);
    z-index: 1;
}

.card-content {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
}

.card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.3);
}

.card-number {
    background: rgba(255, 255, 255, 0.2);
    padding: 6px 12px;
    border-radius: 12px;
    font-size: 0.9rem;
    font-weight: 600;
}

.card-type {
    font-size: 0.9rem;
    opacity: 0.8;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.flashcard-front h3 {
    font-size: 2rem;
    line-height: 1.4;
    margin: auto 0;
    font-weight: 600;
    text-align: center;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.answer-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.answer-scroll-container {
    max-height: 250px;
    overflow-y: auto;
    padding-right: 15px;
    margin: 20px 0;
}

.answer-scroll-container::-webkit-scrollbar {
    width: 8px;
}

.answer-scroll-container::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
}

.answer-scroll-container::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.3);
    border-radius: 4px;
}

.answer-scroll-container::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.5);
}

.flashcard-back p {
    font-size: 1.5rem;
    line-height: 1.7;
    text-align: left;
    margin: 0;
}

.card-hint {
    margin-top: auto;
    padding-top: 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    font-size: 0.9rem;
    opacity: 0.7;
}

/* Sezione Valutazione */
.rating-section {
    width: 100%;
    max-width: 800px;
    margin: 0 auto;
    padding: 30px;
    background: var(--white);
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    flex-shrink: 0;
}

.rating-section h4 {
    text-align: center;
    color: var(--secondary-color);
    margin-bottom: 25px;
    font-size: 1.3rem;
    font-weight: 600;
}

.rating-buttons-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
    margin-bottom: 25px;
}

.rate-btn {
    background: var(--white);
    border: 2px solid var(--medium-gray);
    border-radius: 16px;
    padding: 20px;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    align-items: center;
    gap: 15px;
    text-align: left;
}

.rate-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
}

.rate-btn.difficult {
    border-color: #e74c3c;
}

.rate-btn.difficult:hover {
    background: #ffeaea;
}

.rate-btn.hard {
    border-color: #e67e22;
}

.rate-btn.hard:hover {
    background: #fff3e0;
}

.rate-btn.good {
    border-color: #27ae60;
}

.rate-btn.good:hover {
    background: #e8f5e8;
}

.rate-btn.easy {
    border-color: #2ecc71;
}

.rate-btn.easy:hover {
    background: #e8f6f3;
}

/* Aggiunta: opzione "Non ripetere più" */
.rate-btn.danger {
    border-color: #c0392b;
    background: linear-gradient(135deg, #fff, #fff);
}

.rate-btn.danger:hover {
    background: #fdecea;
    border-color: #a93226;
}

.rate-btn.danger .rate-icon {
    background: linear-gradient(135deg, #e74c3c, #c0392b);
    color: #fff;
}

.rate-icon {
    width: 50px;
    height: 50px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    flex-shrink: 0;
}

.rate-btn.difficult .rate-icon {
    background: #e74c3c;
    color: white;
}

.rate-btn.hard .rate-icon {
    background: #e67e22;
    color: white;
}

.rate-btn.good .rate-icon {
    background: #27ae60;
    color: white;
}

.rate-btn.easy .rate-icon {
    background: #2ecc71;
    color: white;
}

.rate-info {
    flex: 1;
}

.rate-title {
    display: block;
    font-weight: 600;
    color: var(--secondary-color);
    margin-bottom: 4px;
    font-size: 1.1rem;
}

.rate-interval {
    display: block;
    font-size: 0.9rem;
    color: var(--text-light);
}

.rate-badge {
    background: var(--light-gray);
    padding: 6px 12px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--text-color);
}

.rating-footer {
    display: flex;
    justify-content: center;
    gap: 15px;
    flex-wrap: wrap;
}

/* Navigazione */
.navigation-section {
    width: 100%;
    max-width: 800px;
    margin: 0 auto;
    display: flex;
    justify-content: center;
    flex-shrink: 0;
}

.nav-btn {
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 12px;
    padding: 15px 30px;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 10px;
}

.nav-btn:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(128, 36, 51, 0.3);
}

/* Completamento sessione */
.session-complete {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 40px;
    overflow-y: auto;
}

.completion-content {
    text-align: center;
    max-width: 500px;
    width: 100%;
}

.completion-icon {
    font-size: 5rem;
    color: var(--primary-color);
    margin-bottom: 25px;
}

.completion-content h2 {
    color: var(--primary-color);
    font-size: 2.2rem;
    margin-bottom: 10px;
    font-weight: 700;
}

.completion-content p {
    color: var(--text-light);
    font-size: 1.2rem;
    margin-bottom: 30px;
}

.session-summary {
    background: var(--white);
    border-radius: 20px;
    padding: 30px;
    margin-bottom: 30px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
}

.summary-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
}

.summary-item {
    display: flex;
    align-items: center;
    gap: 12px;
    text-align: left;
}

.summary-item i {
    font-size: 1.5rem;
    width: 40px;
    height: 40px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--light-gray);
    color: var(--primary-color);
}

.summary-value {
    display: block;
    font-size: 1.4rem;
    font-weight: 700;
    color: var(--primary-color);
}

.summary-label {
    display: block;
    font-size: 0.9rem;
    color: var(--text-light);
}

.completion-actions {
    display: flex;
    gap: 15px;
    justify-content: center;
    flex-wrap: wrap;
}

/* Bottoni */
.primary-btn {
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 12px;
    padding: 15px 25px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 10px;
}

.primary-btn:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
}

.secondary-btn {
    background: var(--white);
    color: var(--primary-color);
    border: 2px solid var(--primary-color);
    border-radius: 12px;
    padding: 13px 23px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 10px;
}

.secondary-btn:hover {
    background: var(--primary-color);
    color: white;
    transform: translateY(-2px);
}

/* Responsive fixes */
@media (max-width: 768px) {
    .flashcards-screen .flashcards-header {
        padding: 15px 20px;
    }

    .study-options-container {
        padding: 20px 15px;
    }

    .study-options {
        padding: 20px;
    }

    .flashcard-main {
        padding: 15px;
    }

    .flashcard {
        height: 400px;
    }

    .session-header {
        padding: 15px 20px;
    }

    .rating-buttons-grid {
        grid-template-columns: 1fr;
    }

    .summary-grid {
        grid-template-columns: 1fr;
        gap: 15px;
    }
}

@media (max-width: 480px) {
    .flashcards-screen .flashcards-header {
        padding: 12px 15px;
    }

    .study-options-container {
        padding: 15px 10px;
    }

    .study-options {
        padding: 15px;
    }

    .flashcard-main {
        padding: 10px;
    }

    .flashcard {
        height: 350px;
    }

    .rating-section {
        padding: 20px 15px;
    }
}

/* ===================== TOOLTIP */
/* Stili per i tooltip */
.tooltip-container {
    position: relative;
    display: inline-block;
    margin-left: 8px;
    cursor: pointer;
    justify-content: center;
    margin-left: 8px;
    cursor: pointer;
    z-index: 1001;
}

.tooltip-icon {
    color: var(--dark-gray);
    font-size: 0.9em;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    border: 1px solid #666;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    font-weight: bold;
    line-height: 1;
    pointer-events: auto;
    font-family: 'Arial', sans-serif;
}

.tooltip-icon:hover {
    background-color: #f0f0f0;
}

.tooltip-text {
    visibility: hidden;
    width: 280px;
    background-color: var(--primary-color);
    color: #fff;
    text-align: center;
    border-radius: 6px;
    padding: 10px;
    position: absolute;
    z-index: 1;
    bottom: 125%;
    left: 48%;
    transform: translateX(-60%);
    opacity: 0;
    transition: opacity 0.3s;
    font-size: 0.85em;
    line-height: 1.4;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.tooltip-text::after {
    content: "";
    position: absolute;
    top: 100%;
    left: 45%;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: #881f1f transparent transparent transparent;
}

.tooltip-container:hover .tooltip-text,
.tooltip-container.active .tooltip-text {
    visibility: visible;
    opacity: 1;
}

/* Per dispositivi touch */
@media (max-width: 768px) {
    .tooltip-container {
        cursor: pointer;
    }

    .tooltip-text {
        width: 250px;
        font-size: 0.8em;
    }

    /* ===================== */
    /* STILI FLASHCARDS MIGLIORATI */
    /* ===================== */


    /* Scrollbar personalizzata per study-options */
    .study-options::-webkit-scrollbar {
        width: 10px;
    }

    .study-options::-webkit-scrollbar-track {
        background: var(--light-gray);
        border-radius: 8px;
    }

    .study-options::-webkit-scrollbar-thumb {
        background: var(--primary-color);
        border-radius: 8px;
    }

    .study-options::-webkit-scrollbar-thumb:hover {
        background: var(--primary-dark);
    }

    /* Migliora la visualizzazione delle risposte */
    .answer-scroll-container {
        max-height: 320px;
        overflow-y: auto;
        padding: 20px;
        margin: 20px 0;
        background: rgba(255, 255, 255, 0.15);
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.25);
        backdrop-filter: blur(10px);
    }

    .answer-scroll-container p {
        color: white !important;
        font-size: 1.5rem;
        line-height: 1.7;
        margin: 0;
        text-align: left;
        font-weight: 400;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    /* Scrollbar per le risposte */
    .answer-scroll-container::-webkit-scrollbar {
        width: 6px;
    }

    .answer-scroll-container::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 3px;
    }

    .answer-scroll-container::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 3px;
    }

    .answer-scroll-container::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.5);
    }

    /* Ingrandisci le card delle flashcard */
    .flashcard-container-large {
        width: 100%;
        max-width: 950px;
        margin: 0 auto 50px;
    }

    .flashcard {
        width: 100%;
        height: 520px;
        perspective: 1300px;
    }

    .flashcard-front h3 {
        font-size: 2.2rem;
        line-height: 1.4;
        margin: auto 0;
        font-weight: 600;
        text-align: center;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    /* Bottoni di gestione */
    .management-buttons {
        display: flex;
        gap: 10px;
        margin-left: 15px;
    }

    .management-btn {
        background: rgba(255, 255, 255, 0.2);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.3);
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
    }

    .management-btn:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: scale(1.1);
    }

    /* Pannello statistiche */
    .stats-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        z-index: 10000;
        display: flex;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(5px);
    }

    .stats-panel {
        background: var(--white);
        border-radius: 20px;
        padding: 30px;
        max-width: 600px;
        width: 90%;
        max-height: 80vh;
        overflow-y: auto;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .stats-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        padding-bottom: 15px;
        border-bottom: 2px solid var(--light-gray);
    }

    .stats-header h3 {
        color: var(--primary-color);
        margin: 0;
        font-size: 1.4rem;
    }

    .close-stats {
        background: none;
        border: none;
        color: var(--text-light);
        font-size: 1.2rem;
        cursor: pointer;
        padding: 5px;
        border-radius: 3px;
        transition: var(--transition);
    }

    .close-stats:hover {
        color: var(--primary-color);
        background: var(--light-gray);
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin-bottom: 25px;
    }

    .stat-card {
        background: var(--light-gray);
        border-radius: 12px;
        padding: 20px;
        text-align: center;
        border-left: 4px solid var(--primary-color);
    }

    .stat-card .stat-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary-color);
        display: block;
        margin-bottom: 5px;
    }

    .stat-card .stat-label {
        font-size: 0.9rem;
        color: var(--text-light);
        font-weight: 500;
    }

    .stats-details {
        background: var(--light-gray);
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
    }

    .stat-detail {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid var(--medium-gray);
    }

    .stat-detail:last-child {
        border-bottom: none;
    }

    .detail-label {
        color: var(--text-color);
        font-weight: 500;
    }

    .detail-value {
        color: var(--primary-color);
        font-weight: 600;
    }

    .stats-actions {
        display: flex;
        justify-content: center;
    }

    /* Migliora i bottoni di valutazione */
    .rating-buttons-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
        margin: 30px 0;
    }

    .rate-btn {
        background: rgba(255, 255, 255, 0.98);
        border: 2px solid;
        border-radius: 16px;
        padding: 25px 20px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        gap: 15px;
        text-align: left;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
    }

    .rate-btn:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.2);
    }

    .rate-info {
        flex: 1;
    }

    .rate-title {
        color: var(--dark-gray) !important;
        font-weight: 700;
        font-size: 1.2rem;
        margin-bottom: 8px;
        display: block;
    }

    .rate-interval {
        color: var(--text-color) !important;
        font-size: 1rem;
        font-weight: 600;
        display: block;
    }

    /* Colori specifici per ogni bottone di valutazione */
    .rate-btn.difficult {
        border-color: #e74c3c;
        background: linear-gradient(135deg, #fff, #ffeaea);
    }

    .rate-btn.difficult:hover {
        background: linear-gradient(135deg, #ffeaea, #ffd4d4);
    }

    .rate-btn.hard {
        border-color: #e67e22;
        background: linear-gradient(135deg, #fff, #fff3e0);
    }

    .rate-btn.hard:hover {
        background: linear-gradient(135deg, #fff3e0, #ffe8cc);
    }

    .rate-btn.good {
        border-color: #27ae60;
        background: linear-gradient(135deg, #fff, #e8f5e8);
    }

    .rate-btn.good:hover {
        background: linear-gradient(135deg, #e8f5e8, #d4f0d4);
    }

    .rate-btn.easy {
        border-color: #2ecc71;
        background: linear-gradient(135deg, #fff, #e8f6f3);
    }

    .rate-btn.easy:hover {
        background: linear-gradient(135deg, #e8f6f3, #d4f0e8);
    }

    /* Responsive improvements */
    @media (max-width: 768px) {
        .study-options {
            padding: 20px 15px;
            max-height: 65vh;
        }

        .flashcard {
            height: 450px;
        }

        .flashcard-front h3 {
            font-size: 1.8rem;
        }

        .answer-scroll-container p {
            font-size: 1.3rem;
        }

        .rating-buttons-grid {
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .stats-grid {
            grid-template-columns: 1fr;
        }

        .management-buttons {
            margin-left: 10px;
        }

        .management-btn {
            width: 35px;
            height: 35px;
        }
    }

    @media (max-width: 480px) {
        .study-options-container {
            padding: 20px 10px;
            min-height: 60vh;
        }

        .flashcard {
            height: 400px;
            padding: 15px;
        }

        .flashcard-front h3 {
            font-size: 1.5rem;
        }

        .answer-scroll-container {
            max-height: 250px;
            padding: 15px;
        }

        .answer-scroll-container p {
            font-size: 1.2rem;
        }
    }

    /* ===================== */
    /* CORREZIONI VISUALIZZAZIONE FLASHCARDS */
    /* ===================== */

    /* Assicurati che la flashcard sia visibile */
    .flashcard-main {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        padding: 30px;
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        min-height: 500px;
    }

    /* Migliora la visibilità del contenuto */
    .flashcard-front h3,
    .flashcard-back p {
        color: white !important;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    /* Sistema l'header della sessione */
    .session-header {
        background: var(--white);
        padding: 15px 30px;
        border-bottom: 1px solid var(--medium-gray);
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }

    .session-stats {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
    }

    .session-stats .stat {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        background: var(--light-gray);
        border-radius: 8px;
        font-weight: 600;
        color: var(--text-color);
    }

    /* Migliora la progress bar */
    .session-progress {
        margin-top: 10px;
    }

    .progress-info {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
        font-size: 0.9rem;
        font-weight: 600;
    }

    /* Assicurati che la flashcard sia cliccabile */
    .flashcard {
        cursor: pointer;
        transition: transform 0.3s ease;
    }

    .flashcard:hover {
        transform: scale(1.02);
    }

    /* Sistema i bottoni di navigazione */
    .navigation-section {
        margin-top: 20px;
    }

    .nav-btn {
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 12px;
        padding: 12px 24px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .nav-btn:hover {
        background: var(--primary-dark);
        transform: translateY(-2px);
    }

    /* Sistema la visualizzazione su mobile */
    @media (max-width: 768px) {
        .flashcard-main {
            padding: 15px;
        }

        .session-stats {
            flex-direction: column;
            gap: 10px;
        }

        .session-stats .stat {
            justify-content: center;
        }
    }

    /* ===================== */
    /* MIGLIORAMENTI FLASHCARDS */
    /* ===================== */

    /* Container flashcard più grande e responsive */
    .flashcard-container-large {
        width: 100%;
        max-width: 1200px;
        margin: 20px auto 40px;
        min-height: 500px;
        display: block !important;
    }

    .flashcard {
        width: 100%;
        height: 65vh;
        min-height: 500px;
        max-height: 700px;
        perspective: 1400px;
        cursor: pointer;
        display: block !important;
        margin: 0 auto;
    }

    .flashcard-inner {
        width: 100%;
        height: 100%;
        position: relative;
        transform-style: preserve-3d;
        transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        display: block !important;
    }

    .flashcard-front,
    .flashcard-back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        border-radius: 24px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        display: flex !important;
        align-items: center;
        justify-content: center;
        padding: 50px;
        text-align: center;
    }

    .flashcard-front {
        background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
        color: white;
        z-index: 2;
    }

    .flashcard-back {
        background: linear-gradient(135deg, #a8324a 0%, #802433 100%);
        color: white;
        transform: rotateY(180deg);
        z-index: 1;
    }

    /* Migliora il contenuto delle card */
    .card-content {
        width: 100%;
        height: 100%;
        display: flex !important;
        flex-direction: column;
        justify-content: space-between;
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 2px solid rgba(255, 255, 255, 0.3);
    }

    .card-number {
        background: rgba(255, 255, 255, 0.25);
        padding: 8px 16px;
        border-radius: 16px;
        font-size: 1rem;
        font-weight: 600;
        backdrop-filter: blur(10px);
    }

    .card-type {
        font-size: 1rem;
        opacity: 0.9;
        text-transform: uppercase;
        letter-spacing: 1.5px;
        font-weight: 500;
    }

    /* Contenitori scrollabili migliorati */
    .question-content,
    .answer-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
        width: 100%;
    }

    .question-scroll-container,
    .answer-scroll-container {
        max-height: 350px;
        overflow-y: auto;
        padding: 25px;
        margin: 20px 0;
        background: rgba(255, 255, 255, 0.15);
        border-radius: 16px;
        border: 2px solid rgba(255, 255, 255, 0.25);
        backdrop-filter: blur(15px);
    }

    .question-scroll-container h3,
    .answer-scroll-container p {
        color: white !important;
        text-align: center;
        margin: 0;
        text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        line-height: 1.6;
    }

    .question-scroll-container h3 {
        font-size: 2.4rem !important;
        font-weight: 600;
        line-height: 1.4;
    }

    .answer-scroll-container p {
        font-size: 1.8rem !important;
        line-height: 1.7;
        text-align: left;
    }

    /* Scrollbar personalizzata */
    .question-scroll-container::-webkit-scrollbar,
    .answer-scroll-container::-webkit-scrollbar {
        width: 8px;
    }

    .question-scroll-container::-webkit-scrollbar-track,
    .answer-scroll-container::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 4px;
    }

    .question-scroll-container::-webkit-scrollbar-thumb,
    .answer-scroll-container::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.4);
        border-radius: 4px;
    }

    .question-scroll-container::-webkit-scrollbar-thumb:hover,
    .answer-scroll-container::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.6);
    }

    /* Hint migliorato */
    .card-hint {
        margin-top: auto;
        padding-top: 25px;
        border-top: 2px solid rgba(255, 255, 255, 0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        font-size: 1rem;
        opacity: 0.8;
        font-weight: 500;
    }

    /* Sezione valutazione migliorata */
    .rating-section {
        width: 100%;
        max-width: 10px;
        margin: 30px auto 0;
        padding: 35px;
        background: var(--white);
        border-radius: 24px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        border: 2px solid var(--primary-color);
    }

    .rating-section h4 {
        text-align: center;
        color: var(--primary-color);
        margin-bottom: 30px;
        font-size: 1.5rem;
        font-weight: 700;
    }

    .rating-buttons-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
        margin-bottom: 30px;
    }

    .rate-btn {
        background: var(--white);
        border: 3px solid;
        border-radius: 20px;
        padding: 25px 20px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        gap: 18px;
        text-align: left;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }

    .rate-btn:hover {
        transform: translateY(-5px) scale(1.02);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
    }

    .rate-btn:active {
        transform: translateY(-2px) scale(1);
    }

    .rate-icon {
        width: 60px;
        height: 60px;
        border-radius: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.8rem;
        flex-shrink: 0;
        transition: all 0.3s ease;
    }

    .rate-info {
        flex: 1;
    }

    .rate-title {
        display: block;
        font-weight: 700;
        color: var(--dark-gray);
        margin-bottom: 6px;
        font-size: 1.3rem;
    }

    .rate-interval {
        display: block;
        font-size: 1rem;
        color: var(--text-color);
        font-weight: 600;
    }

    .rate-badge {
        background: var(--light-gray);
        padding: 8px 16px;
        border-radius: 16px;
        font-size: 0.9rem;
        font-weight: 700;
        color: var(--text-color);
        transition: all 0.3s ease;
    }

    /* Colori specifici per ogni bottone */
    .rate-btn.difficult {
        border-color: #e74c3c;
        background: linear-gradient(135deg, #fff, #ffeaea);
    }

    .rate-btn.difficult:hover {
        background: linear-gradient(135deg, #ffeaea, #ffd4d4);
        border-color: #c0392b;
    }

    .rate-btn.difficult .rate-icon {
        background: #e74c3c;
        color: white;
    }

    .rate-btn.hard {
        border-color: #e67e22;
        background: linear-gradient(135deg, #fff, #fff3e0);
    }

    .rate-btn.hard:hover {
        background: linear-gradient(135deg, #fff3e0, #ffe8cc);
        border-color: #d35400;
    }

    .rate-btn.hard .rate-icon {
        background: #e67e22;
        color: white;
    }

    .rate-btn.good {
        border-color: #27ae60;
        background: linear-gradient(135deg, #fff, #e8f5e8);
    }

    .rate-btn.good:hover {
        background: linear-gradient(135deg, #e8f5e8, #d4f0d4);
        border-color: #229954;
    }

    .rate-btn.good .rate-icon {
        background: #27ae60;
        color: white;
    }

    .rate-btn.easy {
        border-color: #2ecc71;
        background: linear-gradient(135deg, #fff, #e8f6f3);
    }

    .rate-btn.easy:hover {
        background: linear-gradient(135deg, #e8f6f3, #d4f0e8);
        border-color: #27ae60;
    }

    .rate-btn.easy .rate-icon {
        background: #2ecc71;
        color: white;
    }

    /* Footer valutazione */
    .rating-footer {
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
        padding-top: 25px;
        border-top: 2px solid var(--light-gray);
    }

    .rating-footer .secondary-btn {
        background: #fff;
        color: var(--primary-color);
        border: 2px solid var(--primary-color);
        border-radius: 20px;
        padding: 16px 28px;
        font-size: 1.1rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.25s ease;
        display: flex;
        align-items: center;
        gap: 10px;
        box-shadow: 0 6px 0 rgba(92, 26, 38, 0.08);
    }

    .rating-footer .secondary-btn:hover {
        background: var(--primary-color);
        color: #fff;
        transform: translateY(-2px);
        box-shadow: 0 10px 18px rgba(128, 36, 51, 0.25);
    }

    /* Animazioni migliorate */
    .flashcard {
        animation: cardAppear 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @keyframes cardAppear {
        0% {
            opacity: 0;
            transform: scale(0.8) translateY(20px);
        }

        100% {
            opacity: 1;
            transform: scale(1) translateY(0);
        }
    }

    .flashcard.flipped .flashcard-inner {
        transform: rotateY(180deg);
    }

    /* Responsive design per flashcards */
    @media (max-width: 1200px) {
        .flashcard-container-large {
            max-width: 95%;
        }

        .flashcard {
            height: 60vh;
            min-height: 450px;
        }

        .question-scroll-container h3 {
            font-size: 2rem !important;
        }

        .answer-scroll-container p {
            font-size: 1.6rem !important;
        }
    }

    @media (max-width: 768px) {
        .flashcard {
            height: 55vh;
            min-height: 400px;
            max-height: 500px;
        }

        .flashcard-front,
        .flashcard-back {
            padding: 30px;
        }

        .question-scroll-container,
        .answer-scroll-container {
            max-height: 250px;
            padding: 20px;
        }

        .question-scroll-container h3 {
            font-size: 1.6rem !important;
        }

        .answer-scroll-container p {
            font-size: 1.3rem !important;
        }

        .rating-buttons-grid {
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .rating-section {
            padding: 25px 20px;
            margin: 20px auto 0;
        }

        .rate-btn {
            padding: 20px 15px;
        }

        .rate-icon {
            width: 50px;
            height: 50px;
            font-size: 1.5rem;
        }
    }

    @media (max-width: 480px) {
        .flashcard {
            height: 50vh;
            min-height: 350px;
        }

        .flashcard-front,
        .flashcard-back {
            padding: 20px;
        }

        .card-header {
            margin-bottom: 20px;
            padding-bottom: 15px;
        }

        .question-scroll-container,
        .answer-scroll-container {
            max-height: 200px;
            padding: 15px;
        }

        .question-scroll-container h3 {
            font-size: 1.4rem !important;
        }

        .answer-scroll-container p {
            font-size: 1.1rem !important;
        }

        .rating-footer {
            flex-direction: column;
            gap: 10px;
        }

        .rating-footer .secondary-btn {
            width: 100%;
            justify-content: center;
        }
    }

    /* Miglioramenti accessibilità */
    .flashcard:focus {
        outline: 3px solid var(--primary-color);
        outline-offset: 4px;
    }

    .rate-btn:focus {
        outline: 3px solid var(--primary-color);
        outline-offset: 2px;
    }

    /* Transizioni smooth per tutti gli elementi interattivi */
    .flashcard,
    .rate-btn,
    .secondary-btn {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Effetto di profondità per le card */
    .flashcard-front,
    .flashcard-back {
        transform-style: preserve-3d;
    }

    .flashcard-front::before,
    .flashcard-back::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(0, 0, 0, 0.1) 100%);
        border-radius: 24px;
        pointer-events: none;
    }

    /* ===================== */
    /* BOTTONI INTERVALLO FLASHCARDS */
    /* ===================== */

    .answer-actions {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-top: 1.5rem;
    }

    .btn-interval {
        background-color: var(--primary-color);
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 0.8rem 1.4rem;
        font-size: 0.95rem;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.25s, transform 0.15s;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .btn-interval:hover {
        background-color: var(--primary-dark);
        transform: translateY(-2px);
    }

    .btn-interval:active {
        transform: translateY(0);
    }

    .btn-interval:focus {
        outline: 2px solid var(--primary-dark);
        outline-offset: 2px;
    }

    /* ===================== */
    /* MIGLIORAMENTI FLASHCARDS */
    /* ===================== */

    /* Container principale migliorato */
    .flashcards-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, var(--light-gray) 0%, #e9ecef 100%);
        z-index: 9999;
        display: none;
        overflow-y: auto;
    }

    .flashcards-container {
        min-height: 100vh;
        background: var(--white);
        display: flex;
        flex-direction: column;
    }

    /* Header migliorato */
    .flashcards-header {
        background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
        color: white;
        padding: 20px 30px;
        display: flex;
        align-items: center;
        gap: 20px;
        position: sticky;
        top: 0;
        z-index: 100;
        box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
    }

    .header-title {
        display: flex;
        align-items: center;
        gap: 12px;
        flex: 1;
    }

    .header-title h3 {
        margin: 0;
        font-size: 1.4rem;
        font-weight: 600;
    }

    .header-stats {
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .stat-badge {
        background: rgba(255, 255, 255, 0.2);
        padding: 8px 12px;
        border-radius: 20px;
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 0.9rem;
        backdrop-filter: blur(10px);
    }

    .management-buttons {
        display: flex;
        gap: 8px;
    }

    .management-btn {
        background: rgba(255, 255, 255, 0.2);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.3);
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
    }

    .management-btn:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: scale(1.1);
    }

    /* Modalità di studio migliorate */
    .study-options-container {
        flex: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 40px 20px;
    }

    .study-options {
        max-width: 1000px;
        width: 100%;
    }

    .study-header {
        text-align: center;
        margin-bottom: 40px;
    }

    .study-header h2 {
        color: var(--primary-color);
        font-size: 2.2rem;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
    }

    .study-header p {
        color: var(--text-light);
        font-size: 1.1rem;
    }

    .study-actions {
        margin-bottom: 25px;
    }

    .study-settings-panel {
        flex-direction: column;
        align-items: stretch;
        gap: 16px;
    }

    .study-quantity-row {
        flex-direction: column;
        align-items: stretch;
        gap: 12px;
    }

    .study-settings-control {
        width: 100%;
        max-width: none;
    }

    .reset-deck-btn {
        width: 100%;
        justify-content: center;
    }

    .study-option-cards {
        display: flex;
        flex-direction: column;
        gap: 20px;
        margin-bottom: 40px;
    }

    .study-option-card {
        background: var(--card-bg, var(--white));
        border-radius: 16px;
        padding: 25px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border: 1px solid rgba(128, 36, 51, 0.15);
        box-shadow: var(--box-shadow);
        display: flex;
        align-items: center;
        gap: 20px;
        position: relative;
        overflow: hidden;
    }

    .study-option-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 5px;
        height: 100%;
        background: linear-gradient(180deg, var(--primary-light), var(--primary-dark));
        transition: width 0.3s ease;
    }

    .study-option-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 18px 38px rgba(128, 36, 51, 0.18);
        border-color: rgba(128, 36, 51, 0.25);
    }

    .study-option-card:hover::before {
        width: 9px;
    }

    .card-icon {
        position: relative;
        width: 70px;
        height: 70px;
        border-radius: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.8rem;
        color: white;
        flex-shrink: 0;
        background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
        box-shadow: 0 12px 24px rgba(128, 36, 51, 0.25);
    }

    .card-badge {
        position: absolute;
        top: -8px;
        right: -8px;
        background: var(--primary-dark);
        color: white;
        border-radius: 12px;
        padding: 4px 8px;
        font-size: 0.8rem;
        font-weight: 600;
        min-width: 24px;
        text-align: center;
        border: 2px solid white;
    }

    .card-content {
        flex: 1;
    }

    .card-content h4 {
        color: var(--secondary-color);
        font-size: 1.3rem;
        margin-bottom: 8px;
        font-weight: 600;
    }

    .card-content p {
        color: var(--text-light);
        margin-bottom: 15px;
        line-height: 1.5;
    }

    .card-progress {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .card-progress .progress-bar {
        flex: 1;
        height: 6px;
        background: rgba(128, 36, 51, 0.12);
        border-radius: 3px;
        overflow: hidden;
    }

    .card-progress .progress-fill {
        height: 100%;
        border-radius: 3px;
        transition: width 0.5s ease;
        background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    }

    .card-stats {
        display: flex;
        gap: 15px;
    }

    .stat {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 0.9rem;
        color: var(--secondary-color);
    }

    .card-arrow {
        color: rgba(128, 36, 51, 0.55);
        font-size: 1.2rem;
        transition: transform 0.3s ease;
    }

    .study-option-card:hover .card-arrow {
        transform: translateX(5px);
        color: var(--primary-dark);
    }

    /* Sessione di studio migliorata */
    .study-session {
        flex: 1;
        display: flex;
        flex-direction: column;
        min-height: 0;
    }

    .session-header {
        background: var(--white);
        padding: 15px 30px;
        border-bottom: 1px solid var(--medium-gray);
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        position: sticky;
        top: 0;
        z-index: 90;
    }

    .session-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }

    .session-stats {
        display: flex;
        gap: 25px;
    }

    .session-stats .stat {
        display: flex;
        align-items: center;
        gap: 8px;
        background: none;
        padding: 0;
        color: var(--text-color);
        font-weight: 600;
    }

    .session-progress {
        background: var(--light-gray);
        border-radius: 10px;
        padding: 15px;
    }

    .progress-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
        font-size: 0.9rem;
        font-weight: 600;
        color: var(--text-color);
    }

    /* Flashcard migliorata */
    .flashcard-main {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 30px;
        background: #ffffff;
        /* BIANCO */
    }

    .flashcard-container-large {
        width: 100%;
        max-width: 800px;
        margin: 0 auto 30px;
    }

    .flashcard {
        width: 100%;
        height: 400px;
        perspective: 1200px;
        cursor: pointer;
    }

    .flashcard-inner {
        width: 100%;
        height: 100%;
        position: relative;
        transform-style: preserve-3d;
        transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .flashcard.flipped .flashcard-inner {
        transform: rotateY(180deg);
    }

    .flashcard-front,
    .flashcard-back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        border-radius: 20px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 40px;
        text-align: center;
    }

    .flashcard-front {
        background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
        color: white;
    }

    .flashcard-back {
        background: linear-gradient(135deg, #a8324a 0%, #802433 100%);
        color: white;
        transform: rotateY(180deg);
    }

    .card-content {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        padding-bottom: 15px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.3);
    }

    .card-number {
        background: rgba(255, 255, 255, 0.2);
        padding: 6px 12px;
        border-radius: 12px;
        font-size: 0.9rem;
        font-weight: 600;
    }

    .card-type {
        font-size: 0.9rem;
        opacity: 0.8;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .question-content,
    .answer-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .question-scroll-container,
    .answer-scroll-container {
        max-height: 200px;
        overflow-y: auto;
        padding: 20px;
        margin: 20px 0;
        background: rgba(255, 255, 255, 0.15);
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.25);
        backdrop-filter: blur(10px);
    }

    .flashcard-front h3 {
        font-size: 1.8rem;
        line-height: 1.4;
        margin: 0;
        font-weight: 600;
        text-align: center;
    }

    .flashcard-back p {
        font-size: 1.4rem;
        line-height: 1.6;
        margin: 0;
        text-align: left;
    }

    .card-hint {
        margin-top: auto;
        padding-top: 20px;
        border-top: 1px solid rgba(255, 255, 255, 0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        font-size: 0.9rem;
        opacity: 0.7;
    }

    /* Valutazione migliorata */
    .rating-section {
        width: 100%;
        max-width: 800px;
        margin: 0 auto;
        padding: 30px;
        background: var(--white);
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .rating-section h4 {
        text-align: center;
        color: var(--secondary-color);
        margin-bottom: 25px;
        font-size: 1.3rem;
        font-weight: 600;
    }

    .rating-buttons-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin-bottom: 25px;
    }

    .rate-btn {
        background: var(--white);
        border: 2px solid var(--medium-gray);
        border-radius: 16px;
        padding: 20px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        gap: 15px;
        text-align: left;
    }

    .rate-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }

    /* Completamento sessione migliorato */
    .session-complete {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 40px;
    }

    .completion-content {
        text-align: center;
        max-width: 500px;
        width: 100%;
    }

    .completion-icon {
        font-size: 5rem;
        color: var(--primary-color);
        margin-bottom: 25px;
    }

    .completion-content h2 {
        color: var(--primary-color);
        font-size: 2.2rem;
        margin-bottom: 10px;
        font-weight: 700;
    }

    .completion-content p {
        color: var(--text-light);
        font-size: 1.2rem;
        margin-bottom: 30px;
    }

    .session-summary {
        background: var(--white);
        border-radius: 20px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .summary-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
    }

    .summary-item {
        display: flex;
        align-items: center;
        gap: 12px;
        text-align: left;
    }

    .summary-item i {
        font-size: 1.5rem;
        width: 40px;
        height: 40px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--light-gray);
        color: var(--primary-color);
    }

    .summary-value {
        display: block;
        font-size: 1.4rem;
        font-weight: 700;
        color: var(--primary-color);
    }

    .summary-label {
        display: block;
        font-size: 0.9rem;
        color: var(--text-light);
    }

    .completion-actions {
        display: flex;
        gap: 15px;
        justify-content: center;
        flex-wrap: wrap;
    }

    /* Responsive design */
    @media (max-width: 768px) {
        .flashcards-header {
            padding: 15px 20px;
            flex-direction: column;
            gap: 15px;
            text-align: center;
        }

        .header-stats {
            justify-content: center;
        }

        .study-options-container {
            padding: 20px 15px;
        }

        .flashcard-main {
            padding: 15px;
        }

        .flashcard {
            height: 350px;
        }

        .rating-buttons-grid {
            grid-template-columns: 1fr;
        }

        .summary-grid {
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .completion-actions {
            flex-direction: column;
        }
    }

    @media (max-width: 480px) {
        .flashcards-header {
            padding: 12px 15px;
        }

        .study-options-container {
            padding: 15px 10px;
        }

        .flashcard-main {
            padding: 10px;
        }

        .flashcard {
            height: 300px;
        }

        .flashcard-front,
        .flashcard-back {
            padding: 20px;
        }

        .flashcard-front h3 {
            font-size: 1.4rem;
        }

        .flashcard-back p {
            font-size: 1.1rem;
        }
    }

    /* ===================== */
    /* MIGLIORAMENTI DRAG GESTURE FLASHCARDS */
    /* ===================== */

    .flashcard {
        cursor: grab;
        user-select: none;
        touch-action: none;
        will-change: transform, box-shadow;
        transition: transform 0.35s cubic-bezier(0.17, 0.55, 0.28, 0.99), box-shadow 0.35s ease;
        transform-origin: center;
        position: relative;
        --drag-glow: 0;
        transform-style: preserve-3d;
    }

    .flashcard:active {
        cursor: grabbing;
    }

    .flashcard.dragging {
        transition: none !important;
        box-shadow: 0 32px 70px rgba(0, 0, 0, 0.28);
    }

    .flashcard::after {
        content: '';
        position: absolute;
        inset: -4%;
        border-radius: inherit;
        background: radial-gradient(circle at 50% 35%, rgba(255, 255, 255, 0.28), rgba(255, 255, 255, 0));
        opacity: 0;
        transform: scale(0.95);
        transition: opacity 0.3s ease, transform 0.3s ease;
        pointer-events: none;
        filter: blur(0px);
    }

    .flashcard.dragging::after {
        opacity: calc(0.35 + 0.35 * var(--drag-glow));
        transform: scale(calc(1 + 0.05 * var(--drag-glow)));
    }

    .drag-hint {
        text-align: center;
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.9rem;
        margin-top: 15px;
        font-style: italic;
        animation: pulseHint 2s infinite;
    }

    @keyframes pulseHint {

        0%,
        100% {
            opacity: 0.7;
        }

        50% {
            opacity: 1;
        }
    }


    /* Miglioramenti bottoni intervallo */
    .rating-buttons-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
    }

    @media (max-width: 768px) {
        .rating-buttons-grid {
            grid-template-columns: 1fr;
        }
    }

    .rate-btn {
        min-height: 80px;
    }

    /* Indicatore sessione */
    .session-indicator {
        background: var(--primary-color);
        color: white;
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 600;
        margin-left: 15px;
    }

    /* Statistiche migliorate */
    .session-stats .stat {
        background: rgba(255, 255, 255, 0.1);
        padding: 8px 12px;
        border-radius: 8px;
        backdrop-filter: blur(10px);
    }
}

/* Effetto dragging sulla flashcard */
.flashcard.dragging {
    cursor: grabbing !important;
    box-shadow: 0 32px 70px rgba(0, 0, 0, 0.28);
    transition: none !important;
}

/* Cursore grab sulla flashcard */
.flashcard {
    cursor: grab;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

.flashcard:active {
    cursor: grabbing;
}

/* Hint trascinamento animato */
.card-hint {
    animation: hintPulse 2s ease-in-out infinite;
}

@keyframes hintPulse {

    0%,
    100% {
        opacity: 0.7;
        transform: translateY(0);
    }

    50% {
        opacity: 1;
        transform: translateY(-3px);
    }
}

/* Miglioramenti bottoni intervallo */
.rating-buttons-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
    margin-bottom: 25px;
}

.rate-btn {
    min-height: 90px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.rate-btn:active {
    transform: translateY(0) scale(0.98);
}

/* Colori distintivi per gli intervalli */
.rate-btn.difficult {
    border-color: #e74c3c;
    background: linear-gradient(135deg, #fff, #ffebee);
}

.rate-btn.difficult:hover {
    background: linear-gradient(135deg, #ffebee, #ffcdd2);
    border-color: #c62828;
}

.rate-btn.difficult .rate-icon {
    background: linear-gradient(135deg, #e74c3c, #c62828);
    color: white;
}

.rate-btn.hard {
    border-color: #ff9800;
    background: linear-gradient(135deg, #fff, #fff3e0);
}

.rate-btn.hard:hover {
    background: linear-gradient(135deg, #fff3e0, #ffe0b2);
    border-color: #f57c00;
}

.rate-btn.hard .rate-icon {
    background: linear-gradient(135deg, #ff9800, #f57c00);
    color: white;
}

.rate-btn.good {
    border-color: #2196f3;
    background: linear-gradient(135deg, #fff, #e3f2fd);
}

.rate-btn.good:hover {
    background: linear-gradient(135deg, #e3f2fd, #bbdefb);
    border-color: #1976d2;
}

.rate-btn.good .rate-icon {
    background: linear-gradient(135deg, #2196f3, #1976d2);
    color: white;
}

.rate-btn.easy {
    border-color: #4caf50;
    background: linear-gradient(135deg, #fff, #e8f5e9);
}

.rate-btn.easy:hover {
    background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
    border-color: #388e3c;
}

.rate-btn.easy .rate-icon {
    background: linear-gradient(135deg, #4caf50, #388e3c);
    color: white;
}

/* Badge contatori modalità */
.card-badge {
    animation: badgeBounce 0.5s ease-out;
}

@keyframes badgeBounce {
    0% {
        transform: scale(0);
    }

    50% {
        transform: scale(1.2);
    }

    100% {
        transform: scale(1);
    }
}

/* Transizioni smooth per modalità */
.study-option-card {
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.study-option-card::before {
    transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Indicatore carte in scadenza */
.study-option-card.due-cards .card-badge {
    animation: pulseBadge 1.5s ease-in-out infinite;
}

@keyframes pulseBadge {

    0%,
    100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(128, 36, 51, 0.7);
    }

    50% {
        transform: scale(1.05);
        box-shadow: 0 0 0 4px rgba(128, 36, 51, 0);
    }
}

/* Indicatore carte difficili */
.study-option-card.difficult-cards .card-icon {
    animation: flickerFire 2s ease-in-out infinite;
}

@keyframes flickerFire {

    0%,
    100% {
        filter: brightness(1);
    }

    25%,
    75% {
        filter: brightness(1.2);
    }

    50% {
        filter: brightness(0.9);
    }
}

/* Progress bar animata */
.progress-fill {
    transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    background: linear-gradient(90deg,
            var(--primary-color),
            var(--primary-light),
            var(--primary-color));
    background-size: 200% 100%;
    animation: progressShimmer 2s linear infinite;
}

@keyframes progressShimmer {
    0% {
        background-position: 200% 0;
    }

    100% {
        background-position: -200% 0;
    }
}

/* Statistiche footer animate */
.stat-item {
    transition: all 0.3s ease;
}

.stat-item:hover {
    transform: translateY(-2px);
    background: var(--white);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

/* Responsive improvements */
@media (max-width: 1024px) {
    .rating-buttons-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 768px) {
    .rating-buttons-grid {
        grid-template-columns: 1fr;
        gap: 12px;
    }

    .rate-btn {
        min-height: 80px;
    }

    .flashcard {
        height: 450px !important;
    }

    .question-scroll-container h3 {
        font-size: 1.8rem !important;
    }

    .answer-scroll-container p {
        font-size: 1.4rem !important;
    }
}

@media (max-width: 480px) {
    .flashcard {
        height: 400px !important;
    }

    .flashcard-front,
    .flashcard-back {
        padding: 25px;
    }

    .question-scroll-container h3 {
        font-size: 1.5rem !important;
    }

    .answer-scroll-container p {
        font-size: 1.2rem !important;
    }

    .rate-btn {
        min-height: 70px;
        padding: 15px 12px;
    }

    .rate-icon {
        width: 45px;
        height: 45px;
        font-size: 1.3rem;
    }

    .rate-title {
        font-size: 1rem;
    }

    .rate-interval {
        font-size: 0.85rem;
    }
}

/* Miglioramenti accessibilità */
.flashcard:focus,
.rate-btn:focus,
.study-option-card:focus {
    outline: 3px solid var(--primary-color);
    outline-offset: 3px;
}

/* Smooth transitions globali */
* {
    -webkit-tap-highlight-color: transparent;
}

.flashcard,
.rate-btn,
.study-option-card,
.management-btn,
.secondary-btn,
.primary-btn {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Loading state per flashcard */
.flashcard.loading {
    opacity: 0.6;
    pointer-events: none;
}

.flashcard.loading::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 40px;
    height: 40px;
    border: 4px solid rgba(255, 255, 255, 0.3);
    border-top-color: white;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    to {
        transform: translate(-50%, -50%) rotate(360deg);
    }
}

/* Miglioramenti scrollbar */
.question-scroll-container::-webkit-scrollbar,
.answer-scroll-container::-webkit-scrollbar {
    width: 10px;
}

.question-scroll-container::-webkit-scrollbar-track,
.answer-scroll-container::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 5px;
}

.question-scroll-container::-webkit-scrollbar-thumb,
.answer-scroll-container::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.4);
    border-radius: 5px;
    transition: background 0.3s;
}

.question-scroll-container::-webkit-scrollbar-thumb:hover,
.answer-scroll-container::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.6);
}

/* Effetto completamento sessione */
.session-complete .completion-icon {
    animation: trophyBounce 0.6s ease-out;
}

@keyframes trophyBounce {
    0% {
        transform: scale(0) rotate(-180deg);
        opacity: 0;
    }

    50% {
        transform: scale(1.2) rotate(10deg);
    }

    100% {
        transform: scale(1) rotate(0deg);
        opacity: 1;
    }
}

.completion-content h2 {
    animation: fadeInDown 0.5s ease-out 0.2s both;
}

.session-summary {
    animation: fadeInUp 0.5s ease-out 0.4s both;
}

.completion-actions {
    animation: fadeInUp 0.5s ease-out 0.6s both;
}

@keyframes fadeInDown {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Notifiche toast */
.notification {
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--white);
    color: var(--text-color);
    padding: 15px 20px;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    display: flex;
    align-items: center;
    gap: 12px;
    z-index: 10001;
    animation: slideInRight 0.3s ease-out;
    max-width: 400px;
}

.notification.show {
    opacity: 1;
}

.notification i {
    font-size: 1.2rem;
}

.notification.info {
    border-left: 4px solid var(--primary-color);
}

.notification.info i {
    color: var(--primary-color);
}

.notification.success {
    border-left: 4px solid var(--success-color);
}

.notification.success i {
    color: var(--success-color);
}

.notification.warning {
    border-left: 4px solid var(--warning-color);
}

.notification.warning i {
    color: var(--warning-color);
}

.notification.error {
    border-left: 4px solid var(--danger-color);
}

.notification.error i {
    color: var(--danger-color);
}

@keyframes slideInRight {
    from {
        transform: translateX(400px);
        opacity: 0;
    }

    to {
        transform: translateX(0);
        opacity: 1;
    }
}

/* Dark mode support (opzionale) */
@media (prefers-color-scheme: dark) {
    .flashcards-container {
        background: var(--white);
    }

    .study-option-card,
    .rating-section {
        background: var(--white);
        border-color: rgba(128, 36, 51, 0.12);
        box-shadow: var(--box-shadow);
    }

    .study-option-card h4,
    .rating-section h4 {
        color: var(--secondary-color);
    }

    .study-option-card p {
        color: var(--text-light);
    }
}

/* ===================== */
/* MODALE STATISTICHE PROFESSIONALE */
/* ===================== */

.stats-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(8px);
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    animation: fadeIn 0.3s ease;
}

.stats-modal-overlay.closing {
    animation: fadeOut 0.3s ease;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

@keyframes fadeOut {
    from {
        opacity: 1;
    }

    to {
        opacity: 0;
    }
}

.stats-modal-container {
    background: #ffffff;
    /* BIANCO */
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    max-width: 700px;
    width: 100%;
    max-height: 85vh;
    overflow: hidden;
    animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    flex-direction: column;
}

@keyframes slideUp {
    from {
        transform: translateY(50px);
        opacity: 0;
    }

    to {
        transform: translateY(0);
        opacity: 1;
    }
}

/* Header Modale */
.stats-modal-header {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: white;
    padding: 25px 30px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.stats-header-content {
    display: flex;
    align-items: center;
    gap: 15px;
}

.stats-header-content i {
    font-size: 1.8rem;
}

.stats-header-content h3 {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 600;
}

.close-stats-btn {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 1.2rem;
}

.close-stats-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: rotate(90deg);
}

/* Body Modale */
.stats-modal-body {
    padding: 30px;
    overflow-y: auto;
    flex: 1;
}

.stats-modal-body::-webkit-scrollbar {
    width: 8px;
}

.stats-modal-body::-webkit-scrollbar-track {
    background: var(--light-gray);
}

.stats-modal-body::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
}

/* Grid Statistiche Principali */
.stats-cards-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 20px;
    margin-bottom: 30px;
}

.stats-card {
    background: var(--white);
    border-radius: 16px;
    padding: 20px;
    display: flex;
    align-items: center;
    gap: 15px;
    border-left: 4px solid;
    transition: all 0.3s ease;
    border: 1px solid rgba(128, 36, 51, 0.12);
    box-shadow: var(--box-shadow);
}

.stats-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 18px 34px rgba(128, 36, 51, 0.16);
}

.stats-card.primary {
    border-left-color: var(--primary-color);
}

.stats-card.success {
    border-left-color: var(--success-color);
}

.stats-card.info {
    border-left-color: #2196f3;
}

.stats-card.warning {
    border-left-color: var(--warning-color);
}

.stats-card-icon {
    width: 50px;
    height: 50px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: white;
    flex-shrink: 0;
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
}

.stats-card.primary .stats-card-icon {
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
}

.stats-card.success .stats-card-icon {
    background: linear-gradient(135deg, var(--success-color), #1e8449);
}

.stats-card.info .stats-card-icon {
    background: linear-gradient(135deg, #4ea4f8, #1f6fea);
}

.stats-card.warning .stats-card-icon {
    background: linear-gradient(135deg, var(--warning-color), #d68910);
}

.stats-card-content {
    flex: 1;
}

.stats-card-value {
    font-size: 2rem;
    font-weight: 700;
    color: var(--primary-dark);
    line-height: 1;
    margin-bottom: 5px;
}

.stats-card-label {
    font-size: 0.9rem;
    color: rgba(44, 62, 80, 0.6);
    font-weight: 500;
}

/* Sezione Dettagli */
.stats-details-section {
    background: var(--white);
    border-radius: 16px;
    padding: 20px;
    border: 1px solid rgba(128, 36, 51, 0.12);
    box-shadow: var(--box-shadow);
}

.stats-details-section h4 {
    color: var(--primary-color);
    margin: 0 0 20px 0;
    font-size: 1.2rem;
    display: flex;
    align-items: center;
    gap: 10px;
}

.stats-details-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.stats-detail-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 15px;
    background: rgba(128, 36, 51, 0.05);
    border-radius: 12px;
    border: 1px solid rgba(128, 36, 51, 0.08);
    transition: all 0.3s ease;
}

.stats-detail-item:hover {
    transform: translateX(5px);
    box-shadow: 0 12px 26px rgba(128, 36, 51, 0.15);
    background: var(--white);
    border-color: transparent;
}

.stats-detail-label {
    display: flex;
    align-items: center;
    gap: 10px;
    color: var(--text-color);
    font-weight: 500;
}

.stats-detail-label i {
    color: var(--primary-color);
    width: 20px;
    text-align: center;
}

.stats-detail-value {
    font-size: 1.2rem;
    font-weight: 700;
    color: var(--primary-color);
}

/* Footer Modale */
.stats-modal-footer {
    padding: 20px 30px;
    border-top: 1px solid var(--light-gray);
    display: flex;
    gap: 15px;
    justify-content: flex-end;
}

.stats-export-btn,
.stats-close-btn {
    padding: 12px 24px;
    border-radius: 12px;
    border: none;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
}

.stats-export-btn {
    background: var(--white);
    color: var(--primary-color);
    border: 2px solid var(--primary-color);
}

.stats-export-btn:hover {
    background: var(--primary-color);
    color: white;
    transform: translateY(-2px);
}

.stats-close-btn {
    background: var(--primary-color);
    color: white;
}

.stats-close-btn:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
}

/* Responsive */
@media (max-width: 768px) {
    .stats-modal-container {
        max-width: 95%;
        max-height: 90vh;
    }

    .stats-cards-grid {
        grid-template-columns: 1fr;
        gap: 15px;
    }

    .stats-modal-header {
        padding: 20px;
    }

    .stats-modal-body {
        padding: 20px;
    }

    .stats-modal-footer {
        flex-direction: column;
        padding: 15px 20px;
    }

    .stats-export-btn,
    .stats-close-btn {
        width: 100%;
        justify-content: center;
    }
}

/* ===================== */
/* MIGLIORAMENTI BOTTONI RATING */
/* ===================== */

.rate-btn.success {
    border-color: var(--success-color);
    background: linear-gradient(135deg, #fff, #e8f5e9);
}

.rate-btn.success:hover {
    background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
    border-color: #388e3c;
}

.rate-btn.success .rate-icon {
    background: linear-gradient(135deg, var(--success-color), #388e3c);
    color: white;
}

/* Pulsante Rivedi Flashcard */
.review-again-btn {
    background: var(--white);
    color: var(--primary-color);
    border: 2px solid var(--primary-color);
    font-weight: 600;
}

.review-again-btn:hover {
    background: var(--primary-color);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(128, 36, 51, 0.3);
}

/* Miglioramenti accessibilità */
.rate-btn:focus,
.stats-export-btn:focus,
.stats-close-btn:focus,
.close-stats-btn:focus {
    outline: 3px solid var(--primary-color);
    outline-offset: 3px;
}

/* Animazione apertura modale */
.stats-modal-container {
    transform-origin: center;
}

/* Dark mode support per statistiche */
@media (prefers-color-scheme: dark) {
    .stats-modal-container {
        background: #ffffff;
        border: 1px solid rgba(128, 36, 51, 0.12);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .stats-card,
    .stats-details-section {
        background: var(--white);
        border: 1px solid rgba(128, 36, 51, 0.12);
        box-shadow: var(--box-shadow);
    }

    .stats-detail-item {
        background: rgba(128, 36, 51, 0.05);
        border: 1px solid rgba(128, 36, 51, 0.08);
    }

    .stats-card-value,
    .stats-detail-label {
        color: var(--primary-dark);
    }

    .stats-card-label {
        color: rgba(44, 62, 80, 0.6);
    }
}

/* ===================== */
/* TOOLTIP TASTI RAPIDI */
/* ===================== */

.keyboard-shortcuts-hint {
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--white);
    border-radius: 16px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
    padding: 20px;
    z-index: 9999;
    max-width: 350px;
    animation: slideInRight 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    border: 2px solid var(--primary-color);
}

.shortcuts-content h4 {
    margin: 0 0 15px 0;
    color: var(--primary-color);
    font-size: 1.1rem;
    display: flex;
    align-items: center;
    gap: 10px;
}

.shortcuts-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.shortcut-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 12px;
    background: var(--light-gray);
    border-radius: 8px;
}

.shortcut-item kbd {
    background: var(--primary-color);
    color: white;
    padding: 4px 10px;
    border-radius: 6px;
    font-family: 'Courier New', monospace;
    font-size: 0.9rem;
    font-weight: 600;
    min-width: 35px;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.shortcut-item span {
    color: var(--text-color);
    font-size: 0.9rem;
}

.close-hint-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background: var(--light-gray);
    border: none;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    color: var(--text-light);
}

.close-hint-btn:hover {
    background: var(--primary-color);
    color: white;
    transform: rotate(90deg);
}

/* Badge numerici sui bottoni */
.keyboard-badge {
    position: absolute;
    top: -8px;
    right: -8px;
    background: var(--primary-color);
    color: white;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    font-weight: 700;
    border: 2px solid white;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    animation: badgePulse 2s infinite;
}

body.dark-mode .keyboard-shortcuts-hint {
    background: var(--dark-bg-secondary);
    border: 2px solid var(--dark-border);
    box-shadow: 0 18px 36px rgba(0, 0, 0, 0.55);
}

body.dark-mode .shortcuts-content h4 {
    color: var(--dark-primary);
}

body.dark-mode .shortcut-item {
    background: var(--dark-bg-tertiary);
    border: 1px solid var(--dark-border);
}

body.dark-mode .shortcut-item kbd {
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
}

body.dark-mode .shortcut-item span {
    color: var(--dark-text-primary);
}

body.dark-mode .close-hint-btn {
    background: var(--dark-bg-tertiary);
    color: var(--dark-text-primary);
    border: 1px solid var(--dark-border);
}

body.dark-mode .close-hint-btn:hover {
    background: var(--dark-bg-input);
    color: var(--white);
}

@keyframes badgePulse {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.1);
    }
}

/* Posizione relativa per i bottoni rating */
.rate-btn {
    position: relative;
}

/* ===================== */
/* MIGLIORAMENTI DRAG GESTURE (fallback touch) */
/* ===================== */

.flashcard {
    touch-action: none;
}

/* ===================== */
/* MIGLIORAMENTI RATING SECTION */
/* ===================== */

.rating-section h4 {
    position: relative;
    padding-left: 35px;
}

.rating-section h4::before {
    content: '⏰';
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    font-size: 1.5rem;
}

/* Animazione entrata bottoni rating */
.rate-btn {
    animation: fadeInScale 0.3s ease backwards;
}

.rate-btn:nth-child(1) {
    animation-delay: 0.05s;
}

.rate-btn:nth-child(2) {
    animation-delay: 0.1s;
}

.rate-btn:nth-child(3) {
    animation-delay: 0.15s;
}

.rate-btn:nth-child(4) {
    animation-delay: 0.2s;
}

.rate-btn:nth-child(5) {
    animation-delay: 0.25s;
}

.rate-btn:nth-child(6) {
    animation-delay: 0.3s;
}

@keyframes fadeInScale {
    from {
        opacity: 0;
        transform: scale(0.8);
    }

    to {
        opacity: 1;
        transform: scale(1);
    }
}

/* Evidenziazione hover più marcata */
.rate-btn:hover {
    transform: translateY(-5px) scale(1.03);
    box-shadow: 0 12px 28px rgba(0, 0, 0, 0.15);
}

/* ===================== */
/* FEEDBACK VISIVI */
/* ===================== */

/* Loading state per transizioni */
.flashcard-main.loading {
    opacity: 0.6;
    pointer-events: none;
}

/* Success feedback dopo valutazione */
@keyframes successFlash {

    0%,
    100% {
        box-shadow: 0 0 0 0 rgba(76, 175, 80, 0);
    }

    50% {
        box-shadow: 0 0 0 20px rgba(76, 175, 80, 0.3);
    }
}

.rate-btn:active {
    animation: successFlash 0.6s ease;
}

/* ===================== */
/* RESPONSIVE IMPROVEMENTS */
/* ===================== */

@media (max-width: 768px) {
    .keyboard-shortcuts-hint {
        top: auto;
        bottom: 20px;
        right: 20px;
        left: 20px;
        max-width: none;
    }

    .shortcuts-list {
        grid-template-columns: 1fr;
    }

    .keyboard-badge {
        width: 20px;
        height: 20px;
        font-size: 0.7rem;
        top: -6px;
        right: -6px;
    }
}

@media (max-width: 480px) {
    .shortcut-item {
        padding: 6px 10px;
    }

    .shortcut-item kbd {
        padding: 3px 8px;
        font-size: 0.8rem;
        min-width: 30px;
    }

    .shortcut-item span {
        font-size: 0.85rem;
    }
}

/* ===================== */
/* ACCESSIBILITÀ */
/* ===================== */

/* Focus visibile per navigazione da tastiera */
.rate-btn:focus-visible {
    outline: 3px solid var(--primary-color);
    outline-offset: 4px;
    box-shadow: 0 0 0 6px rgba(128, 36, 51, 0.2);
}

/* Riduzione movimento per utenti con preferenze */
@media (prefers-reduced-motion: reduce) {

    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }

    .keyboard-shortcuts-hint {
        animation: none;
    }

    .rate-btn {
        animation: none;
    }
}

/* Alto contrasto per accessibilità */
@media (prefers-contrast: high) {
    .rate-btn {
        border-width: 3px;
    }

    .keyboard-badge {
        border-width: 3px;
    }

    .stats-modal-container {
        border: 3px solid var(--primary-color);
    }
}

/* ===================== */
/* MIGLIORAMENTI FOOTER RATING */
/* ===================== */

.rating-footer {
    margin-top: 20px;
    padding-top: 20px;
    border-top: 2px solid var(--light-gray);
    display: flex;
    gap: 12px;
    justify-content: center;
    flex-wrap: wrap;
}

.rating-footer .secondary-btn {
    flex: 1;
    min-width: 180px;
}

@media (max-width: 480px) {
    .rating-footer {
        flex-direction: column;
    }

    .rating-footer .secondary-btn {
        width: 100%;
        min-width: auto;
    }
}

/* ===================== */
/* STATO HOVER MIGLIORATO */
/* ===================== */

.rate-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0));
    border-radius: 16px;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.rate-btn:hover::before {
    opacity: 1;
}

/* Effetto ripple al click */
.rate-btn {
    overflow: hidden;
}

.rate-btn::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.5);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
}

.rate-btn:active::after {
    width: 300px;
    height: 300px;
}

/* ===================== */
/* ANIMAZIONE AGGIORNAMENTO BADGE */
/* ===================== */

.card-badge.badge-update {
    animation: badgeUpdate 0.5s ease;
}

@keyframes badgeUpdate {
    0% {
        transform: scale(1);
        background: var(--primary-dark);
    }

    50% {
        transform: scale(1.3);
        background: var(--success-color);
        box-shadow: 0 0 20px rgba(76, 175, 80, 0.6);
    }

    100% {
        transform: scale(1);
        background: var(--primary-dark);
    }
}

/* Pulse per badge in scadenza */
.study-option-card.due-cards .card-badge {
    animation: badgePulse 2s ease-in-out infinite;
}

@keyframes badgePulse {

    0%,
    100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(128, 36, 51, 0.7);
    }

    50% {
        transform: scale(1.05);
        box-shadow: 0 0 0 8px rgba(128, 36, 51, 0);
    }
}

/* Progress bar smooth transition */
.progress-fill {
    transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

/* =====================================================
   DARK MODE 
   ===================================================== */

/* ==================
   VARIABILI DARK MODE PROFESSIONALI
   ================== */

:root {
    /* Light mode (esistenti) */
    --primary-color: #802433;
    --primary-dark: #5c1a26;
    --primary-light: #a8324a;

    /* Dark mode - Palette Professionale (tipo Word/GitHub) */
    --dark-bg-primary: #1e1e1e;
    /* Grigio scuro principale */
    --dark-bg-secondary: #252526;
    /* Grigio cards */
    --dark-bg-tertiary: #2d2d30;
    /* Grigio elementi */
    --dark-bg-input: #3c3c3c;
    /* Input fields */

    --dark-text-primary: #d4d4d4;
    /* Testo principale */
    --dark-text-secondary: #999999;
    /* Testo secondario */
    --dark-text-muted: #6a6a6a;
    /* Testo disabilitato */

    --dark-border: #3e3e42;
    /* Bordi sottili */
    --dark-border-light: #2d2d30;
    /* Bordi più chiari */

    /* Accenti dark mode */
    --dark-primary: #c77b85;
    /* Rosso più chiaro per dark */
    --dark-primary-hover: #d48a94;
    --dark-success: #4ec9b0;
    --dark-warning: #dcdcaa;
    --dark-danger: #f48771;
}

/* ==================
   DARK MODE - BODY E GENERALI
   ================== */

body.dark-mode {
    background: var(--dark-bg-primary);
    color: var(--dark-text-primary);
}

/* ==================
   DARK MODE - CARDS E CONTENITORI
   ================== */

body.dark-mode .auth-form,
body.dark-mode .dashboard-header,
body.dark-mode .quiz-settings,
body.dark-mode .stat-card,
body.dark-mode .channel-card,
body.dark-mode .subject-card,
body.dark-mode #quiz-screen,
body.dark-mode #results-screen,
body.dark-mode .subject-dashboard,
body.dark-mode .flashcards-container,
body.dark-mode .study-option-card,
body.dark-mode .ai-chat-container {
    background: var(--dark-bg-secondary);
    color: var(--dark-text-primary);
    border-color: var(--dark-border);
}

/* ==================
   DARK MODE - SEZIONE CANALI
   ================== */

body.dark-mode .channel-section {
    background: var(--dark-bg-secondary);
    color: var(--dark-text-primary);
    border-color: var(--dark-border);
}

/* ==================
   DARK MODE - HEADER E NAVIGATION
   ================== */

body.dark-mode .quiz-header,
body.dark-mode .flashcards-header,
body.dark-mode .ai-chat-header {
    background: linear-gradient(135deg, #802433 0%, #5c1a26 100%);
    border-bottom: 1px solid var(--dark-border);
}

body.dark-mode .app-header {
    background: var(--dark-bg-secondary);
    border-bottom: 1px solid var(--dark-border);
}

/* ==================
   DARK MODE - TESTI E TITOLI
   ================== */

body.dark-mode h1,
body.dark-mode h2,
body.dark-mode h3,
body.dark-mode h4,
body.dark-mode h5 {
    color: var(--dark-text-primary);
}

body.dark-mode .auth-form h2,
body.dark-mode .quiz-settings h3,
body.dark-mode .study-header h2,
body.dark-mode #current-subject-name {
    color: var(--dark-primary);
}

body.dark-mode p,
body.dark-mode span,
body.dark-mode label {
    color: var(--dark-text-primary);
}

body.dark-mode .app-description,
body.dark-mode .stat-label,
body.dark-mode .text-light,
body.dark-mode .channel-description {
    color: var(--dark-text-secondary);
}

/* ==================
   DARK MODE - INPUT E FORM
   ================== */

body.dark-mode input[type="text"],
body.dark-mode input[type="password"],
body.dark-mode input[type="email"],
body.dark-mode textarea,
body.dark-mode select,
body.dark-mode .form-select,
body.dark-mode .ai-input {
    background: var(--dark-bg-input);
    color: var(--dark-text-primary);
    border: 1px solid var(--dark-border);
}

body.dark-mode input::placeholder,
body.dark-mode textarea::placeholder {
    color: var(--dark-text-muted);
}

body.dark-mode input:focus,
body.dark-mode textarea:focus,
body.dark-mode select:focus {
    background: var(--dark-bg-tertiary);
    border-color: var(--dark-primary);
    box-shadow: 0 0 0 2px rgba(199, 123, 133, 0.2);
}

/* ==================
   DARK MODE - BOTTONI
   ================== */

body.dark-mode .answer-btn {
    background: var(--dark-bg-tertiary);
    color: var(--dark-text-primary);
    border: 1px solid var(--dark-border);
}

body.dark-mode .answer-btn:hover:not(.selected):not(:disabled) {
    background: var(--dark-bg-input);
    border-color: var(--dark-primary);
}

body.dark-mode .logout-btn,
body.dark-mode .secondary-btn {
    background: var(--dark-bg-tertiary);
    color: var(--dark-text-primary);
    border: 1px solid var(--dark-border);
}

body.dark-mode .logout-btn:hover,
body.dark-mode .secondary-btn:hover {
    background: var(--dark-bg-input);
}

/* ==================
   DARK MODE - QUIZ
   ================== */

body.dark-mode .quiz-content {
    background: var(--dark-bg-secondary);
}

body.dark-mode #question-text {
    color: var(--dark-text-primary);
}

body.dark-mode .quiz-navigation {
    background: var(--dark-bg-secondary);
    border-top: 1px solid var(--dark-border);
}

/* ==================
   DARK MODE - RISULTATI
   ================== */

body.dark-mode .result-item {
    background: var(--dark-bg-tertiary);
    border-color: var(--dark-border);
}

body.dark-mode .result-item.wrong {
    background: rgba(244, 135, 113, 0.1);
    border-left-color: var(--dark-danger);
}

body.dark-mode .result-correct-answer {
    background: rgba(78, 201, 176, 0.1);
    border-left-color: var(--dark-success);
}

body.dark-mode .user-answer.user-wrong {
    background: rgba(244, 135, 113, 0.15);
}

body.dark-mode .user-answer.user-correct {
    background: rgba(78, 201, 176, 0.15);
}

/* ==================
   DARK MODE - AI CHAT
   ================== */

body.dark-mode .ai-chat-messages {
    background: var(--dark-bg-primary);
}

body.dark-mode .ai-message.ai .message-content {
    background: var(--dark-bg-tertiary);
    color: var(--dark-text-primary);
    border: 1px solid var(--dark-border);
}

body.dark-mode .ai-message.user .message-content {
    background: linear-gradient(135deg, #802433, #5c1a26);
    color: white;
}

body.dark-mode .ai-chat-input-area {
    background: var(--dark-bg-secondary);
    border-top: 1px solid var(--dark-border);
}

body.dark-mode .welcome-ai-message {
    color: var(--dark-text-primary);
}

body.dark-mode .welcome-ai-message i {
    color: var(--dark-primary);
}

body.dark-mode .welcome-ai-message p {
    color: var(--dark-text-secondary);
}

/* ==================
   DARK MODE - FLASHCARDS
   ================== */

body.dark-mode .study-options {
    background: transparent;
}

body.dark-mode .study-option-card {
    background: var(--dark-bg-secondary);
    border: 1px solid var(--dark-border);
    box-shadow: 0 16px 36px rgba(0, 0, 0, 0.45);
}

body.dark-mode .study-option-card::before {
    background: linear-gradient(180deg, var(--dark-primary), var(--primary-dark));
}

body.dark-mode .study-option-card:hover {
    border-color: var(--dark-primary);
    background: var(--dark-bg-tertiary);
    box-shadow: 0 22px 48px rgba(0, 0, 0, 0.55);
}

body.dark-mode .study-option-card .card-icon {
    background: linear-gradient(135deg, var(--dark-primary), var(--primary-dark));
    box-shadow: 0 12px 26px rgba(0, 0, 0, 0.5);
}

body.dark-mode .study-option-card .card-content p {
    color: var(--dark-text-secondary);
}

body.dark-mode .study-option-card .card-progress .progress-bar {
    background: rgba(199, 123, 133, 0.35);
}

body.dark-mode .study-option-card .card-progress span {
    color: var(--dark-primary);
}

body.dark-mode .study-option-card .stat {
    color: var(--dark-text-secondary);
}

body.dark-mode .study-option-card .card-arrow {
    color: var(--dark-primary);
}

body.dark-mode .study-option-card:hover .card-arrow {
    color: var(--white);
}

body.dark-mode .flashcard-main {
    background: var(--dark-bg-primary);
    color: var(--dark-text-primary);
}

body.dark-mode .flashcards-container {
    background: var(--dark-bg-secondary);
    border: 1px solid var(--dark-border);
    box-shadow: 0 16px 36px rgba(0, 0, 0, 0.45);
    color: var(--dark-text-primary);
}

body.dark-mode .flashcards-screen {
    background: linear-gradient(135deg, #1a1a1c 0%, #0f0f11 100%);
}

body.dark-mode .flashcards-screen .flashcards-header {
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    box-shadow: 0 4px 25px rgba(0, 0, 0, 0.45);
}

body.dark-mode .flashcard-content {
    background: var(--dark-bg-secondary);
    color: var(--dark-text-primary);
}

body.dark-mode .study-options-container,
body.dark-mode .study-options {
    background: transparent;
}

body.dark-mode .stat-badge {
    background: rgba(199, 123, 133, 0.18);
    color: var(--dark-text-primary);
}

body.dark-mode .stat-badge i {
    color: var(--dark-primary);
}

body.dark-mode .management-btn {
    background: rgba(199, 123, 133, 0.14);
    color: var(--dark-text-primary);
    border: 1px solid rgba(199, 123, 133, 0.35);
}

body.dark-mode .management-btn:hover {
    background: rgba(199, 123, 133, 0.28);
}

body.dark-mode .session-stats .stat {
    color: var(--dark-text-primary);
}

body.dark-mode .study-settings-panel {
    background: var(--dark-bg-secondary);
    border: 1px solid var(--dark-border);
    box-shadow: 0 22px 45px rgba(0, 0, 0, 0.45);
}

body.dark-mode .study-settings-icon {
    background: rgba(199, 123, 133, 0.18);
    color: var(--dark-primary);
}

body.dark-mode .study-settings-content label {
    color: var(--dark-text-primary);
}

body.dark-mode .flashcard-limit-select {
    background: var(--dark-bg-tertiary);
    color: var(--dark-text-primary);
    border: 1px solid var(--dark-border);
}

body.dark-mode .flashcard-limit-select option {
    background: var(--dark-bg-secondary);
    color: var(--dark-text-primary);
}

body.dark-mode .study-settings-hint {
    color: var(--dark-text-secondary);
}

body.dark-mode .reset-deck-btn {
    background: linear-gradient(135deg, rgba(199, 123, 133, 0.9), var(--primary-dark));
    color: var(--white);
    box-shadow: 0 12px 26px rgba(0, 0, 0, 0.45);
}

body.dark-mode .reset-deck-btn:hover {
    box-shadow: 0 18px 34px rgba(0, 0, 0, 0.6);
}


body.dark-mode .study-footer {
    border-top: 1px solid var(--dark-border);
}

body.dark-mode .deck-stats {
    gap: 20px;
}

body.dark-mode .stat-item {
    background: var(--dark-bg-tertiary);
    color: var(--dark-text-primary);
    border: 1px solid var(--dark-border);
    box-shadow: 0 12px 28px rgba(0, 0, 0, 0.35);
}

body.dark-mode .stat-item i {
    color: var(--dark-primary);
}

body.dark-mode .session-progress {
    background: var(--dark-bg-tertiary);
    border: 1px solid var(--dark-border);
}

body.dark-mode .progress-info {
    color: var(--dark-text-primary);
}

body.dark-mode .session-progress .progress-bar {
    background: var(--dark-border);
}

body.dark-mode .session-progress .progress-fill {
    background: linear-gradient(135deg, var(--dark-primary), var(--primary-dark));
}

body.dark-mode .session-header {
    background: var(--dark-bg-secondary);
    border-bottom: 1px solid var(--dark-border);
    box-shadow: 0 12px 28px rgba(0, 0, 0, 0.35);
    color: var(--dark-text-primary);
}

body.dark-mode .session-info {
    color: var(--dark-text-secondary);
}

body.dark-mode .session-stats .stat i {
    color: var(--dark-primary);
}

body.dark-mode .flashcard {
    box-shadow: 0 18px 36px rgba(0, 0, 0, 0.45);
}

body.dark-mode .flashcard-front,
body.dark-mode .flashcard-back {
    background: linear-gradient(135deg, rgba(199, 123, 133, 0.85), rgba(92, 26, 38, 0.85));
    color: var(--dark-text-primary);
    border: 1px solid rgba(199, 123, 133, 0.35);
}

body.dark-mode .flashcard-front h4,
body.dark-mode .flashcard-back p {
    color: var(--dark-text-primary);
}

body.dark-mode .flashcard-btn {
    background: var(--dark-bg-input);
    color: var(--dark-text-primary);
    border: 1px solid var(--dark-border);
}

body.dark-mode .flashcard-btn:hover {
    background: linear-gradient(135deg, var(--dark-primary), var(--primary-dark));
    color: var(--white);
    border-color: transparent;
}

body.dark-mode .flashcard-progress {
    background: var(--dark-bg-tertiary);
    color: var(--dark-primary);
}

/* ==================
   DARK MODE - STATISTICHE
   ================== */

body.dark-mode .stats-overlay {
    background: rgba(0, 0, 0, 0.85);
}

body.dark-mode .stats-panel {
    background: var(--dark-bg-secondary);
    border: 1px solid var(--dark-border);
}

body.dark-mode .stats-modal-container {
    background: var(--dark-bg-secondary);
    border: 1px solid var(--dark-border);
    box-shadow: 0 28px 60px rgba(0, 0, 0, 0.55);
}

body.dark-mode .stats-modal-body {
    background: var(--dark-bg-secondary);
}

body.dark-mode .stats-modal-body::-webkit-scrollbar-track {
    background: var(--dark-bg-primary);
}

body.dark-mode .stats-modal-body::-webkit-scrollbar-thumb {
    background: var(--dark-primary);
}

body.dark-mode .stats-modal-footer {
    background: var(--dark-bg-secondary);
    border-top: 1px solid var(--dark-border);
}

body.dark-mode .stats-card {
    background: var(--dark-bg-tertiary);
    border: 1px solid var(--dark-border);
    box-shadow: 0 16px 36px rgba(0, 0, 0, 0.45);
}

body.dark-mode .stats-card:hover {
    border-color: var(--dark-primary);
    box-shadow: 0 22px 48px rgba(0, 0, 0, 0.6);
}

body.dark-mode .stats-card-icon {
    background: linear-gradient(135deg, var(--dark-primary), var(--primary-dark));
}

body.dark-mode .stats-card.success .stats-card-icon {
    background: linear-gradient(135deg, var(--dark-success), #2b8a72);
}

body.dark-mode .stats-card.info .stats-card-icon {
    background: linear-gradient(135deg, #4ea4f8, #2979ff);
}

body.dark-mode .stats-card.warning .stats-card-icon {
    background: linear-gradient(135deg, var(--dark-warning), #d4a933);
}

body.dark-mode .stats-card-value {
    color: var(--dark-primary);
}

body.dark-mode .stats-card-label {
    color: var(--dark-text-secondary);
}

body.dark-mode .stats-details-section {
    background: var(--dark-bg-tertiary);
    border: 1px solid var(--dark-border);
    box-shadow: 0 16px 36px rgba(0, 0, 0, 0.45);
}

body.dark-mode .stats-detail-item {
    background: rgba(199, 123, 133, 0.15);
    border: 1px solid rgba(199, 123, 133, 0.35);
}

body.dark-mode .stats-detail-item:hover {
    background: rgba(199, 123, 133, 0.25);
    border-color: rgba(199, 123, 133, 0.5);
    box-shadow: 0 18px 36px rgba(0, 0, 0, 0.5);
}

body.dark-mode .stats-detail-label {
    color: var(--dark-text-primary);
}

body.dark-mode .stats-detail-label i {
    color: var(--dark-primary);
}

body.dark-mode .stats-detail-value {
    color: var(--dark-primary);
}

body.dark-mode .stats-export-btn {
    background: transparent;
    color: var(--dark-primary);
    border: 2px solid var(--dark-primary);
}

body.dark-mode .stats-export-btn:hover {
    background: var(--dark-primary);
    color: var(--dark-bg-primary);
}

body.dark-mode .stats-close-btn {
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    color: var(--white);
}

body.dark-mode .stats-close-btn:hover {
    background: linear-gradient(135deg, var(--primary-dark), #361017);
}

body.dark-mode .rating-section {
    background: var(--dark-bg-secondary);
    border: 1px solid var(--dark-border);
    box-shadow: 0 18px 38px rgba(0, 0, 0, 0.45);
}

body.dark-mode .rating-section h4 {
    color: var(--dark-primary);
}

body.dark-mode .rate-btn {
    background: var(--dark-bg-tertiary);
    border: 1px solid var(--dark-border);
    color: var(--dark-text-primary);
}

body.dark-mode .rate-btn:hover {
    background: var(--dark-bg-input);
    border-color: var(--dark-primary);
}

body.dark-mode .rate-btn .rate-title,
body.dark-mode .rate-btn .rate-subtitle {
    color: var(--dark-text-primary);
}

body.dark-mode .rate-btn.difficult,
body.dark-mode .rate-btn.hard,
body.dark-mode .rate-btn.good,
body.dark-mode .rate-btn.easy {
    background: var(--dark-bg-tertiary);
}

body.dark-mode .rate-btn.difficult .rate-icon {
    background: linear-gradient(135deg, rgba(231, 76, 60, 0.9), rgba(198, 40, 40, 0.9));
}

body.dark-mode .rate-btn.hard .rate-icon {
    background: linear-gradient(135deg, rgba(255, 152, 0, 0.9), rgba(245, 124, 0, 0.9));
}

body.dark-mode .rate-btn.good .rate-icon {
    background: linear-gradient(135deg, rgba(33, 150, 243, 0.9), rgba(25, 118, 210, 0.9));
}

body.dark-mode .rate-btn.easy .rate-icon {
    background: linear-gradient(135deg, rgba(76, 175, 80, 0.9), rgba(56, 142, 60, 0.9));
}

body.dark-mode .review-again-btn {
    background: transparent;
    color: var(--dark-primary);
    border: 2px solid var(--dark-primary);
}

body.dark-mode .review-again-btn:hover {
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    color: var(--white);
    border-color: transparent;
    box-shadow: 0 10px 24px rgba(0, 0, 0, 0.45);
}

/* ==================
   DARK MODE - SCROLLBAR PERSONALIZZATA
   ================== */

body.dark-mode ::-webkit-scrollbar {
    width: 12px;
    height: 12px;
}

body.dark-mode ::-webkit-scrollbar-track {
    background: var(--dark-bg-primary);
}

body.dark-mode ::-webkit-scrollbar-thumb {
    background: var(--dark-bg-input);
    border-radius: 6px;
    border: 2px solid var(--dark-bg-primary);
}

body.dark-mode ::-webkit-scrollbar-thumb:hover {
    background: #4a4a4a;
}

/* ==================
   DARK MODE - MENU SIDEBAR
   ================== */

body.dark-mode .menu-content {
    background: var(--dark-bg-secondary);
    border-right: 1px solid var(--dark-border);
}

body.dark-mode .menu-item {
    color: var(--dark-text-primary);
}

body.dark-mode .menu-item:hover {
    background: var(--dark-bg-tertiary);
    color: var(--dark-primary);
}

body.dark-mode .menu-footer p {
    color: var(--dark-text-muted);
}

/* ==================
   DARK MODE - SHADOW E EFFETTI
   ================== */

body.dark-mode .stat-card,
body.dark-mode .channel-card,
body.dark-mode .subject-card {
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
}

body.dark-mode .ai-chat-container {
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
}

/* ==================
   DARK MODE - BOTTONE TOGGLE
   ================== */

.dark-mode-toggle {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 20px;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    font-weight: 500;
    font-size: 0.95rem;
    transition: all 0.3s ease;
    margin-right: 15px;
}

.dark-mode-toggle:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(128, 36, 51, 0.3);
}

.dark-mode-toggle i {
    font-size: 1.1rem;
}

body.dark-mode .dark-mode-toggle {
    background: var(--dark-primary);
}

body.dark-mode .dark-mode-toggle:hover {
    background: var(--dark-primary-hover);
}

/* ==================
   DARK MODE - FLOATING AI BUTTON
   ================== */

body.dark-mode .floating-ai-button {
    background: linear-gradient(135deg, var(--dark-primary), #802433);
    box-shadow: 0 8px 25px rgba(199, 123, 133, 0.4);
}

body.dark-mode .floating-ai-button:hover {
    box-shadow: 0 12px 35px rgba(199, 123, 133, 0.5);
}

/* ==================
   DARK MODE - SPIEGAZIONE BUTTON
   ================== */

.explanation-btn {
    background: linear-gradient(135deg, #f39c12, #e67e22);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 12px;
    font-weight: 600;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 10px;
    margin-top: 15px;
    transition: all 0.3s ease;
    font-size: 0.95rem;
    box-shadow: 0 4px 12px rgba(243, 156, 18, 0.3);
}

body.dark-mode .explanation-btn {
    background: linear-gradient(135deg, var(--dark-warning), #d4a933);
}

.explanation-btn:hover {
    background: linear-gradient(135deg, #e67e22, #d35400);
    transform: translateY(-2px);
    box-shadow: 0 6px 18px rgba(243, 156, 18, 0.4);
}

.explanation-btn i {
    font-size: 1.1rem;
}

/* ==================
   DARK MODE - ACCESSIBILITÀ
   ================== */

body.dark-mode a {
    color: var(--dark-primary);
}

body.dark-mode a:hover {
    color: var(--dark-primary-hover);
}

body.dark-mode ::selection {
    background: rgba(199, 123, 133, 0.3);
    color: white;
}

/* ==================
   DARK MODE - TRANSITIONS
   ================== */

body,
.dashboard-header,
.quiz-settings,
.stat-card,
.channel-card,
.subject-card,
.answer-btn,
input,
textarea,
select {
    transition: background-color 0.3s ease,
        color 0.3s ease,
        border-color 0.3s ease;
}

/* ==================
   RESPONSIVE DARK MODE
   ================== */

@media (max-width: 768px) {
    body.dark-mode .dark-mode-toggle {
        padding: 8px 15px;
        font-size: 0.85rem;
        margin-right: 0;
        margin-bottom: 10px;
    }

    body.dark-mode .dark-mode-toggle span {
        display: none;
    }
}

/* ==================
   DARK MODE - MIGLIORAMENTI CONTRASTO
   ================== */

body.dark-mode .subject-badge,
body.dark-mode .channel-badge,
body.dark-mode .card-badge {
    background: var(--dark-primary);
    color: white;
    border: 1px solid var(--dark-border);
}

body.dark-mode .stat-value {
    color: var(--dark-primary);
}

body.dark-mode .progress-fill {
    background: linear-gradient(90deg, var(--dark-primary), var(--dark-primary-hover));
}

/* ==================
   DARK MODE - NOTIFICHE
   ================== */

body.dark-mode .notification {
    background: var(--dark-bg-tertiary);
    color: var(--dark-text-primary);
    border: 1px solid var(--dark-border);
}

body.dark-mode .notification.success {
    background: rgba(78, 201, 176, 0.2);
    border-color: var(--dark-success);
    color: var(--dark-success);
}

body.dark-mode .notification.error {
    background: rgba(244, 135, 113, 0.2);
    border-color: var(--dark-danger);
    color: var(--dark-danger);
}

/* ==================
   DARK MODE - TOOLTIPS
   ================== */

body.dark-mode .tooltip-text {
    background-color: var(--dark-bg-input);
    color: var(--dark-text-primary);
    border: 1px solid var(--dark-border);
}

body.dark-mode .tooltip-text::after {
    border-color: var(--dark-bg-input) transparent transparent transparent;
}

/* ==================
   DARK MODE - FOOTER
   ================== */

body.dark-mode .site-footer {
    background: var(--dark-bg-secondary);
    color: var(--dark-text-secondary);
    border-top: 1px solid var(--dark-border);
}

/* ==================
   DARK MODE - NO QUIZ MESSAGE
   ================== */

body.dark-mode #no-quiz-message {
    background: var(--dark-bg-tertiary);
    border-color: var(--dark-border);
}

body.dark-mode #no-quiz-message h3 {
    color: var(--dark-primary);
}

/* ==================
   DARK MODE - ICONS COLORS
   ================== */

body.dark-mode .fa-moon,
body.dark-mode .fa-sun,
body.dark-mode .channel-icon,
body.dark-mode .subject-icon {
    color: inherit;
}

/* ==================
   FINE DARK MODE PROFESSIONALE
   ================== */

/* ==================
   4. FLOATING AI BUTTON
   ================== */

.floating-ai-button {
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 65px;
    height: 65px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
    color: white;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 8px 25px rgba(128, 36, 51, 0.4);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 999;
    font-size: 1.8rem;
    animation: floatPulse 3s ease-in-out infinite;
}

.floating-ai-button:hover {
    transform: scale(1.15) rotate(10deg);
    box-shadow: 0 12px 35px rgba(128, 36, 51, 0.5);
}

@keyframes floatPulse {

    0%,
    100% {
        transform: translateY(0);
        box-shadow: 0 8px 25px rgba(128, 36, 51, 0.4);
    }

    50% {
        transform: translateY(-10px);
        box-shadow: 0 15px 35px rgba(128, 36, 51, 0.5);
    }
}

/* ==================
   5. AI CHAT OVERLAY
   ================== */

.ai-chat-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(8px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

.ai-chat-container {
    width: 90%;
    max-width: 750px;
    height: 85vh;
    max-height: 700px;
    background: white;
    border-radius: 24px;
    box-shadow: 0 25px 60px rgba(0, 0, 0, 0.4);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

body.dark-mode .ai-chat-container {
    background: var(--card-bg-dark);
    border: 1px solid var(--border-dark);
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(50px) scale(0.95);
    }

    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* ==================
   6. AI CHAT HEADER
   ================== */

.ai-chat-header {
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    color: white;
    padding: 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.chat-title {
    display: flex;
    align-items: center;
    gap: 15px;
}

.chat-title i {
    font-size: 1.8rem;
}

.chat-title h3 {
    margin: 0;
    font-size: 1.3rem;
    font-weight: 600;
}

.chat-status {
    display: block;
    font-size: 0.85rem;
    opacity: 0.85;
    margin-top: 3px;
}

.close-chat-btn {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    width: 42px;
    height: 42px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: white;
    font-size: 1.2rem;
    transition: all 0.3s ease;
}

.close-chat-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.1) rotate(90deg);
}

/* ==================
   7. AI CHAT MESSAGES
   ================== */

.ai-chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 25px;
    background: #f8f9fa;
    scroll-behavior: smooth;
}

body.dark-mode .ai-chat-messages {
    background: var(--bg-dark-secondary);
}

/* Custom scrollbar */
.ai-chat-messages::-webkit-scrollbar {
    width: 8px;
}

.ai-chat-messages::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.05);
    border-radius: 4px;
}

body.dark-mode .ai-chat-messages::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
}

.ai-chat-messages::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
}

.ai-chat-messages::-webkit-scrollbar-thumb:hover {
    background: var(--primary-dark);
}

/* ==================
   8. WELCOME MESSAGE
   ================== */

.welcome-ai-message {
    text-align: center;
    padding: 60px 20px 40px;
    animation: fadeIn 0.5s ease;
}

.welcome-ai-message i {
    font-size: 4rem;
    color: var(--primary-color);
    margin-bottom: 20px;
    display: block;
}

.welcome-ai-message h4 {
    font-size: 1.6rem;
    color: var(--primary-color);
    margin-bottom: 12px;
}

body.dark-mode .welcome-ai-message h4 {
    color: var(--primary-light);
}

.welcome-ai-message p {
    font-size: 1.05rem;
    color: #666;
    line-height: 1.6;
    margin-bottom: 30px;
}

body.dark-mode .welcome-ai-message p {
    color: var(--text-dark-secondary);
}

.quick-actions {
    display: flex;
    flex-direction: column;
    gap: 12px;
    max-width: 400px;
    margin: 0 auto;
}

.quick-actions button {
    padding: 15px 20px;
    background: white;
    border: 2px solid var(--primary-color);
    border-radius: 12px;
    color: var(--primary-color);
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 10px;
    justify-content: center;
}

body.dark-mode .quick-actions button {
    background: rgba(255, 255, 255, 0.05);
    border-color: var(--primary-light);
    color: var(--primary-light);
}

.quick-actions button:hover {
    background: var(--primary-color);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(128, 36, 51, 0.3);
}

body.dark-mode .quick-actions button:hover {
    background: var(--primary-light);
}

/* ==================
   9. AI MESSAGES
   ================== */

.ai-message {
    display: flex;
    gap: 12px;
    margin-bottom: 20px;
    animation: messageSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes messageSlideIn {
    from {
        opacity: 0;
        transform: translateY(15px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.ai-message.user {
    flex-direction: row-reverse;
}

.message-avatar {
    width: 42px;
    height: 42px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    flex-shrink: 0;
    background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
    box-shadow: 0 3px 10px rgba(128, 36, 51, 0.2);
}

.message-content {
    flex: 1;
    max-width: 75%;
}

.ai-message.user .message-content {
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    color: white;
    padding: 14px 18px;
    border-radius: 18px 18px 4px 18px;
    box-shadow: 0 3px 12px rgba(128, 36, 51, 0.2);
}

.ai-message.ai .message-content {
    background: white;
    color: #333;
    padding: 14px 18px;
    border-radius: 18px 18px 18px 4px;
    box-shadow: 0 3px 12px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.05);
}

body.dark-mode .ai-message.ai .message-content {
    background: rgba(255, 255, 255, 0.08);
    color: var(--text-dark);
    border-color: var(--border-dark);
}

.message-text {
    line-height: 1.6;
    word-wrap: break-word;
}

.message-text strong {
    font-weight: 600;
    color: var(--primary-color);
}

body.dark-mode .message-text strong {
    color: var(--primary-light);
}

.ai-message.user .message-text strong {
    color: white;
}

.message-time {
    font-size: 0.75rem;
    opacity: 0.6;
    margin-top: 6px;
}

/* ==================
   10. TYPING INDICATOR
   ================== */

.ai-message.typing .message-content {
    background: white;
    padding: 18px 24px;
    border-radius: 18px 18px 18px 4px;
    box-shadow: 0 3px 12px rgba(0, 0, 0, 0.08);
}

body.dark-mode .ai-message.typing .message-content {
    background: rgba(255, 255, 255, 0.08);
}

.typing-dots {
    display: flex;
    gap: 6px;
    align-items: center;
}

.typing-dots span {
    width: 10px;
    height: 10px;
    background: var(--primary-color);
    border-radius: 50%;
    animation: typingBounce 1.4s infinite ease-in-out;
}

.typing-dots span:nth-child(1) {
    animation-delay: 0s;
}

.typing-dots span:nth-child(2) {
    animation-delay: 0.2s;
}

.typing-dots span:nth-child(3) {
    animation-delay: 0.4s;
}

@keyframes typingBounce {

    0%,
    60%,
    100% {
        opacity: 0.3;
        transform: scale(0.8);
    }

    30% {
        opacity: 1;
        transform: scale(1.1);
    }
}

/* ==================
   11. AI CHAT INPUT
   ================== */

.ai-chat-input-area {
    padding: 20px 25px;
    background: white;
    border-top: 1px solid rgba(0, 0, 0, 0.08);
    display: flex;
    gap: 12px;
    align-items: center;
}

body.dark-mode .ai-chat-input-area {
    background: var(--card-bg-dark);
    border-top-color: var(--border-dark);
}

.ai-input {
    flex: 1;
    padding: 14px 20px;
    border: 2px solid #e0e0e0;
    border-radius: 25px;
    font-size: 1rem;
    font-family: 'Poppins', sans-serif;
    transition: all 0.3s ease;
    background: #f8f9fa;
}

body.dark-mode .ai-input {
    background: rgba(255, 255, 255, 0.05);
    border-color: var(--border-dark);
    color: var(--text-dark);
}

.ai-input:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(128, 36, 51, 0.1);
    background: white;
}

body.dark-mode .ai-input:focus {
    background: rgba(255, 255, 255, 0.08);
}

.ai-input::placeholder {
    color: #999;
}

body.dark-mode .ai-input::placeholder {
    color: var(--text-dark-secondary);
}

.ai-send-btn {
    width: 52px;
    height: 52px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    color: white;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.1rem;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 4px 12px rgba(128, 36, 51, 0.3);
}

.ai-send-btn:hover:not(:disabled) {
    background: linear-gradient(135deg, var(--primary-dark), var(--primary-color));
    transform: scale(1.1) rotate(15deg);
    box-shadow: 0 6px 18px rgba(128, 36, 51, 0.4);
}

.ai-send-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
}

/* ==================
   12. EXPLANATION BUTTON
   ================== */

.explanation-btn {
    background: linear-gradient(135deg, #f39c12, #e67e22);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 12px;
    font-weight: 600;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 10px;
    margin-top: 15px;
    transition: all 0.3s ease;
    font-size: 0.95rem;
    box-shadow: 0 4px 12px rgba(243, 156, 18, 0.3);
}

.explanation-btn:hover {
    background: linear-gradient(135deg, #e67e22, #d35400);
    transform: translateY(-2px);
    box-shadow: 0 6px 18px rgba(243, 156, 18, 0.4);
}

.explanation-btn i {
    font-size: 1.1rem;
}

/* ==================
   13. RESPONSIVE DESIGN
   ================== */

@media (max-width: 768px) {
    .floating-ai-button {
        width: 55px;
        height: 55px;
        bottom: 20px;
        right: 20px;
        font-size: 1.5rem;
    }

    .ai-chat-container {
        width: 95%;
        height: 90vh;
        max-height: none;
        border-radius: 20px;
    }

    .ai-chat-header {
        padding: 18px 20px;
    }

    .chat-title h3 {
        font-size: 1.1rem;
    }

    .chat-title i {
        font-size: 1.5rem;
    }

    .ai-chat-messages {
        padding: 15px;
    }

    .message-content {
        max-width: 85%;
    }

    .welcome-ai-message {
        padding: 40px 15px 30px;
    }

    .welcome-ai-message i {
        font-size: 3rem;
    }

    .welcome-ai-message h4 {
        font-size: 1.3rem;
    }

    .quick-actions {
        max-width: 100%;
    }

    .ai-chat-input-area {
        padding: 15px;
    }

    .ai-input {
        padding: 12px 16px;
        font-size: 0.95rem;
    }

    .ai-send-btn {
        width: 48px;
        height: 48px;
        font-size: 1rem;
    }

    .dark-mode-toggle {
        padding: 8px 15px;
        font-size: 0.85rem;
        margin-right: 0;
        margin-bottom: 10px;
    }

    .dark-mode-toggle span {
        display: none;
    }

    .explanation-btn {
        width: 100%;
        justify-content: center;
        font-size: 0.9rem;
    }
}

@media (max-width: 480px) {
    .ai-chat-container {
        width: 100%;
        height: 100vh;
        border-radius: 0;
    }

    .ai-chat-header {
        padding: 15px;
    }

    .chat-title h3 {
        font-size: 1rem;
    }

    .close-chat-btn {
        width: 38px;
        height: 38px;
    }

    .ai-chat-messages {
        padding: 12px;
    }

    .message-avatar {
        width: 38px;
        height: 38px;
        font-size: 1.3rem;
    }

    .ai-message.user .message-content,
    .ai-message.ai .message-content {
        padding: 12px 14px;
        font-size: 0.95rem;
    }

    .welcome-ai-message {
        padding: 30px 10px 20px;
    }

    .welcome-ai-message i {
        font-size: 2.5rem;
    }

    .welcome-ai-message h4 {
        font-size: 1.2rem;
    }

    .quick-actions button {
        padding: 12px 15px;
        font-size: 0.9rem;
    }
}

/* ==================
   14. ANIMATIONS & EFFECTS
   ================== */

@keyframes shimmer {
    0% {
        background-position: -1000px 0;
    }

    100% {
        background-position: 1000px 0;
    }
}

.loading-shimmer {
    background: linear-gradient(90deg,
            rgba(255, 255, 255, 0) 0%,
            rgba(255, 255, 255, 0.3) 50%,
            rgba(255, 255, 255, 0) 100%);
    background-size: 1000px 100%;
    animation: shimmer 2s infinite;
}

/* Smooth transitions for all interactive elements */
button,
input,
select,
.answer-btn,
.rate-btn {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* ==================
   15. ACCESSIBILITY
   ================== */

.ai-chat-container:focus-within {
    outline: 3px solid var(--primary-color);
    outline-offset: 2px;
}

.ai-input:focus,
.ai-send-btn:focus,
.close-chat-btn:focus,
.dark-mode-toggle:focus,
.floating-ai-button:focus {
    outline: 2px solid var(--primary-color);
    outline-offset: 2px;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
    body.dark-mode {
        background: #000;
    }

    body.dark-mode .ai-chat-container {
        border: 2px solid #fff;
    }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
}

/* Print styles */
@media print {

    .floating-ai-button,
    .dark-mode-toggle,
    .ai-chat-overlay {
        display: none !important;
    }
}


/* Stile per " carte per sessione " */
.session-settings-card {
    background: var(--white);
    border-radius: var(--border-radius);
    padding: 18px;
    margin-bottom: 20px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    border: 1px solid var(--medium-gray);
    transition: all 0.2s ease;
}

.session-settings-card:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
}

.session-settings-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
}

.session-settings-header i {
    color: var(--primary-color);
    font-size: 1.2rem;
    width: 36px;
    height: 36px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(128, 36, 51, 0.08);
}

.session-settings-header h4 {
    margin: 0;
    color: var(--secondary-color);
    font-size: 1.1rem;
    font-weight: 600;
}

.session-controls-row {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 16px;
    align-items: end;
}

.session-select-container {
    min-width: 180px;
}

.session-select-container label {
    display: block;
    margin-bottom: 6px;
    font-weight: 500;
    color: var(--text-color);
    font-size: 0.9rem;
}

.session-limit-select {
    width: 100%;
    padding: 10px 12px;
    border: 1px solid var(--medium-gray);
    border-radius: 6px;
    background: var(--white);
    font-size: 0.9rem;
    transition: var(--transition);
    appearance: none;
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right 10px center;
    background-size: 14px;
}

.session-limit-select:focus {
    border-color: var(--primary-color);
    outline: none;
    box-shadow: 0 0 0 2px rgba(128, 36, 51, 0.1);
}

.session-summary-badge {
    background: var(--light-gray);
    border: 1px solid var(--medium-gray);
    border-radius: 6px;
    padding: 10px 12px;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.9rem;
}

.session-summary-badge i {
    color: var(--primary-color);
    font-size: 1rem;
}

.session-summary-badge span {
    color: var(--text-color);
    font-weight: 500;
}

.session-hint {
    font-size: 0.8rem;
    color: var(--text-light);
    line-height: 1.4;
    margin-top: 12px;
    padding: 8px 12px;
    background: rgba(128, 36, 51, 0.03);
    border-radius: 4px;
    border-left: 2px solid var(--primary-color);
}

/* Dark mode support */
body.dark-mode .session-settings-card {
    background: var(--dark-bg-secondary);
    border-color: var(--dark-border);
}

body.dark-mode .session-settings-header i {
    background: rgba(199, 123, 133, 0.1);
}

body.dark-mode .session-settings-header h4 {
    color: var(--dark-text-primary);
}

body.dark-mode .session-select-container label {
    color: var(--dark-text-primary);
}

body.dark-mode .session-limit-select {
    background: var(--dark-bg-input);
    border-color: var(--dark-border);
    color: var(--dark-text-primary);
}

body.dark-mode .session-limit-select:focus {
    border-color: var(--dark-primary);
    box-shadow: 0 0 0 2px rgba(199, 123, 133, 0.15);
}

body.dark-mode .session-summary-badge {
    background: var(--dark-bg-tertiary);
    border-color: var(--dark-border);
}

body.dark-mode .session-summary-badge span {
    color: var(--dark-text-primary);
}

body.dark-mode .session-hint {
    color: var(--dark-text-secondary);
    background: rgba(199, 123, 133, 0.05);
    border-left-color: var(--dark-primary);
}

/* Responsive design */
@media (max-width: 768px) {
    .session-controls-row {
        grid-template-columns: 1fr;
        gap: 12px;
    }
    
    .session-select-container {
        min-width: auto;
    }
    
    .session-settings-card {
        padding: 16px;
    }
}

@media (max-width: 480px) {
    .session-settings-header {
        gap: 10px;
    }
    
    .session-settings-header i {
        width: 32px;
        height: 32px;
        font-size: 1.1rem;
    }
    
    .session-settings-header h4 {
        font-size: 1rem;
    }
}



/* ===================== */
/* PULSANTE GESTIONE FLASHCARD */
/* ===================== */

.management-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border: none;
    border-radius: 50%;
    background: var(--light-gray);
    color: var(--primary-color);
    cursor: pointer;
    transition: var(--transition);
    box-shadow: var(--box-shadow);
    font-size: 1.1rem;
}

.management-btn:hover {
    background: var(--primary-color);
    color: white;
    transform: translateY(-2px);
}

/* ===================== */
/* MODAL GESTIONE FLASHCARD */
/* ===================== */

.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    padding: 1rem;
}

.modal-container {
    background: var(--white);
    border-radius: var(--border-radius);
    width: 100%;
    max-width: 500px;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    animation: modalSlideIn 0.3s ease;
}

@keyframes modalSlideIn {
    from {
        opacity: 0;
        transform: translateY(-50px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.large-modal {
    max-width: 700px;
}

.modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1.5rem;
    border-bottom: 1px solid var(--medium-gray);
}

.modal-header h3 {
    margin: 0;
    color: var(--primary-color);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1.3rem;
}

.close-modal-btn {
    background: transparent;
    border: none;
    font-size: 1.25rem;
    color: var(--gray-color);
    cursor: pointer;
    transition: var(--transition);
}

.close-modal-btn:hover {
    color: var(--danger-color);
}

.modal-body {
    padding: 1.5rem;
}

.modal-footer {
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
    padding: 1.5rem;
    border-top: 1px solid var(--medium-gray);
}

/* ===================== */
/* FORM AGGIUNTA/MODIFICA FLASHCARD */
/* ===================== */

.form-group {
    margin-bottom: 1.5rem;
}

.form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 500;
    color: var(--secondary-color);
}

.form-textarea {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid var(--medium-gray);
    border-radius: var(--border-radius);
    font-family: inherit;
    resize: vertical;
    min-height: 100px;
    transition: var(--transition);
    font-size: 1rem;
}

.form-textarea:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(128, 36, 51, 0.2);
}

/* ===================== */
/* LISTA FLASHCARD UTENTE */
/* ===================== */

.user-flashcards-section,
.default-flashcards-section {
    margin-bottom: 2rem;
}

.section-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
}

.section-header h4 {
    margin: 0;
    color: var(--primary-color);
    font-size: 1.1rem;
}

.small-btn {
    background: var(--primary-color);
    color: var(--white);
    border: none;
    padding: 0.5rem 1rem;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 0.85rem;
    font-weight: 500;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.small-btn:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
}

.user-flashcards-list {
    max-height: 400px;
    overflow-y: auto;
}

.user-flashcard-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1rem;
    background: var(--light-gray);
    border-radius: var(--border-radius);
    margin-bottom: 0.75rem;
    transition: var(--transition);
    border: 1px solid var(--medium-gray);
}

.user-flashcard-item:hover {
    background: #e9ecef;
    transform: translateY(-2px);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.flashcard-preview {
    flex: 1;
}

.preview-front,
.preview-back {
    font-size: 0.9rem;
    margin-bottom: 0.25rem;
    line-height: 1.4;
}

.preview-front strong,
.preview-back strong {
    color: var(--primary-color);
}

.flashcard-actions {
    display: flex;
    gap: 0.5rem;
}

.icon-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    transition: var(--transition);
    font-size: 0.9rem;
}

.edit-btn {
    background: rgba(128, 36, 51, 0.1);
    color: var(--primary-color);
}

.edit-btn:hover {
    background: var(--primary-color);
    color: white;
}

.delete-btn {
    background: rgba(210, 4, 4, 0.1);
    color: rgba(210, 4, 4, 0.91);
}

.delete-btn:hover {
    background: rgba(210, 4, 4, 0.91);
    color: white;
}

/* ===================== */
/* STATO VUOTO */
/* ===================== */

.empty-state {
    text-align: center;
    padding: 2rem;
    color: var(--text-light);
}

.empty-state i {
    font-size: 3rem;
    margin-bottom: 1rem;
    opacity: 0.5;
    color: var(--primary-color);
}

.empty-state p {
    margin-bottom: 1.5rem;
}

/* ===================== */
/* SEZIONE FLASHCARD PREDEFINITE */
/* ===================== */

.default-cards-count {
    color: var(--text-light);
    font-size: 0.9rem;
}

.info-box {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    padding: 1rem;
    background: #e7f3ff;
    border-radius: var(--border-radius);
    color: var(--dark-color);
    border-left: 4px solid var(--info-color);
}

.info-box i {
    color: var(--info-color);
    flex-shrink: 0;
    margin-top: 0.2rem;
}

.info-box p {
    margin: 0;
    font-size: 0.9rem;
}

/* ===================== */
/* BOTTONI PRIMARI E SECONDARI */
/* ===================== */

.primary-btn {
    background: var(--primary-color);
    color: var(--white);
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.primary-btn:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
}

.secondary-btn {
    background: transparent;
    color: var(--primary-color);
    border: 2px solid var(--primary-color);
    padding: 0.75rem 1.5rem;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.secondary-btn:hover {
    background: var(--primary-color);
    color: white;
}

/* ===================== */
/* RESPONSIVE */
/* ===================== */

@media (max-width: 768px) {
    .modal-container {
        margin: 1rem;
        max-height: calc(100vh - 2rem);
    }
    
    .section-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
    }
    
    .section-header h4 {
        margin-bottom: 0.5rem;
    }
    
    .user-flashcard-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
    }
    
    .flashcard-actions {
        align-self: flex-end;
    }
    
    .modal-footer {
        flex-direction: column;
    }
    
    .modal-footer button {
        width: 100%;
    }
}







/* ===================== */
/* QUIZ 3D MODERNO - INTERFACCIA MIGLIORATA */
/* ===================== */

/* Container principale con prospettiva 3D */
.quiz-content-3d {
    perspective: 1500px;
    transform-style: preserve-3d;
    min-height: 550px;
    position: relative;
    background: transparent;
    border-radius: 20px;
    overflow: visible;
    padding: 20px;
}

/* Card domanda con effetto 3D pulito */
.quiz-question-3d {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    transform-style: preserve-3d;
    transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
    border-radius: 20px;
    background: linear-gradient(145deg, #ffffff 0%, #fafafa 100%);
    padding: 35px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(128, 36, 51, 0.1);
}

/* Stati animazione domande - Effetto carta che si volta */
.quiz-question-3d.current {
    transform: rotateY(0deg) translateZ(0) scale(1);
    opacity: 1;
    z-index: 3;
    animation: cardFlipIn 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.quiz-question-3d.next {
    transform: rotateY(90deg) translateZ(100px) scale(0.95);
    opacity: 0;
    z-index: 1;
}

.quiz-question-3d.leaving {
    transform: rotateY(-90deg) translateZ(-100px) scale(0.9);
    opacity: 0;
    animation: cardFlipOut 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes cardFlipIn {
    0% {
        transform: rotateY(90deg) translateZ(100px) scale(0.95);
        opacity: 0;
    }
    100% {
        transform: rotateY(0deg) translateZ(0) scale(1);
        opacity: 1;
    }
}

@keyframes cardFlipOut {
    0% {
        transform: rotateY(0deg) translateZ(0) scale(1);
        opacity: 1;
    }
    100% {
        transform: rotateY(-90deg) translateZ(-100px) scale(0.9);
        opacity: 0;
    }
}

/* Testo domanda stilizzato */
.quiz-question-3d .question-text {
    font-size: 1.4rem;
    font-weight: 600;
    color: var(--secondary-color);
    line-height: 1.6;
    margin-bottom: 25px;
    text-align: center;
    transform: translateZ(30px);
    padding: 20px 25px;
    border-radius: 15px;
    background: linear-gradient(135deg, 
                rgba(128, 36, 51, 0.03) 0%, 
                rgba(128, 36, 51, 0.06) 100%);
    border-left: 4px solid var(--primary-color);
}

/* Container immagine */
.quiz-question-3d .image-container {
    transform: translateZ(25px);
    margin: 20px 0;
    text-align: center;
    border-radius: 15px;
    overflow: hidden;
    transition: transform 0.3s ease;
}

.quiz-question-3d .image-container:hover {
    transform: translateZ(35px) scale(1.02);
}

.quiz-question-3d .question-image {
    max-width: 100%;
    max-height: 300px;
    border-radius: 12px;
    transition: all 0.5s ease;
}

/* PULSANTI RISPOSTA CON EFFETTI 3D PULITI */
.quiz-question-3d .answer-buttons {
    display: flex;
    flex-direction: column;
    gap: 15px;
    margin-top: 25px;
    transform: translateZ(20px);
}

.answer-btn {
    background: linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%);
    color: var(--text-color);
    border: 2px solid #e9ecef;
    padding: 20px 25px;
    border-radius: 15px;
    cursor: pointer;
    font-size: 1.05rem;
    font-weight: 500;
    text-align: left;
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    display: flex;
    align-items: center;
    position: relative;
    overflow: hidden;
    transform: translateZ(0);
    min-height: 70px;
}

.answer-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
                transparent, 
                rgba(128, 36, 51, 0.05), 
                transparent);
    transition: left 0.6s ease;
}

.answer-btn:hover {
    border-color: var(--primary-color);
    background: linear-gradient(145deg, #ffffff 0%, #fcfcfc 100%);
    transform: translateY(-4px) translateZ(15px);
    box-shadow: 0 12px 25px rgba(128, 36, 51, 0.12);
}

.answer-btn:hover::before {
    left: 100%;
}

.answer-btn .answer-text {
    flex: 1;
    font-weight: 500;
    line-height: 1.5;
    z-index: 2;
    position: relative;
}

.answer-btn .answer-image {
    max-width: 100%;
    max-height: 120px;
    border-radius: 8px;
    margin: 5px 0;
}

/* Stati risposta */
.answer-btn.correct {
    border-color: #27ae60;
    background: linear-gradient(145deg, #e8f8f0 0%, #d4f0e0 100%);
    transform: translateZ(20px) scale(1.02);
    box-shadow: 0 8px 20px rgba(39, 174, 96, 0.2);
    animation: correctPulse 0.6s ease;
}

.answer-btn.incorrect {
    border-color: #e74c3c;
    background: linear-gradient(145deg, #ffecec 0%, #ffd4d4 100%);
    transform: translateZ(20px) scale(1.02);
    box-shadow: 0 8px 20px rgba(231, 76, 60, 0.2);
    animation: incorrectShake 0.5s ease;
}

@keyframes correctPulse {
    0%, 100% {
        transform: translateZ(20px) scale(1.02);
    }
    50% {
        transform: translateZ(25px) scale(1.05);
    }
}

@keyframes incorrectShake {
    0%, 100% {
        transform: translateX(0) translateZ(20px) scale(1.02);
    }
    25% {
        transform: translateX(-6px) translateZ(20px) scale(1.02);
    }
    75% {
        transform: translateX(6px) translateZ(20px) scale(1.02);
    }
}

/* BARRA PROGRESSO ROSSA */
.quiz-progress {
    flex: 1;
    max-width: 65%;
    background: transparent;
    border-radius: 0;
    padding: 0;
    transform: translateZ(15px);
}

.progress-bar {
    width: 100%;
    height: 8px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 10px;
    margin-bottom: 12px;
    overflow: hidden;
    position: relative;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, 
                #802433 0%, 
                #a8324a 50%,
                #802433 100%);
    border-radius: 10px;
    width: 0%;
    transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
    position: relative;
    background-size: 200% 100%;
    animation: progressFlow 2s linear infinite;
}

@keyframes progressFlow {
    0% {
        background-position: 0% 0;
    }
    100% {
        background-position: 200% 0;
    }
}

.progress-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.4), 
                transparent);
    animation: progressShine 2s infinite;
    border-radius: 10px;
}

@keyframes progressShine {
    0% {
        transform: translateX(-100%);
    }
    100% {
        transform: translateX(100%);
    }
}

#progress-text {
    font-size: 0.95rem;
    font-weight: 700;
    color: white;
    text-align: center;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    letter-spacing: 0.5px;
}

/* TIMER E PUNTEGGIO */
.quiz-timer,
.quiz-score {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 1.2rem;
    font-weight: 700;
    color: white;
    background: transparent;
    padding: 0;
    transform: translateZ(20px);
    transition: all 0.3s ease;
    text-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
}

.quiz-timer i {
    font-size: 1.3rem;
    color: white;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
}

.quiz-score i {
    font-size: 1.3rem;
    color: #FFD700;
    filter: drop-shadow(0 2px 6px rgba(255, 215, 0, 0.5));
    animation: starGlow 2s ease-in-out infinite;
}

@keyframes starGlow {
    0%, 100% {
        filter: drop-shadow(0 2px 6px rgba(255, 215, 0, 0.5));
        transform: scale(1);
    }
    50% {
        filter: drop-shadow(0 2px 10px rgba(255, 215, 0, 0.8));
        transform: scale(1.08);
    }
}

#current-score,
#time-remaining {
    font-weight: 700;
    font-size: 1.1rem;
    color: white;
    text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}

/* Animazione aggiornamento punteggio */
.quiz-score.score-update {
    animation: scoreUpdateBounce 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes scoreUpdateBounce {
    0%, 100% {
        transform: translateZ(20px) scale(1);
    }
    50% {
        transform: translateZ(20px) scale(1.15);
    }
}

/* PULSANTE AVANTI - ROSSO E VISIBILE SOLO DOPO LA RISPOSTA */
#next-btn {
    background: linear-gradient(135deg, #802433 0%, #a8324a 100%);
    color: white;
    border: none;
    padding: 16px 35px;
    border-radius: 12px;
    cursor: pointer;
    font-size: 1.1rem;
    font-weight: 700;
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    display: flex;
    align-items: center;
    gap: 10px;
    transform: translateZ(25px);
    box-shadow: 0 8px 20px rgba(128, 36, 51, 0.3);
    position: relative;
    overflow: hidden;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    opacity: 0;
    visibility: hidden;
    transform: translateZ(0) scale(0.8);
}

/* Pulsante visibile dopo la risposta */
#next-btn:not(:disabled) {
    opacity: 1;
    visibility: visible;
    transform: translateZ(25px) scale(1);
    animation: buttonAppear 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes buttonAppear {
    0% {
        opacity: 0;
        transform: translateZ(0) scale(0.8) translateY(20px);
    }
    100% {
        opacity: 1;
        transform: translateZ(25px) scale(1) translateY(0);
    }
}

#next-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.3), 
                transparent);
    transition: left 0.6s ease;
}

#next-btn:not(:disabled):hover {
    transform: translateZ(35px) translateY(-3px) scale(1.05);
    box-shadow: 0 15px 35px rgba(128, 36, 51, 0.4);
    background: linear-gradient(135deg, #a8324a 0%, #802433 100%);
}

#next-btn:not(:disabled):hover::before {
    left: 100%;
}

#next-btn:not(:disabled):active {
    transform: translateZ(30px) translateY(-1px) scale(1.02);
}

#next-btn:disabled {
    opacity: 0;
    visibility: hidden;
    transform: translateZ(0) scale(0.8);
    cursor: not-allowed;
}

/* PULSANTE INDIETRO 3D - STILE DINAMICO */
.quiz-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 30px;
    gap: 20px;
    padding: 0 10px;
}

/* Pulsante freccia indietro con forma circolare 3D */
#back-to-dashboard-btn2,
#back-btn,
.back-arrow-btn,
button.back-arrow-btn {
    min-width: 60px;
    height: 60px;
    padding: 0;
    border-radius: 50%;
    background: linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%);
    backdrop-filter: blur(10px);
    border: 3px solid rgba(128, 36, 51, 0.2);
    color: var(--primary-color);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0;
    cursor: pointer;
    font-size: 1.6rem;
    font-weight: 600;
    transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    transform: translateZ(25px);
    box-shadow: 0 8px 25px rgba(128, 36, 51, 0.2),
                inset 0 1px 3px rgba(255, 255, 255, 0.8);
    position: relative;
    overflow: visible;
    flex-shrink: 0;
    transform-style: preserve-3d;
}

/* Effetto glow dietro il pulsante */
#back-to-dashboard-btn2::before,
#back-btn::before,
.back-arrow-btn::before,
button.back-arrow-btn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 120%;
    height: 120%;
    background: radial-gradient(circle, rgba(128, 36, 51, 0.3) 0%, transparent 70%);
    transform: translate(-50%, -50%) scale(0.8);
    opacity: 0;
    transition: all 0.5s ease;
    border-radius: 50%;
    z-index: -1;
}

/* Effetto 3D rialzato */
#back-to-dashboard-btn2::after,
#back-btn::after,
.back-arrow-btn::after,
button.back-arrow-btn::after {
    content: '';
    position: absolute;
    top: 3px;
    left: 3px;
    right: 3px;
    bottom: 3px;
    background: radial-gradient(circle at 30% 30%, 
                rgba(255, 255, 255, 0.8) 0%, 
                transparent 60%);
    border-radius: 50%;
    pointer-events: none;
    z-index: 1;
}

/* Hover state con espansione 3D */
#back-to-dashboard-btn2:hover,
#back-btn:hover,
.back-arrow-btn:hover,
button.back-arrow-btn:hover {
    transform: translateZ(40px) scale(1.1);
    box-shadow: 0 15px 40px rgba(128, 36, 51, 0.35),
                inset 0 2px 5px rgba(255, 255, 255, 0.9);
    border-color: var(--primary-color);
    background: linear-gradient(145deg, #ffffff 0%, #fefefe 100%);
}

#back-to-dashboard-btn2:hover::before,
#back-btn:hover::before,
.back-arrow-btn:hover::before,
button.back-arrow-btn:hover::before {
    transform: translate(-50%, -50%) scale(1.4);
    opacity: 1;
}

/* Click state con effetto pressione 3D */
#back-to-dashboard-btn2:active,
#back-btn:active,
.back-arrow-btn:active,
button.back-arrow-btn:active {
    transform: translateZ(20px) scale(1.05);
    box-shadow: 0 5px 15px rgba(128, 36, 51, 0.25),
                inset 0 3px 8px rgba(0, 0, 0, 0.1);
}

/* Icona freccia con animazione fluida e z-index */
#back-to-dashboard-btn2 i,
#back-btn i,
.back-arrow-btn i,
button.back-arrow-btn i {
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    display: inline-block;
    position: relative;
    z-index: 2;
}

#back-to-dashboard-btn2:hover i,
#back-btn:hover i,
.back-arrow-btn:hover i,
button.back-arrow-btn:hover i {
    animation: arrowPulse3D 0.8s ease-in-out infinite;
}

@keyframes arrowPulse3D {
    0%, 100% {
        transform: translateX(0) translateZ(5px) scale(1);
    }
    50% {
        transform: translateX(-5px) translateZ(8px) scale(1.1);
    }
}

/* Animazione entrata iniziale con rotazione 3D */
#back-to-dashboard-btn2,
#back-btn,
.back-arrow-btn,
button.back-arrow-btn {
    animation: backButton3DAppear 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) backwards;
}

@keyframes backButton3DAppear {
    0% {
        opacity: 0;
        transform: translateZ(0) rotateY(-180deg) scale(0.5);
    }
    60% {
        transform: translateZ(30px) rotateY(20deg) scale(1.1);
    }
    100% {
        opacity: 1;
        transform: translateZ(25px) rotateY(0deg) scale(1);
    }
}

/* HEADER DEL QUIZ */
.quiz-header {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: var(--white);
    padding: 20px 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-radius: 0 0 20px 20px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
    position: relative;
    z-index: 10;
}

/* RESPONSIVE DESIGN */
@media (max-width: 768px) {
    .quiz-content-3d {
        perspective: 1200px;
        min-height: 480px;
        padding: 15px;
    }
    
    .quiz-question-3d {
        padding: 25px;
    }
    
    .quiz-progress {
        max-width: 100%;
        margin-bottom: 15px;
    }
    
    .quiz-header {
        flex-direction: column;
        gap: 15px;
        padding: 15px 20px;
    }
    
    .quiz-timer,
    .quiz-score {
        font-size: 1.1rem;
        gap: 8px;
    }
    
    .answer-btn {
        padding: 18px 20px;
        font-size: 1rem;
        min-height: 65px;
    }
    
    #next-btn,
    #whyBtn {
        padding: 14px 28px;
        font-size: 1rem;
    }
    
    #back-to-dashboard-btn2,
    #back-btn,
    .back-arrow-btn,
    button.back-arrow-btn {
        min-width: 55px;
        height: 55px;
        font-size: 1.4rem;
    }
}

@media (max-width: 480px) {
    .quiz-content-3d {
        perspective: 1000px;
        min-height: 450px;
        padding: 10px;
    }
    
    .quiz-question-3d {
        padding: 20px;
    }
    
    .quiz-question-3d .question-text {
        font-size: 1.2rem;
        padding: 15px 18px;
    }
    
    .quiz-timer,
    .quiz-score {
        font-size: 1rem;
        gap: 8px;
    }
    
    .answer-btn {
        padding: 16px 18px;
        font-size: 0.95rem;
        min-height: 60px;
    }
    
    #next-btn,
    #whyBtn {
        padding: 12px 22px;
        font-size: 0.95rem;
    }
    
    .progress-bar {
        height: 6px;
    }
    
    #back-to-dashboard-btn2,
    #back-btn,
    .back-arrow-btn,
    button.back-arrow-btn {
        min-width: 50px;
        height: 50px;
        font-size: 1.3rem;
    }
}

/* Animazioni ingresso pulsanti risposta */
.answer-btn {
    animation: fadeInUp 0.4s ease backwards;
}

.answer-btn:nth-child(1) { animation-delay: 0.1s; }
.answer-btn:nth-child(2) { animation-delay: 0.2s; }
.answer-btn:nth-child(3) { animation-delay: 0.3s; }
.answer-btn:nth-child(4) { animation-delay: 0.4s; }

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px) translateZ(0);
    }
    to {
        opacity: 1;
        transform: translateY(0) translateZ(20px);
    }
}













/* ===================== */
/* REVISIONE COMPLETATA — MODALITÀ "IN SCADENZA" (due, user_due) */
/* Solo stile per il blocco #due-mode-rating e i suoi controlli  */
/* ===================== */

.rating-section {
  perspective: 1200px; /* abilita profondità 3D ai figli */
}

#due-mode-rating {
  /* viene mostrato/nascosto via JS: non toccare display */
  position: relative;
  margin: 18px auto 6px auto;
  max-width: 820px;
  padding: 24px 22px;
  border-radius: 18px;

  /* glass + 3D card coerente con palette */
  background:
    radial-gradient(120% 220% at 20% -10%, rgba(255,255,255,0.65) 0%, rgba(255,255,255,0.15) 40%, rgba(255,255,255,0) 70%),
    linear-gradient(135deg, rgba(128,36,51,0.08), rgba(128,36,51,0.02));
  border: 1px solid rgba(128,36,51,0.18);
  box-shadow:
    0 22px 38px rgba(0,0,0,0.12),
    0 2px 0 rgba(255,255,255,0.6) inset,
    0 -1px 18px rgba(128,36,51,0.12) inset;
  transform-style: preserve-3d;
  text-align: center;
}

#due-mode-rating::before {
  /* bordo luminoso dinamico */
  content: "";
  position: absolute;
  inset: -2px;
  border-radius: inherit;
  background: conic-gradient(
    from 140deg,
    rgba(128,36,51,0.15),
    rgba(255,255,255,0) 35%,
    rgba(128,36,51,0.18),
    rgba(255,255,255,0) 70%,
    rgba(128,36,51,0.15)
  );
  filter: blur(10px);
  opacity: .7;
  pointer-events: none;
  transform: translateZ(-1px);
  animation: reviewGlow 6s linear infinite;
}

#due-mode-rating::after {
  /* riflesso superiore per effetto 3D */
  content: "";
  position: absolute;
  left: 8%;
  right: 8%;
  top: 0;
  height: 56px;
  border-radius: 18px 18px 0 0;
  background: linear-gradient(to bottom, rgba(255,255,255,0.6), rgba(255,255,255,0));
  pointer-events: none;
  transform: translateZ(8px);
}

@keyframes reviewGlow {
  0%   { opacity: .45; }
  50%  { opacity: .9; }
  100% { opacity: .45; }
}

/* titolo + testo d'aiuto, senza impattare altri flussi */
#rating-section #rating-hint-text {
  margin-top: 8px;
  color: var(--text-light);
  font-weight: 500;
}

/* Contenitore CTA "Avanti" in modalità scadenza */
#due-mode-rating .review-actions {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  transform: translateZ(12px);
}

/* Pulsante Avanti: 3D, coerente con .primary-btn/.nav-btn */
#due-mode-rating .nav-btn,
#due-mode-rating .primary-btn,
#due-mode-rating button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  min-width: 280px;
  padding: 14px 24px;
  border-radius: 14px;
  border: 0;
  font-weight: 700;
  background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
  color: var(--white);
  box-shadow:
    0 14px 30px rgba(128,36,51,0.35),
    0 6px 0 rgba(92,26,38,0.9);
  transform: translateZ(18px);
  transition: transform .15s ease, box-shadow .2s ease, filter .2s ease;
}

#due-mode-rating .nav-btn:hover,
#due-mode-rating .primary-btn:hover,
#due-mode-rating button:hover {
  transform: translateY(-2px) translateZ(18px);
  box-shadow:
    0 18px 38px rgba(128,36,51,0.45),
    0 8px 0 rgba(92,26,38,0.9);
  filter: brightness(1.03);
}

#due-mode-rating .nav-btn:active,
#due-mode-rating .primary-btn:active,
#due-mode-rating button:active {
  transform: translateY(0) translateZ(18px);
  box-shadow:
    0 10px 20px rgba(128,36,51,0.35),
    0 3px 0 rgba(92,26,38,0.9);
}

#due-mode-rating .nav-btn:focus-visible,
#due-mode-rating .primary-btn:focus-visible,
#due-mode-rating button:focus-visible {
  outline: 3px solid rgba(128,36,51,0.35);
  outline-offset: 3px;
}

/* Iconcina celebrativa opzionale con pseudo-elemento */
#due-mode-rating .review-badge {
  width: 42px;
  height: 42px;
  border-radius: 12px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
  color: var(--white);
  box-shadow: 0 6px 16px rgba(128,36,51,0.25);
  transform: translateZ(16px);
}

/* micro-movimento del contenitore per dinamismo */
@media (hover:hover) {
  #due-mode-rating {
    animation: reviewFloat 7s ease-in-out infinite;
  }
  @keyframes reviewFloat {
    0%,100% { transform: translateZ(0) rotateX(0.6deg); }
    50%     { transform: translateZ(0) rotateX(0deg); }
  }
}

/* Responsive */
@media (max-width: 768px) {
  #due-mode-rating {
    padding: 18px 16px;
    border-radius: 16px;
    margin-top: 12px;
  }
  #due-mode-rating .nav-btn,
  #due-mode-rating .primary-btn,
  #due-mode-rating button {
    min-width: 240px;
    padding: 12px 18px;
    border-radius: 12px;
  }
}
/* FIX: rimuove l'orologio (pseudo-elemento ::before) nella revisione completa */
#due-mode-rating .rating-title::before,
#due-mode-rating .rate-title::before,
#due-mode-rating .rating-hint::before,
#due-mode-rating h4::before,
#due-mode-rating [class*="title"]::before {
  content: none !important;
  display: none !important;
}





/* ===================== */
/* MODAL GUIDA MODERNO 3D (solo #modes-help-modal) */
/* ===================== */
#modes-help-modal {
  position: fixed;
  inset: 0;
  z-index: 10000;
  background: linear-gradient(135deg, var(--primary-dark) 0%, rgba(0,0,0,.88) 100%);
  backdrop-filter: blur(8px);
  animation: modesFadeIn .18s ease-out;
}

@keyframes modesFadeIn { from { opacity: 0 } to { opacity: 1 } }

#modes-help-modal .modal-container {
  position: relative;
  margin: 6vh auto;
  width: min(92%, 860px);
  border-radius: 22px;
  background: var(--white);
  border: 1px solid var(--primary-color);
  box-shadow:
    0 32px 70px rgba(0,0,0,.28),
    0 0 0 6px rgba(92,26,38,.08),
    0 -1px 18px rgba(128,36,51,.12) inset;
  transform-style: preserve-3d;
}

#modes-help-modal .modal-container::before{
  content:""; position:absolute; inset:-2px; border-radius:inherit;
  background: conic-gradient(from 140deg, rgba(128,36,51,.18), rgba(255,255,255,0) 35%, rgba(128,36,51,.2), rgba(255,255,255,0) 70%, rgba(128,36,51,.18));
  filter: blur(12px); opacity:.45; pointer-events:none; animation: reviewGlow 6s linear infinite;
}

#modes-help-modal .modal-header {
  display:flex; align-items:center; justify-content:space-between; gap:14px;
  padding: 18px 22px 16px 22px;
  border-bottom: 1px solid rgba(128,36,51,.15);
  background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
  color: var(--white);
  border-radius: 22px 22px 0 0;
}

#modes-help-modal .modal-header h3{
  margin:0; display:flex; align-items:center; gap:10px; font-size:1.2rem; color: var(--white);
}

#modes-help-modal .close-modal-btn{
  background: transparent; border:0; width:42px; height:42px; border-radius:12px;
  display:inline-flex; align-items:center; justify-content:center; cursor:pointer;
  color: var(--white);
  transition: transform .15s ease, background .2s ease;
}
#modes-help-modal .close-modal-btn:hover{ background: rgba(255,255,255,.12); transform: translateY(-1px); }
#modes-help-modal .close-modal-btn:focus-visible{ outline:3px solid rgba(255,255,255,.5); outline-offset:3px; }

#modes-help-modal .modal-body{ padding: 18px 22px; display:grid; gap:18px; color: var(--primary-dark); }
#modes-help-modal .help-section h4{ margin:0 0 8px; color:var(--primary-color); font-size:1.05rem; }
#modes-help-modal .help-list{ margin:0; padding-left:18px; display:grid; gap:8px; color:var(--primary-dark); }
#modes-help-modal .help-list.compact{ gap:6px; }
#modes-help-modal .small-note{ color:var(--primary-color); font-size:.9rem; margin-top:6px; }
#modes-help-modal .grid-two-cols{ display:grid; grid-template-columns: 1fr 1fr; gap:14px; }
#modes-help-modal kbd{ background:#fff; border:1px solid rgba(128,36,51,.25); border-bottom-width:3px; padding:2px 6px; border-radius:6px; font-weight:700; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }

#modes-help-modal .modal-footer{ padding: 8px 22px 20px; display:flex; justify-content:center; }
#modes-help-modal .modal-footer .primary-btn{
  background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
  box-shadow: 0 14px 30px rgba(128,36,51,.35), 0 6px 0 rgba(92,26,38,.9);
  border-radius:14px; padding:13px 22px; transform: translateZ(14px);
}
#modes-help-modal .modal-footer .primary-btn:hover{ transform: translateY(-2px) translateZ(14px); box-shadow: 0 18px 38px rgba(128,36,51,.45), 0 8px 0 rgba(92,26,38,.9); }

@media (max-width: 768px){
  #modes-help-modal .modal-container{ margin: 4vh auto; width: 94%; }
  #modes-help-modal .grid-two-cols{ grid-template-columns: 1fr; }
}

/* ===================== */
/* GUDA BTN in header opzioni studio (scoped) */
/* ===================== */
.study-header .study-header-actions{ display:flex; justify-content:center; margin: 8px 0 0; }
.study-header .study-header-actions .management-btn{
  width:auto; height:auto; border-radius:12px; padding:10px 14px; gap:8px;
  background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
  color: var(--white); border: 0; box-shadow: 0 10px 20px rgba(128,36,51,.25);
  transform: translateZ(10px);
}
.study-header .study-header-actions .management-btn:hover{ transform: translateY(-2px) translateZ(10px); box-shadow: 0 12px 26px rgba(128,36,51,.35); }
.study-header .study-header-actions .management-btn:focus-visible{ outline:3px solid rgba(128,36,51,.35); outline-offset:3px; }

/* ===================== */
/* Rifiniture pulsante Avanti in modalità in scadenza */
/* ===================== */
#due-mode-rating #due-next-button{
  font-size: 1.05rem; letter-spacing:.2px;
}



/* =========================================================
   DARK MODE — FLASHCARDS ("LE TUE FLASHCARD" + CREAZIONE + FINE SESSIONE)
   ========================================================= */

/* Contenitore e header */
body.dark-mode .flashcards-screen{background:linear-gradient(135deg,#0f1012 0%,#17181b 100%);} 
body.dark-mode .flashcards-container{background:#0f1012;}
body.dark-mode .flashcards-screen .flashcards-header{background:linear-gradient(135deg,#1d1f24,#141518);color:#f2f2f2;box-shadow:0 2px 24px rgba(0,0,0,.6);} 
body.dark-mode .flashcards-screen .header-title h3{color:#fafafa;}
body.dark-mode .flashcards-screen .stat-badge{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.12);color:#fff;}
body.dark-mode .flashcards-screen .management-btn{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.14);color:#fff;}
body.dark-mode .flashcards-screen .management-btn:hover{background:rgba(255,255,255,.12);} 

/* "Le tue flashcard" e lista modalità */
body.dark-mode .study-options-container{background:transparent;}
body.dark-mode .study-settings-panel{background:radial-gradient(100% 180% at 10% 0%,rgba(36,37,41,.95),rgba(18,19,22,.95));border:1px solid rgba(255,255,255,.06);box-shadow:0 22px 55px rgba(0,0,0,.5);} 
body.dark-mode .study-settings-summary{background:rgba(255,255,255,.06);color:#e7e7e7;}
body.dark-mode .study-settings-summary i{color:var(--primary-light);} 

body.dark-mode .study-option-card{background:linear-gradient(180deg,#1a1c20,#121316);border-color:rgba(255,255,255,.08);box-shadow:0 16px 40px rgba(0,0,0,.45);} 
body.dark-mode .study-option-card::before{background:linear-gradient(180deg,rgba(128,36,51,.65),rgba(128,36,51,.25));}
body.dark-mode .card-icon{background:linear-gradient(135deg, var(--primary-color), var(--primary-dark)); box-shadow:0 10px 22px rgba(128,36,51,.35);} 
body.dark-mode .card-badge{background:var(--primary-dark);} 
body.dark-mode .card-content h4{color:#f3f3f3;} 
body.dark-mode .card-progress .progress-bar{background:rgba(255,255,255,.12);} 
body.dark-mode .card-progress span{color:#e0e0e0;} 

/* FLASHCARD singola */
body.dark-mode .flashcard-front{background:linear-gradient(135deg,#5c1a26,#3a1018);} 
body.dark-mode .flashcard-back{background:linear-gradient(135deg,#7a2232,#5c1a26);} 
body.dark-mode .flashcard-front h3, 
body.dark-mode .flashcard-back p{color:#fff;} 

/* Sezione valutazione */
body.dark-mode .rating-section{background:#15161a;box-shadow:0 12px 30px rgba(0,0,0,.55);} 
body.dark-mode .rate-btn{background:#101114;border-color:#2a2c31;color:#f1f1f1;} 
body.dark-mode .rate-btn:hover{box-shadow:0 10px 24px rgba(0,0,0,.6);} 
body.dark-mode .rate-info .rate-title{color:#ececec;} 
body.dark-mode .rate-interval{color:#b7b7b7;} 

/* Navigazione */
body.dark-mode .nav-btn{background:linear-gradient(135deg,var(--primary-color),var(--primary-dark));}
body.dark-mode .nav-btn:hover{box-shadow:0 8px 22px rgba(128,36,51,.45);} 

/* ===================== CREAZIONE FLASHCARD (tendina/modale) ===================== */
/* Copre le modali usate nel sistema flashcard, senza dipendere da ID specifici */
body.dark-mode .flashcards-screen .modal-overlay{background:rgba(0,0,0,.7);backdrop-filter:blur(6px);} 
body.dark-mode .flashcards-screen .modal-container{background:radial-gradient(120% 180% at 20% -10%, rgba(36,37,41,.95), rgba(18,19,22,.92));border:1px solid rgba(255,255,255,.08);box-shadow:0 28px 60px rgba(0,0,0,.6);color:#ececec;} 
body.dark-mode .flashcards-screen .modal-header{border-bottom:1px solid rgba(255,255,255,.08);background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,0));} 
body.dark-mode .flashcards-screen .modal-header h3{color:#fafafa;} 
body.dark-mode .flashcards-screen .modal-body{color:#e0e0e0;} 
body.dark-mode .flashcards-screen .modal-footer{border-top:1px solid rgba(255,255,255,.06);} 

/* Campi form nella creazione */
body.dark-mode .flashcards-screen input[type="text"],
body.dark-mode .flashcards-screen textarea,
body.dark-mode .flashcards-screen select{background:#0f1012;border:1px solid #2c2f36;color:#f0f0f0;border-radius:12px;}
body.dark-mode .flashcards-screen input[type="text"]::placeholder,
body.dark-mode .flashcards-screen textarea::placeholder{color:#8a8f99;} 
body.dark-mode .flashcards-screen .primary-btn{background:linear-gradient(135deg,var(--primary-color),var(--primary-dark));color:#fff;box-shadow:0 12px 28px rgba(128,36,51,.35);} 
body.dark-mode .flashcards-screen .secondary-btn{background:transparent;color:#fff;border-color:rgba(255,255,255,.25);} 

/* ===================== FINE SESSIONE ===================== */
body.dark-mode .session-complete{background:transparent;} 
body.dark-mode .completion-content h2{color:#f7f7f7;} 
body.dark-mode .completion-content p{color:#c9c9c9;} 
body.dark-mode .session-summary{background:#15161a;border:1px solid rgba(255,255,255,.06);box-shadow:0 14px 34px rgba(0,0,0,.6);} 
body.dark-mode .summary-item i{background:#1b1d22;color:var(--primary-light);} 
body.dark-mode .summary-value{color:#ffdacf;} 
body.dark-mode .summary-label{color:#b8b8b8;} 
body.dark-mode .completion-actions .primary-btn{background:linear-gradient(135deg,var(--primary-color),var(--primary-dark));} 
body.dark-mode .completion-actions .secondary-btn{background:transparent;color:#fff;border-color:rgba(255,255,255,.25);} 

/* Scrollbar interne in DM */
body.dark-mode .answer-scroll-container::-webkit-scrollbar-track{background:#0f1012;} 
body.dark-mode .answer-scroll-container::-webkit-scrollbar-thumb{background:#2b2f36;} 

/* Accessibilità */
@media (prefers-reduced-motion: reduce){
  body.dark-mode .study-option-card,
  body.dark-mode .rate-btn,
  body.dark-mode .nav-btn,
  body.dark-mode .modal-container{transition:none}
}
/* =========================================================
   DARK MODE — MODALE "LE TUE FLASHCARD" (gestione/creazione)
   Scope: solo dentro la schermata flashcards + dark-mode
   ========================================================= */

/* Overlay scuro coerente */
body.dark-mode .flashcards-screen [class*="modal"]:not(.menu-content):not(.sidebar-menu):not(.stats-panel) {
  color: #ececec;
}
body.dark-mode .flashcards-screen .modal-overlay,
body.dark-mode .flashcards-screen [class*="overlay"][class*="modal"] {
  background: rgba(0,0,0,.72);
  backdrop-filter: blur(6px);
}

/* Contenitore modale generico (copre: .modal, .modal-container, .modal-content, .custom-cards-modal, ecc.) */
body.dark-mode .flashcards-screen .modal,
body.dark-mode .flashcards-screen .modal-container,
body.dark-mode .flashcards-screen .modal-content,
body.dark-mode .flashcards-screen .custom-cards-modal,
body.dark-mode .flashcards-screen .manage-cards-modal,
body.dark-mode .flashcards-screen [class*="cards"][class*="modal"],
body.dark-mode .flashcards-screen [class*="modal-panel"],
body.dark-mode .flashcards-screen [role="dialog"] {
  background: radial-gradient(120% 180% at 20% -10%, rgba(36,37,41,.95), rgba(18,19,22,.94));
  border: 1px solid rgba(255,255,255,.08);
  box-shadow: 0 28px 64px rgba(0,0,0,.65), inset 0 1px 0 rgba(255,255,255,.06);
  color: #f0f0f0;
}

/* Header modale */
body.dark-mode .flashcards-screen .modal-header,
body.dark-mode .flashcards-screen [class*="modal"] [class*="header"] {
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,0));
  border-bottom: 1px solid rgba(255,255,255,.08);
}
body.dark-mode .flashcards-screen .modal-header h3,
body.dark-mode .flashcards-screen .modal-header h2,
body.dark-mode .flashcards-screen [class*="modal"] h1,
body.dark-mode .flashcards-screen [class*="modal"] h2 {
  color:#fafafa;
}

/* Lista elementi card personalizzate */
body.dark-mode .flashcards-screen .user-flashcard-item,
body.dark-mode .flashcards-screen .custom-card-item,
body.dark-mode .flashcards-screen .flashcard-list-item,
body.dark-mode .flashcards-screen [class*="card-item"],
body.dark-mode .flashcards-screen [class*="flashcard-row"],
body.dark-mode .flashcards-screen [class*="flashcard-entry"] {
  background: #15161a;
  border: 1px solid #292c33;
  border-radius: 16px;
  box-shadow: 0 12px 30px rgba(0,0,0,.5);
  color: #e6e6e6;
}

/* Label D: / R: */
body.dark-mode .flashcards-screen [class*="card-item"] b,
body.dark-mode .flashcards-screen [class*="flashcard-entry"] b { color:#ffdacf; }

/* Icon button modifica/cancella */
body.dark-mode .flashcards-screen .icon-btn,
body.dark-mode .flashcards-screen .edit-btn,
body.dark-mode .flashcards-screen .delete-btn {
  background: rgba(255,255,255,.08);
  color:#fff;
  border:1px solid rgba(255,255,255,.12);
}
body.dark-mode .flashcards-screen .icon-btn:hover,
body.dark-mode .flashcards-screen .edit-btn:hover,
body.dark-mode .flashcards-screen .delete-btn:hover{ background: rgba(255,255,255,.14); }

/* Pulsanti primari nella modale (Aggiungi Nuova / Chiudi) */
body.dark-mode .flashcards-screen .modal .primary-btn,
body.dark-mode .flashcards-screen [class*="modal"] .primary-btn,
body.dark-mode .flashcards-screen [class*="modal"] .btn-primary {
  background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
  color:#fff;
  border:0;
  box-shadow:0 14px 32px rgba(128,36,51,.35);
}
body.dark-mode .flashcards-screen [class*="modal"] .secondary-btn,
body.dark-mode .flashcards-screen [class*="modal"] .btn-outline {
  background: transparent;
  color:#fff;
  border:1px solid rgba(255,255,255,.25);
}

/* Form creazione/edizione */
body.dark-mode .flashcards-screen [class*="modal"] input[type="text"],
body.dark-mode .flashcards-screen [class*="modal"] textarea,
body.dark-mode .flashcards-screen [class*="modal"] select {
  background:#0f1012; border:1px solid #2c2f36; color:#f0f0f0; border-radius:12px;
}
body.dark-mode .flashcards-screen [class*="modal"] input::placeholder,
body.dark-mode .flashcards-screen [class*="modal"] textarea::placeholder{ color:#8a8f99; }

/* Divider e footer */
body.dark-mode .flashcards-screen .modal-footer,
body.dark-mode .flashcards-screen [class*="modal"] [class*="footer"]{ border-top:1px solid rgba(255,255,255,.06); }

/* Micro-shadow per il pulsante "Aggiungi Nuova" in alto a destra */
body.dark-mode .flashcards-screen [class*="modal"] .add-card-btn,
body.dark-mode .flashcards-screen [class*="modal"] .btn-add-card{ box-shadow:0 14px 30px rgba(128,36,51,.35); }
/* =========================================================
   DARK MODE — MODALE GESTIONE "LE TUE FLASHCARD" (fuori da .flashcards-screen)
   Copre il caso in cui l'overlay è figlio diretto di <body> con id #manage-flashcards-modal
   ========================================================= */

/* Overlay */
body.dark-mode.flashcards-open #manage-flashcards-modal.modal-overlay{
  background: rgba(0,0,0,.75);
  backdrop-filter: blur(6px);
}

/* Header / Body / Footer */
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-header,
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-body,
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-footer{
  color:#f0f0f0;
}

body.dark-mode.flashcards-open #manage-flashcards-modal .modal-header{
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,0));
  border-bottom:1px solid rgba(255,255,255,.08);
}

body.dark-mode.flashcards-open #manage-flashcards-modal .modal-body{
  background: radial-gradient(120% 180% at 20% -10%, rgba(36,37,41,.95), rgba(18,19,22,.94));
  border-left:1px solid rgba(255,255,255,.08);
  border-right:1px solid rgba(255,255,255,.08);
}

body.dark-mode.flashcards-open #manage-flashcards-modal .modal-footer{
  background: linear-gradient(0deg, rgba(255,255,255,.06), rgba(255,255,255,0));
  border-top:1px solid rgba(255,255,255,.08);
}

/* Titolo */
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-header h1,
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-header h2,
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-header h3{
  color:#fafafa;
}

/* Card elenco personalizzate */
body.dark-mode.flashcards-open #manage-flashcards-modal .user-flashcard-item,
body.dark-mode.flashcards-open #manage-flashcards-modal .custom-card-item,
body.dark-mode.flashcards-open #manage-flashcards-modal .flashcard-list-item,
body.dark-mode.flashcards-open #manage-flashcards-modal [class*="flashcard-row"],
body.dark-mode.flashcards-open #manage-flashcards-modal [class*="flashcard-entry"],
body.dark-mode.flashcards-open #manage-flashcards-modal .card-item{
  background:#15161a;
  border:1px solid #292c33;
  border-radius:16px;
  box-shadow:0 12px 30px rgba(0,0,0,.5);
  color:#e6e6e6;
}

/* Etichette D: / R: */
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-body b{ color:#ffdacf; }

/* Pulsanti azione dentro le card */
body.dark-mode.flashcards-open #manage-flashcards-modal .icon-btn,
body.dark-mode.flashcards-open #manage-flashcards-modal .edit-btn,
body.dark-mode.flashcards-open #manage-flashcards-modal .delete-btn{
  background: rgba(255,255,255,.08);
  color:#fff;
  border:1px solid rgba(255,255,255,.12);
}
body.dark-mode.flashcards-open #manage-flashcards-modal .icon-btn:hover,
body.dark-mode.flashcards-open #manage-flashcards-modal .edit-btn:hover,
body.dark-mode.flashcards-open #manage-flashcards-modal .delete-btn:hover{
  background: rgba(255,255,255,.14);
}

/* Bottoni principali della modale */
body.dark-mode.flashcards-open #manage-flashcards-modal .primary-btn,
body.dark-mode.flashcards-open #manage-flashcards-modal .btn-primary{
  background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
  color:#fff; border:0; box-shadow:0 14px 32px rgba(128,36,51,.35);
}
body.dark-mode.flashcards-open #manage-flashcards-modal .secondary-btn,
body.dark-mode.flashcards-open #manage-flashcards-modal .btn-outline{
  background:transparent; color:#fff; border:1px solid rgba(255,255,255,.25);
}

/* Campi input all'interno della modale */
body.dark-mode.flashcards-open #manage-flashcards-modal input[type="text"],
body.dark-mode.flashcards-open #manage-flashcards-modal textarea,
body.dark-mode.flashcards-open #manage-flashcards-modal select{
  background:#0f1012; border:1px solid #2c2f36; color:#f0f0f0; border-radius:12px;
}
body.dark-mode.flashcards-open #manage-flashcards-modal input::placeholder,
body.dark-mode.flashcards-open #manage-flashcards-modal textarea::placeholder{ color:#8a8f99; }
/* =============================================
   DARK MODE — FIX DEFINITIVO HEADER/FOOTER MODALE
   Target: modale gestione flashcard (#manage-flashcards-modal)
   ============================================= */

/* Contenitore modale */
body.dark-mode.flashcards-open #manage-flashcards-modal .modal,
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-container {
  background: radial-gradient(120% 180% at 20% -10%, rgba(36,37,41,.95), rgba(18,19,22,.94)) !important;
  border: 1px solid rgba(255,255,255,.08) !important;
  box-shadow: 0 28px 64px rgba(0,0,0,.65), inset 0 1px 0 rgba(255,255,255,.06) !important;
  color: #f0f0f0 !important;
}

/* Header */
body.dark-mode.flashcards-open #manage-flashcards-modal .modal > .modal-header,
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-container > .modal-header {
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,0)) !important;
  border-bottom: 1px solid rgba(255,255,255,.10) !important;
  color: #fafafa !important;
}
body.dark-mode.flashcards-open #manage-flashcards-modal .modal > .modal-header h1,
body.dark-mode.flashcards-open #manage-flashcards-modal .modal > .modal-header h2,
body.dark-mode.flashcards-open #manage-flashcards-modal .modal > .modal-header h3,
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-container > .modal-header h1,
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-container > .modal-header h2,
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-container > .modal-header h3 {
  color: #fafafa !important;
}

/* Footer */
body.dark-mode.flashcards-open #manage-flashcards-modal .modal > .modal-footer,
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-container > .modal-footer {
  background: linear-gradient(0deg, rgba(255,255,255,.06), rgba(255,255,255,0)) !important;
  border-top: 1px solid rgba(255,255,255,.10) !important;
  color: #f0f0f0 !important;
}

/* Pulsante primario nel footer */
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-footer .primary-btn,
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-footer .btn-primary {
  background: linear-gradient(135deg, var(--primary-color), var(--primary-dark)) !important;
  color: #fff !important;
  border: 0 !important;
  box-shadow: 0 14px 32px rgba(128,36,51,.35) !important;
}

/* Pulsante secondario nel footer */
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-footer .secondary-btn,
body.dark-mode.flashcards-open #manage-flashcards-modal .modal-footer .btn-outline {
  background: transparent !important;
  color: #fff !important;
  border: 1px solid rgba(255,255,255,.25) !important;
}


/* ===== FAB: Termina sessione ===== */
.end-session-btn{
    position: fixed;
    right: 24px; bottom: 24px;
    z-index: 10002;
    display: none; /* mostrato via JS solo durante la sessione */
    align-items: center; gap: 10px;
    padding: 12px 16px;
    border: 0; border-radius: 14px;
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    color:#fff; font-weight: 800;
    box-shadow: 0 14px 34px rgba(128,36,51,.35), inset 0 1px 0 rgba(255,255,255,.25);
    cursor: pointer; transform: translateZ(0);
  }
  .end-session-btn i{ font-size: 18px; }
  .end-session-btn:hover{ transform: translateY(-1px); }
  .end-session-btn:active{ transform: translateY(0); }
  .end-session-btn:focus-visible{ outline: 3px solid rgba(128,36,51,.35); outline-offset: 2px; }
  
  body.dark-mode .end-session-btn{
    background: linear-gradient(135deg, var(--primary-dark), var(--primary-color));
    box-shadow: 0 14px 34px rgba(0,0,0,.55), inset 0 1px 0 rgba(255,255,255,.08);
  }
/* ===================== */
/* FAB "Termina sessione" + STREAK POPUP (3D, coerente con brand) */
/* ===================== */

/* FAB: Termina sessione */
.end-session-btn{
  position: fixed;
  right: 24px; bottom: 24px;
  z-index: 10020;
  display: none; /* mostrato via JS solo durante la sessione */
  align-items: center; gap: 10px;
  padding: 12px 16px;
  border: 0; border-radius: 14px;
  background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
  color:#fff; font-weight: 800; letter-spacing: .2px;
  box-shadow: 0 14px 34px rgba(128,36,51,.35), inset 0 1px 0 rgba(255,255,255,.25);
  cursor: pointer; transform: translateZ(0);
  transition: transform .15s ease, box-shadow .2s ease, filter .2s ease;
}
.end-session-btn i{ font-size: 18px; }
.end-session-btn:hover{ transform: translateY(-2px); box-shadow: 0 18px 40px rgba(128,36,51,.42); }
.end-session-btn:active{ transform: translateY(0); }
.end-session-btn:focus-visible{ outline: 3px solid rgba(128,36,51,.35); outline-offset: 2px; }

body.dark-mode .end-session-btn{
  background: linear-gradient(135deg, var(--primary-dark), var(--primary-color));
  box-shadow: 0 14px 34px rgba(0,0,0,.55), inset 0 1px 0 rgba(255,255,255,.08);
}

/* ===== Streak Overlay ===== */
.streak-overlay{
  position: fixed; inset: 0;
  background: rgba(0,0,0,.5);
  backdrop-filter: blur(6px);
  z-index: 10030;
  display: flex; align-items: center; justify-content: center;
  padding: 24px;
  animation: streakFadeIn .2s ease-out;
}

@keyframes streakFadeIn{ from{ opacity: 0; } to{ opacity: 1; } }
@keyframes streakSlideUp{ from{ transform: translateY(12px); opacity:.96; } to{ transform: translateY(0); opacity:1; } }

/* ===== Streak Sheet (modale) ===== */
.streak-sheet{
  width: 100%; max-width: 560px;
  background: radial-gradient(100% 100% at 0% 0%, #fff 0%, #fafafa 100%);
  color: var(--secondary-color);
  border-radius: 20px;
  box-shadow: 0 30px 80px rgba(0,0,0,.18), 0 2px 0 rgba(255,255,255,.6) inset;
  border: 1px solid rgba(128,36,51,.12);
  padding: 22px 22px 18px;
  position: relative;
  animation: streakSlideUp .22s ease-out;
}

body.dark-mode .streak-sheet{
  background: linear-gradient(180deg, #1f1f22 0%, #151517 100%);
  color: #f3f4f6;
  box-shadow: 0 30px 80px rgba(0,0,0,.5), 0 1px 0 rgba(255,255,255,.05) inset;
  border-color: rgba(255,255,255,.06);
}

/* Header */
.streak-header{ display:flex; flex-direction: column; gap:6px; margin-bottom: 14px; }
.streak-number{ font-size: 1.25rem; font-weight: 800; color: var(--primary-color); }
.streak-msg{ color: var(--text-light); font-weight: 500; }
body.dark-mode .streak-number{ color:#f3d4da; }
body.dark-mode .streak-msg{ color:#c9c9c9; }

/* Close */
.streak-close{
  position: absolute; top: 10px; right: 10px;
  width: 36px; height: 36px; border-radius: 10px; border: 0;
  background: rgba(128,36,51,.08); color: var(--primary-dark);
  display:flex; align-items:center; justify-content:center;
  cursor: pointer; font-size: 18px; line-height: 1;
}
.streak-close:hover{ background: rgba(128,36,51,.14); }
body.dark-mode .streak-close{ background: rgba(255,255,255,.08); color:#eee; }
body.dark-mode .streak-close:hover{ background: rgba(255,255,255,.14); }

/* Progress */
.streak-progress{ margin: 8px 0 14px; }
.streak-bar{ height: 10px; border-radius: 999px; background: rgba(128,36,51,.12); overflow:hidden; }
.streak-fill{ height:100%; width:0%; background: linear-gradient(90deg, var(--primary-color), var(--primary-dark)); transition: width .35s ease; }
.streak-progress .streak-msg{ margin-top: 6px; font-weight: 700; color: rgba(128,36,51,.9); }
body.dark-mode .streak-bar{ background: rgba(255,255,255,.12); }
body.dark-mode .streak-progress .streak-msg{ color:#f3f4f6; }

/* Daily goal */
.streak-daily-goal{ margin: 12px 0 8px; display: grid; grid-template-columns: 1fr auto; gap: 10px; align-items: center; }
.streak-daily-goal label{ font-weight: 700; color: var(--secondary-color); }
.streak-daily-goal input[type="number"]{
  width: 120px; padding: 10px 12px; border-radius: 12px;
  border: 1px solid rgba(128,36,51,.25); background: #fff; color: var(--secondary-color);
  box-shadow: 0 1px 0 rgba(255,255,255,.6) inset;
}
.streak-daily-goal input[type="number"]:focus{ outline:none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(128,36,51,.14); }
.streak-daily-goal .daily-goal-hint{ grid-column: 1 / -1; color: var(--text-light); font-size: .85rem; }
body.dark-mode .streak-daily-goal input[type="number"]{ background:#0f0f10; color:#e9e9e9; border-color: rgba(255,255,255,.18); }

/* Today summary */
.streak-today-summary{ display:flex; align-items:center; gap:8px; padding: 10px 12px; background: rgba(128,36,51,.08); border-radius: 12px; }
.streak-today-summary .label{ font-weight:700; color: var(--secondary-color); }
#streak-today-count{ font-weight:800; color: var(--primary-dark); }
#streak-today-target{ font-weight:800; color: var(--primary-color); }
.streak-today-summary .sep{ opacity:.6; }
body.dark-mode .streak-today-summary{ background: rgba(255,255,255,.08); }
body.dark-mode #streak-today-count{ color:#fff; }
body.dark-mode #streak-today-target{ color:#f3d4da; }

/* Actions */
.streak-actions{ display:flex; justify-content:flex-end; gap:10px; margin-top: 16px; }
.streak-primary{
  background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
  color:#fff; border:0; border-radius: 12px; padding: 10px 18px; font-weight: 800;
  box-shadow: 0 10px 24px rgba(128,36,51,.28), inset 0 1px 0 rgba(255,255,255,.2);
  cursor: pointer; transition: transform .15s ease, box-shadow .2s ease;
}
.streak-primary:hover{ transform: translateY(-1px); box-shadow: 0 14px 30px rgba(128,36,51,.35), inset 0 1px 0 rgba(255,255,255,.22); }
.streak-primary:active{ transform: translateY(0); }

.streak-reset{
  background: #fff; color: var(--secondary-color); border: 1px solid rgba(128,36,51,.25);
  border-radius: 12px; padding: 10px 14px; font-weight: 700; cursor: pointer;
}
.streak-reset:hover{ background:#f7f7f7; }
body.dark-mode .streak-reset{ background:#0f0f10; color:#e9e9e9; border-color: rgba(255,255,255,.18); }
body.dark-mode .streak-reset:hover{ background:#17171a; }

/* Accessibilità */
.streak-primary:focus-visible, .streak-reset:focus-visible{ outline: 3px solid rgba(128,36,51,.35); outline-offset:2px; }
/* Alert Semplice */

.simple-alert-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
    padding: 20px;
}

.simple-alert {
    background: white;
    border-radius: 12px;
    width: 100%;
    max-width: 500px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    overflow: hidden;
}

.alert-header {
    background: var(--primary-color);
    color: white;
    padding: 20px;
    text-align: center;
}

.alert-header i {
    font-size: 2em;
    margin-bottom: 10px;
}

.alert-header h3 {
    margin: 0;
    font-size: 1.3em;
}

.alert-body {
    padding: 25px;
}

.instruction-steps {
    margin: 20px 0;
}

.step {
    display: flex;
    align-items: flex-start;
    gap: 15px;
    margin-bottom: 20px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
}

.step-number {
    background: var(--primary-color);
    color: white;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    flex-shrink: 0;
}

.step-content strong {
    display: block;
    margin-bottom: 5px;
    color: #333;
}

.step-content p {
    margin: 0;
    color: #666;
    font-size: 0.9em;
}

.email-example {
    background: #e8f4fd;
    padding: 15px;
    border-radius: 8px;
    margin-top: 20px;
}

.example-text {
    background: white;
    padding: 10px;
    border-radius: 5px;
    border-left: 4px solid var(--primary-color);
    margin: 10px 0 0 0;
    font-family: monospace;
}

.alert-footer {
    padding: 20px;
    background: #f8f9fa;
    display: flex;
    justify-content: center;
    border-top: 1px solid #eee;
}

.alert-footer .primary-btn {
    padding: 12px 30px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 1em;
    background: var(--primary-color);
    color: white;
}
